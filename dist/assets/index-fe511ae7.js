import{_ as b}from"./preload-helper-596b5639.js";import{e as a,y as l,s as be,n as M,l as Re,t as Ke,m as L,a as Tc,b as Ec,x as tr,A as $i,u as xc,v as kc,o as Ac,c as Ra,d as ys,f as ir,g as nr}from"./cast-7ef3a066.js";import{g as Ye}from"./Graphic-c3b235bf.js";import{i as La}from"./Clonable-c315fc8d.js";import{s as Pc}from"./Cyclical-1a93cb12.js";import{a as Si,b as $c,g as Sc}from"./mathUtils-daf59e84.js";import{t as $,r as w,s as ge,u as Rc,o as Gi,e as Te,f as Lc,h as Bt,p as Ys,q as Fc}from"./typedArrayUtil-4015bf74.js";import{w as Y,r as Fa,o as Oc,R as ko,E as is,a as Li,k as Ao,I as Oa,p as Dc,b as Vc,c as Da,d as Nc,M as zc,j as Bc}from"./Extent-54ef1174.js";import{a as Lt,t as _n,r as qc,T as sr,b as Ht,n as ns}from"./ArrayPool-45db95ab.js";import{i as Uc}from"./geometry-22feb2bb.js";import{v as pt,c as Va}from"./jsonUtils-196b5f3d.js";import{j as G}from"./Collection-8f94e599.js";import{l as Un}from"./CollectionFlattener-8cf1891d.js";import{s as R,a as E,b as Hn}from"./Error-1dfe2922.js";import{n as Ri,h as ve,y as Qs}from"./string-7d6c8f5c.js";import{E as qt,i as ii,g as tn,U as Po,j as Na,b as Hc,L as jc,f as Vt,A as za,a as Gc,v as or,p as Wc,C as Zc,t as ss}from"./promiseUtils-e323addc.js";import{l as v,h as V,a as Se,f as mt,U as rn,j as $o,w as Zt}from"./reactiveUtils-b911287d.js";import{c as we}from"./screenUtils-7afeb41c.js";import{l as Kc}from"./workers-957326d1.js";import{e as an,A as os,r as un,t as rs}from"./projection-6d5d9468.js";import{p as Yc,j as Qc}from"./TileInfo-9954a0c0.js";import{i as Js,e as ne,M as re,n as m,v as jn,h as rr,f as Ge,p as Jc,k as Xc,a as Ba,t as ed,w as td,b as qa,r as ar,c as Ua,o as lr}from"./widget-99edfa96.js";import{c as Ha,a as as,d as ja}from"./HandleOwner-2d282b7c.js";import{s as je}from"./intl-c3eb9a7a.js";import{s as cr}from"./byteSizeEstimations-90c5a50d.js";import{$ as id}from"./unitUtils-58dc72ed.js";import{m as So,L as Gn,u as nd,S as Ga}from"./number-1bdcdfd9.js";import{a as sd,s as vs}from"./executeQueryJSON-27522a1d.js";import{c as dr,d as Xs}from"./RelationshipQuery-2b83908f.js";import{x as od,h as rd,i as ad}from"./fieldUtils-cb9b3e6e.js";import{u as ld,i as cd,c as Wa,a as dd,I as ud,b as Za,d as hd,e as pd,f as hn,g as md,h as gd,k as fd}from"./PopupTemplate-2917795f.js";import{i as Ka}from"./arcadeOnDemand-490dc8ce.js";import{a as Ya}from"./assets-04f03891.js";import"./LegendOptions-998df0a8.js";import{j as mi,x as ws,M as _d,N as yd}from"./utils-4b8ae1e2.js";import{l as Ut}from"./Color-7a3d8c62.js";import{S as Qa,n as vd}from"./symbols-d548a197.js";import{a as wd}from"./jsonUtils-511fa9a1.js";import{U as Ja}from"./request-3bbdab19.js";import{m as bd,x as bs}from"./Query-8a7aa408.js";import"./featureConversionUtils-99b22ab9.js";import{i as Md,v as Xa,m as el}from"./Polyline-d942e774.js";import{f as Id,i as Cd,o as Td}from"./normalizeUtils-5312bea5.js";import"./pbf-99764d75.js";import"./FeatureSet-daef9679.js";import"./TopFeaturesQuery-c1b3daab.js";import{l as Ed,s as xd}from"./locale-30120714.js";import kd from"./FeatureLayer-7be1483a.js";import{s as tl,i as Ro}from"./Identifiable-d701141a.js";import{n as pn}from"./Evented-7dfb249a.js";import{b as ur}from"./Layer-d4420615.js";import{h as Ad,c as il,f as nl,e as Lo,i as Wn,M as Pd,r as sl,n as $d}from"./mat2d-80bd93af.js";import{e as hr}from"./Queue-26a7c9c9.js";import{t as Sd,I as Rd,y as Ld}from"./Scheduler-5da9d6c9.js";import{s as pr,x as eo}from"./Basemap-3aa7b130.js";import{n as Fd}from"./collectionUtils-07fb1a58.js";import{o as Od}from"./compilerUtils-c5090cf5.js";import{m as to}from"./Loadable-772aaf20.js";import{n as Dd}from"./loadAll-b6703d72.js";import{r as Vd}from"./enumeration-cda3949b.js";import{r as Nd,n as zd}from"./opacityUtils-2c2d0d87.js";import{l as Bd,d as qd,t as Ud}from"./TablesMixin-43889bfa.js";import{T as Hd}from"./TimeExtent-dfe3f644.js";import{j as ol,b as jd}from"./asyncUtils-bd6eb812.js";import{m as Gd,_ as Wd}from"./Promise-e08b9d4d.js";import{l as Zd,i as rl,a as mr,h as Kd}from"./GraphicsLayer-32722b72.js";import{v as Fo}from"./HeightModelInfo-91a7cb2a.js";import{m as Yd}from"./arcgisLayerUrl-af21cccf.js";import{l as gr}from"./ViewingMode-fb6259a5.js";import{t as io,r as Qd}from"./unitBezier-881ac1eb.js";import{r as al}from"./common-701a4199.js";import{o as no,v as fr,y as Jd,j as Xd,q as _r,C as ll,l as ls,r as oe,z as dt,g as eu,a as Zn,s as tu,m as iu}from"./vec2-f978aef8.js";import{r as nu,n as ee}from"./vec2f64-e0301652.js";import{s as su,r as ou,M as yr,h as ru,i as au}from"./mat3-45e3f2eb.js";import{e as Ms}from"./mat3f32-d3d088e8.js";import{t as vr}from"./vec2f32-461e65a9.js";import"./TileStrategy-b2d2fa5e.js";import{d as lu,h as cu}from"./TileStore-e480c2b6.js";import"./TileKey-03ab4f60.js";import{l as du}from"./capabilities-dddb0ea5.js";import{r as uu}from"./context-util-87dfae31.js";import{geodesicBuffer as hu}from"./geometryEngine-03c3e44c.js";import{j as pu}from"./Portal-af5b2c18.js";import{s as ci}from"./jsonMap-c8081704.js";import{u as mu}from"./messages-c2cf09a4.js";import"./nextTick-3ee5a785.js";import"./typeUtils-17403a33.js";import"./SimpleObservable-ddf0ceba.js";import"./Connection-4985e9bc.js";import"./mat4-62d5e6a4.js";import"./zscale-65468675.js";import"./aaBoundingRect-e7f76732.js";import"./uuid-73213768.js";import"./query-54e69cb9.js";import"./pbfQueryUtils-b3e55309.js";import"./OptimizedFeature-aa2e72dc.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-9c82ac96.js";import"./parser-60fed632.js";import"./colorUtils-639f4d25.js";import"./ItemCache-eb0f81ed.js";import"./MemCache-15515535.js";import"./CIMSymbol-308c5b42.js";import"./Symbol-6522d2f3.js";import"./aaBoundingBox-10130714.js";import"./persistableUrlUtils-2c2cd088.js";import"./UniqueValueRenderer-08aa8b40.js";import"./diffUtils-f2c670bd.js";import"./colorRamps-68d0ae1f.js";import"./sizeVariableUtils-d4870b0d.js";import"./lengthUtils-f3b6e37f.js";import"./jsonUtils-2b587c65.js";import"./styleUtils-58c095ea.js";import"./PortalGroup-100f1bed.js";import"./DictionaryLoader-e6470716.js";import"./LRUCache-f9ba273b.js";import"./deprecate-9e0289e6.js";import"./heatmapUtils-90a13d85.js";import"./vec4f64-018b3fa6.js";import"./Field-a857bb5a.js";import"./fieldType-36e8171c.js";import"./MultiOriginJSONSupport-98cda0d2.js";import"./LayerFloorInfo-ca7cf7a9.js";import"./FeatureLayerBase-1c170846.js";import"./OperationalLayer-06028ec1.js";import"./ElevationInfo-01beda98.js";import"./editsZScale-6893b5ed.js";import"./APIKeyMixin-62cd629d.js";import"./ArcGISService-391eca72.js";import"./BlendLayer-00b35d0f.js";import"./CustomParametersMixin-1353f893.js";import"./EditBusLayer-862b6183.js";import"./FeatureReductionLayer-df295e9a.js";import"./labelingInfo-aad6832f.js";import"./labelUtils-d3906ba4.js";import"./defaultsJSON-b087dd4d.js";import"./OrderedLayer-5a5e20b8.js";import"./PortalLayer-2a93959d.js";import"./PortalItem-49bcac17.js";import"./PortalUser-0170111d.js";import"./RefreshableLayer-e9f8071f.js";import"./ScaleRangeLayer-21fc7ea0.js";import"./TemporalLayer-797e0d5e.js";import"./TimeInfo-ce3628a3.js";import"./FeatureTemplate-281b6fcc.js";import"./FeatureType-980424ee.js";import"./fieldProperties-69262b89.js";import"./FieldsIndex-b44c88ca.js";import"./versionUtils-5fe0d938.js";import"./styleUtils-d1f4a996.js";import"./popupUtils-3b3b82a2.js";import"./writeUtils-5e02c8fc.js";import"./layerUtils-6996b9ea.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";import"./geometryEngineBase-3dd302e0.js";import"./hydrated-e2f14ddc.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function We(){}function cl(i){return i()}function wr(){return Object.create(null)}function mn(i){i.forEach(cl)}function dl(i){return typeof i=="function"}function cs(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function gu(i){return Object.keys(i).length===0}function Z(i,e){i.appendChild(e)}function gn(i,e,t){i.insertBefore(e,t||null)}function Fi(i){i.parentNode&&i.parentNode.removeChild(i)}function fu(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function ce(i){return document.createElement(i)}function Wi(i){return document.createTextNode(i)}function Dt(){return Wi(" ")}function Is(i,e,t,n){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t,n)}function le(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function ul(i){return i===""?null:+i}function _u(i){return Array.from(i.childNodes)}function Cs(i,e){e=""+e,i.wholeText!==e&&(i.data=e)}function yn(i,e){i.value=e??""}function br(i,e){for(let t=0;t<i.options.length;t+=1){const n=i.options[t];if(n.__value===e){n.selected=!0;return}}i.selectedIndex=-1}function yu(i){const e=i.querySelector(":checked")||i.options[0];return e&&e.__value}function vu(i,e,{bubbles:t=!1,cancelable:n=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(i,t,n,e),s}let ln;function nn(i){ln=i}function hl(){if(!ln)throw new Error("Function called outside component initialization");return ln}function wu(i){hl().$$.on_mount.push(i)}function bu(){const i=hl();return(e,t,{cancelable:n=!1}={})=>{const s=i.$$.callbacks[e];if(s){const o=vu(e,t,{cancelable:n});return s.slice().forEach(r=>{r.call(i,o)}),!o.defaultPrevented}return!0}}const Zi=[],Ft=[],Tn=[],so=[],Mu=Promise.resolve();let oo=!1;function Iu(){oo||(oo=!0,Mu.then(pl))}function Kn(i){Tn.push(i)}function gi(i){so.push(i)}const Ts=new Set;let vn=0;function pl(){const i=ln;do{for(;vn<Zi.length;){const e=Zi[vn];vn++,nn(e),Cu(e.$$)}for(nn(null),Zi.length=0,vn=0;Ft.length;)Ft.pop()();for(let e=0;e<Tn.length;e+=1){const t=Tn[e];Ts.has(t)||(Ts.add(t),t())}Tn.length=0}while(Zi.length);for(;so.length;)so.pop()();oo=!1,Ts.clear(),nn(i)}function Cu(i){if(i.fragment!==null){i.update(),mn(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(Kn)}}const En=new Set;let Tu;function xn(i,e){i&&i.i&&(En.delete(i),i.i(e))}function Es(i,e,t,n){if(i&&i.o){if(En.has(i))return;En.add(i),Tu.c.push(()=>{En.delete(i),n&&(t&&i.d(1),n())}),i.o(e)}else n&&n()}function fi(i,e,t,n){const s=i.$$.props[e];s!==void 0&&(i.$$.bound[s]=t,n===void 0&&t(i.$$.ctx[s]))}function xs(i){i&&i.c()}function kn(i,e,t,n){const{fragment:s,after_update:o}=i.$$;s&&s.m(e,t),n||Kn(()=>{const r=i.$$.on_mount.map(cl).filter(dl);i.$$.on_destroy?i.$$.on_destroy.push(...r):mn(r),i.$$.on_mount=[]}),o.forEach(Kn)}function An(i,e){const t=i.$$;t.fragment!==null&&(mn(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Eu(i,e){i.$$.dirty[0]===-1&&(Zi.push(i),Iu(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function ds(i,e,t,n,s,o,r,c=[-1]){const d=ln;nn(i);const u=i.$$={fragment:null,ctx:[],props:o,update:We,not_equal:s,bound:wr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:wr(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};r&&r(u.root);let h=!1;if(u.ctx=t?t(i,e.props||{},(p,g,...f)=>{const _=f.length?f[0]:g;return u.ctx&&s(u.ctx[p],u.ctx[p]=_)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](_),h&&Eu(i,p)),g}):[],u.update(),h=!0,mn(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const p=_u(e.target);u.fragment&&u.fragment.l(p),p.forEach(Fi)}else u.fragment&&u.fragment.c();e.intro&&xn(i.$$.fragment),kn(i,e.target,e.anchor,e.customElement),pl()}nn(d)}class us{$destroy(){An(this,1),this.$destroy=We}$on(e,t){if(!dl(t))return We;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!gu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function xu(i){let e,t,n,s,o,r,c,d,u,h,p,g,f,_;return{c(){e=ce("div"),t=ce("label"),t.textContent="Buffer (mi.):",n=Dt(),s=ce("input"),o=Dt(),r=ce("select"),c=ce("option"),c.textContent="Ft",d=ce("option"),d.textContent="Mi",u=Dt(),h=ce("label"),h.textContent="Name:",p=Dt(),g=ce("input"),le(t,"for","buffer-value"),le(s,"type","number"),le(s,"id","buffer-value"),le(s,"min","1"),le(s,"step","1"),c.__value="feet",c.value=c.__value,d.__value="miles",d.value=d.__value,d.selected=!0,i[2]===void 0&&Kn(()=>i[4].call(r)),le(h,"for","name-value"),le(g,"type","text"),le(g,"id","name-value"),le(e,"class","BufferEntry"),le(e,"data-testid","BufferEntry")},m(C,T){gn(C,e,T),Z(e,t),Z(e,n),Z(e,s),yn(s,i[0]),Z(e,o),Z(e,r),Z(r,c),Z(r,d),br(r,i[2]),Z(e,u),Z(e,h),Z(e,p),Z(e,g),yn(g,i[1]),f||(_=[Is(s,"input",i[3]),Is(r,"change",i[4]),Is(g,"input",i[5])],f=!0)},p(C,[T]){T&1&&ul(s.value)!==C[0]&&yn(s,C[0]),T&4&&br(r,C[2]),T&2&&g.value!==C[1]&&yn(g,C[1])},i:We,o:We,d(C){C&&Fi(e),f=!1,mn(_)}}}function ku(i,e,t){let{bufferValue:n}=e,{nameValue:s}=e,{unitValue:o}=e;function r(){n=ul(this.value),t(0,n)}function c(){o=yu(this),t(2,o)}function d(){s=this.value,t(1,s)}return i.$$set=u=>{"bufferValue"in u&&t(0,n=u.bufferValue),"nameValue"in u&&t(1,s=u.nameValue),"unitValue"in u&&t(2,o=u.unitValue)},[n,s,o,r,c,d]}class Au extends us{constructor(e){super(),ds(this,e,ku,xu,cs,{bufferValue:0,nameValue:1,unitValue:2})}}function Mr(i,e,t){const n=i.slice();return n[1]=e[t],n}function Ir(i){let e,t=i[1].name+"",n,s,o=i[1].buffer+"",r,c,d=i[1].unit+"",u;return{c(){e=ce("li"),n=Wi(t),s=Wi(" - "),r=Wi(o),c=Dt(),u=Wi(d)},m(h,p){gn(h,e,p),Z(e,n),Z(e,s),Z(e,r),Z(e,c),Z(e,u)},p(h,p){p&1&&t!==(t=h[1].name+"")&&Cs(n,t),p&1&&o!==(o=h[1].buffer+"")&&Cs(r,o),p&1&&d!==(d=h[1].unit+"")&&Cs(u,d)},d(h){h&&Fi(e)}}}function Pu(i){let e,t=i[0],n=[];for(let s=0;s<t.length;s+=1)n[s]=Ir(Mr(i,t,s));return{c(){e=ce("ul");for(let s=0;s<n.length;s+=1)n[s].c()},m(s,o){gn(s,e,o);for(let r=0;r<n.length;r+=1)n[r].m(e,null)},p(s,[o]){if(o&1){t=s[0];let r;for(r=0;r<t.length;r+=1){const c=Mr(s,t,r);n[r]?n[r].p(c,o):(n[r]=Ir(c),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},i:We,o:We,d(s){s&&Fi(e),fu(n,s)}}}function $u(i,e,t){let{pointList:n}=e;return i.$$set=s=>{"pointList"in s&&t(0,n=s.pointList)},[n]}class Su extends us{constructor(e){super(),ds(this,e,$u,Pu,cs,{pointList:0})}}let st=class extends La(Re){constructor(...e){super(...e),this.position=new Y([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,n,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const o={position:e};return t!=null&&(o.heading=t),n!=null&&(o.tilt=n),s!=null&&(o.fov=s),o}return e}writePosition(e,t,n,s){const o=e.clone();o.x=Lt(e.x||0),o.y=Lt(e.y||0),o.z=e.hasZ?Lt(e.z||0):e.z,t[n]=o.write({},s)}readPosition(e,t){const n=new Y;return n.read(e,t),n.x=Lt(n.x||0),n.y=Lt(n.y||0),n.z=n.hasZ?Lt(n.z||0):n.z,n}equals(e){return!$(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};a([l({type:Y,json:{write:{isRequired:!0}}})],st.prototype,"position",void 0),a([Fa("position")],st.prototype,"writePosition",null),a([Oc("position")],st.prototype,"readPosition",null),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),be(i=>Pc.normalize(Lt(i)))],st.prototype,"heading",void 0),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),be(i=>Si(Lt(i),-180,180))],st.prototype,"tilt",void 0),a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],st.prototype,"fov",void 0),st=a([M("esri.Camera")],st);const Ru=st;var ro;let It=ro=class extends Re{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new ro({rotation:this.rotation,scale:this.scale,targetGeometry:w(this.targetGeometry)?this.targetGeometry.clone():null,camera:w(this.camera)?this.camera.clone():null})}};function ks(){return{enabled:!this.camera}}a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:ks}}}}})],It.prototype,"rotation",void 0),a([be("rotation")],It.prototype,"castRotation",null),a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:ks}}}}})],It.prototype,"scale",void 0),a([l({types:Uc,json:{read:pt,write:!0,origins:{"web-scene":{read:pt,write:{overridePolicy:ks}}}}})],It.prototype,"targetGeometry",void 0),a([l({type:Ru,json:{write:!0}})],It.prototype,"camera",void 0),It=ro=a([M("esri.Viewpoint")],It);const Ze=It,Pn={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],n=e[1],s=this.values;return n>=t?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},As={xsmall:544,small:768,medium:992,large:1200};function Lu(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Ps(i,e){return e?Pn[i].valueToClassName[e].split(" "):[]}const Fu=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new Ke,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=As}initialize(){this._breakpointsHandles.add(v(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),V))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=ge(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const n=Lu(t);if(!n){const s=JSON.stringify(As,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s)}t=n?t:As,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=_n.acquire(),n=_n.acquire();let s,o=!1;for(s in Pn){const r=this[s],c=Pn[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});r!==c&&(o=!0,this[s]=c,Ps(s,r).forEach(d=>n.push(d)),Ps(s,c).forEach(d=>t.push(d)))}o&&(this._applyClassNameChanges(t,n),_n.release(t),_n.release(n))}_applyClassNameChanges(t,n){const s=this.container;s&&(n.forEach(o=>s.classList.remove(o)),t.forEach(o=>s.classList.add(o)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let n;for(n in Pn)Ps(n,this[n]).forEach(s=>t.classList.remove(s))}};return a([l()],e.prototype,"breakpoints",null),a([l()],e.prototype,"orientation",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),a([l()],e.prototype,"heightBreakpoint",void 0),e=a([M("esri.views.BreakpointsOwner")],e),e};let Ct=class extends L{constructor(){super(...arguments),this.items=new G,this._watchUpdatingTracking=new Ha,this._callbacks=new Map,this._projector=Js(),this._hiddenProjector=Js()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const n of t.added){const s=()=>n.render();this._callbacks.set(n,s),this._projector.append(this.surface,s)}for(const n of t.removed){const s=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(s.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,n=this._hiddenProjector;let s=null;const o=()=>(s=e.render(),s);n.append(t,o),n.renderNow();const r={left:0,top:0,right:0,bottom:0};if(s&&s.domNode){const c=s.domNode.getBoundingClientRect();r.left=c.left,r.top=c.top,r.right=c.right,r.bottom=c.bottom}for(n.detach(o);t.firstChild;)t.removeChild(t.firstChild);return r}overlaps(e,t){const n=this.computeBoundingRect(e),s=this.computeBoundingRect(t);return Math.max(n.left,s.left)<=Math.min(n.right,s.right)&&Math.max(n.top,s.top)<=Math.min(n.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(n=>n.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(n=>{t.save(),n.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([l({readOnly:!0})],Ct.prototype,"surface",void 0),a([l({readOnly:!0})],Ct.prototype,"items",void 0),a([l({readOnly:!0})],Ct.prototype,"needsRender",null),a([l({readOnly:!0})],Ct.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],Ct.prototype,"updating",null),Ct=a([M("esri.views.overlay.ViewOverlay")],Ct);const Cr=Ct;function Pi(i,e,t,n){let s=null,o=1e3;typeof e=="number"?(o=e,n=t):(s=e??null,o=t);let r,c=0;const d=()=>{c=0,i.apply(n,r)},u=(...h)=>{s&&s.apply(n,h),r=h,o?c||(c=setTimeout(d,o)):d()};return u.remove=()=>{c&&(clearTimeout(c),c=0)},u.forceUpdate=()=>{c&&(clearTimeout(c),d())},u.hasPendingUpdates=()=>!!c,u}const Tr=["B","kB","MB","GB","TB"];function Ou(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(cr.KILOBYTES));t=Si(t,0,Tr.length-1);const n=So(e/cr.KILOBYTES**t,{maximumFractionDigits:2});return Ri(i.units.bytes[Tr[t]],{fileSize:n})}const Du="esri.widgets.Feature.support.featureUtils",Er=R.getLogger(Du),Vu=/href=(""|'')/gi,Nu=/(\{([^\{\r\n]+)\})/g,zu=/\'/g,ml=/^\s*expression\//i,Bu=/(\n)/gi,qu=/[\u00A0-\u9999<>\&]/gim,Uu=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,Hu=/^(?:mailto:|tel:)/,gl="relationships/",ao=Ga("short-date-short-time");function fl(i){if(!$(i))return i.get("sourceLayer")||i.get("layer")}async function Yn(i,e){return typeof i=="function"?i.call(null,e):i}function _l(i=""){if(i)return!Hu.test(i.trim().toLowerCase())}function Oo(i){return!!i&&ml.test(i)}function ju(i,e){if(!Oo(e)||!i)return null;const t=e.replace(ml,"").toLowerCase();let n;return i.some(s=>s.name.toLowerCase()===t&&(n=s,!0)),n}function yl(i,e){const t=ju(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function Gu(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function Wu(i){return i.replace(Vu,"")}function cn(i,e){const t=Do(e,i);return t?t.name:i}function Zu(i,e){return i&&i.map(t=>cn(t,e))}function Do(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function vl(i){return`${i}`.trim()}function oi({attributes:i,globalAttributes:e,layer:t,text:n,expressionAttributes:s,fieldInfoMap:o}){return n?lo({formattedAttributes:e,template:Ju(n,{...e,...s,...i},t),fieldInfoMap:o}):""}function lo({formattedAttributes:i,template:e,fieldInfoMap:t}){return vl(Wu(Ri(Ri(e,n=>Gu(n,t)),i)))}function Ku(i,e,t=!1){const n=e[i];if(typeof n=="string"){const s="%27",o=(t?encodeURIComponent(n):n).replace(zu,s);e[i]=o}}function Yu(i,e=!1){const t={...i};return Object.keys(t).forEach(n=>Ku(n,t,e)),t}function Qu(i,e,t){const n=(e=vl(e))&&e[0]!=="{";return Ri(i,Yu(t,n))}function co(i,e){return i.replace(Nu,(t,n,s)=>{const o=Do(e,s);return o?`{${o.name}}`:n})}function Ju(i,e,t){const n=co(i,t);return n&&n.replace(Uu,(s,o,r)=>Qu(s,o||r,e))}function Xu(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function eh(i){return(i==null?void 0:i.type)==="feature"}function xr(i){return!!(i!=null&&i.layer)}function th(i){return(i==null?void 0:i.type)==="map-image"}function ih(i,e){var u;const t=e.fieldInfos,n=e.fieldName,s=(u=wl(t,n))==null?void 0:u.clone(),o=e.preventPlacesFormatting,r=e.layer,c=Do(r,n);if(s&&(c==null?void 0:c.type)==="date"){const h=s.format||new ld;h.dateFormat=h.dateFormat||"short-date-short-time",h.dateTimeFormatOptions=!xr(r)&&eh(r)&&r.datesInUnknownTimezone||xr(r)&&th(r.layer)&&r.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,s.format=h}const d=s&&s.format;return typeof i=="string"&&rd(n)&&d?d.formatRasterPixelValue(i):typeof(i=Xu(i,d))=="string"||i==null||d==null?fn(i):o?So(i,{...nd(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(i)}function wl(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let n;return i.some(s=>!(!s.fieldName||s.fieldName.toLowerCase()!==t)&&(n=s,!0)),n}function nh({fieldName:i,graphic:e,layer:t}){if(ht(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:n}=t;if(!n||i!==n)return null;const s=t.getFeatureType(e);return s?s.name:null}function sh({fieldName:i,value:e,graphic:t,layer:n}){if(ht(i)||!n||typeof n.getFieldDomain!="function")return null;const s=n.getFieldDomain(i,{feature:t});return s&&s.type==="coded-value"?s.getName(e):null}function oh(i,e){const{creatorField:t,creationDateField:n,editorField:s,editDateField:o}=i;if(!e)return;const r=e[o];if(typeof r=="number"){const d=e[s];return{type:"edit",date:Gn(r,ao),user:d}}const c=e[n];if(typeof c=="number"){const d=e[t];return{type:"create",date:Gn(c,ao),user:d}}return null}function rh(i,e){const t=new Map;return i&&i.forEach(n=>{const s=cn(n.fieldName,e);n.fieldName=s,t.set(s.toLowerCase(),n)}),t}function kr(i){const e=[];if(!i)return e;const{fieldInfos:t,content:n}=i;return t&&e.push(...t),n&&Array.isArray(n)&&n.forEach(s=>{if(s.type==="fields"){const o=s&&s.fieldInfos;o&&e.push(...o)}}),e}function Vo(i){return i.replace(qu,e=>`&#${e.charCodeAt(0)};`)}function fn(i){return typeof i=="string"?i.replace(Bu,'<br class="esri-text-new-line" />'):i}function bl(i){const{value:e,fieldName:t,fieldInfos:n,fieldInfoMap:s,layer:o,graphic:r}=i;if(e==null)return"";const c=sh({fieldName:t,value:e,graphic:r,layer:o});if(c)return c;const d=nh({fieldName:t,graphic:r,layer:o});if(d)return d;if(s.get(t.toLowerCase()))return ih(e,{fieldInfos:n||Array.from(s.values()),fieldName:t,layer:o});const u=o&&o.fieldsIndex;return u&&u.isDateField(t)?Gn(e,ao):fn(e)}function $s({fieldInfos:i,attributes:e,layer:t,graphic:n,fieldInfoMap:s,relatedInfos:o}){const r={};return o==null||o.forEach(c=>uh({attributes:r,relatedInfo:c,fieldInfoMap:s,fieldInfos:i,layer:t})),Object.keys(e).forEach(c=>{const d=e[c];r[c]=bl({fieldName:c,fieldInfos:i,fieldInfoMap:s,layer:t,value:d,graphic:n})}),r}async function ah(i,e){var h,p;const{layer:t,graphic:n,outFields:s,objectIds:o,returnGeometry:r,spatialReference:c}=i,d=o[0];if(typeof d!="number"&&typeof d!="string"){const g="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:n,objectId:d,requiredFields:s};return Er.warn(g,f),null}if(!((p=(h=t.capabilities)==null?void 0:h.operations)!=null&&p.supportsQuery)){const g="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:n,requiredFields:s,returnGeometry:r};return Er.warn(g,f),null}const u=t.createQuery();return u.objectIds=o,u.outFields=s!=null&&s.length?s:[t.objectIdField],u.returnGeometry=!!r,u.returnZ=!!r,u.returnM=!!r,u.outSpatialReference=c,(await t.queryFeatures(u,e)).features[0]}async function lh(i){var n;if(!((n=i.expressionInfos)!=null&&n.length))return!1;const e=await Ka(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function ch({graphic:i,popupTemplate:e,layer:t,spatialReference:n},s){if(!t||!e||(typeof t.load=="function"&&await t.load(s),!i.attributes))return;const o=i.attributes[t.objectIdField];if(o==null)return;const r=[o],c=await e.getRequiredFields(t.fieldsIndex),d=od(c,i),u=d?[]:c,h=e.returnGeometry||await lh(e);if(d&&!h)return;const p=await ah({layer:t,graphic:i,outFields:u,objectIds:r,returnGeometry:h,spatialReference:n},s);p&&(p.geometry&&(i.geometry=p.geometry),p.attributes&&(i.attributes={...i.attributes,...p.attributes}))}function ht(i=""){return!!i&&i.includes(gl)}function dh(i){return i?`${gl}${i.layerId}/${i.fieldName}`:""}function Ar({attributes:i,graphic:e,relatedInfo:t,fieldInfos:n,fieldInfoMap:s,layer:o}){i&&e&&t&&Object.keys(e.attributes).forEach(r=>{const c=dh({layerId:t.relation.id.toString(),fieldName:r}),d=e.attributes[r];i[c]=bl({fieldName:c,fieldInfos:n,fieldInfoMap:s,layer:o,value:d,graphic:e})})}function uh({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:s}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(o=>Ar({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:s})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(o=>Ar({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:s})))}const Pr=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Ml=({layer:i,method:e,query:t,definitionExpression:n})=>{var r,c;if(!((c=(r=i.capabilities)==null?void 0:r.query)!=null&&c.supportsCacheHint)||e==="attachments")return;const s=w(t.where)&&t.where,o=w(t.geometry)&&t.geometry;Pr(n)||Pr(s)||(o==null?void 0:o.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},hh=({query:i,layer:e,method:t})=>{Ml({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},ph=({queryPayload:i,layer:e,method:t})=>{Ml({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function mh(i,e,t){return i&&e&&t?$r(i.allLayers,e,t)||$r(i.allTables,e,t):null}function $r(i,e,t){return i.find(n=>n!==e&&n.type==="feature"&&n.url===e.url&&n.layerId===t.relatedTableId)}const Sr={editing:!1,operations:{add:!0,update:!0,delete:!0}},Il=G.ofType(sd);let fe=class extends L{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...Sr},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new Il,this.fileInfos=new G,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(v(()=>this.graphic,()=>this._graphicChanged(),V))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...Sr,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new E("invalid-layer","getAttachments(): A valid layer is required.");const n=this._getObjectId(),s=new dr({objectIds:[n],returnMetadata:!0}),o=[],r=e.queryAttachments(s).then(d=>d[n]||o).catch(()=>o);this._getAttachmentsPromise=r,this.notifyChange("state");const c=await r;return t.removeAll(),c.length&&t.addMany(c),this._getAttachmentsPromise=null,this.notifyChange("state"),c}async addAttachment(e,t=this.graphic){const{_attachmentLayer:n,attachmentInfos:s,abilities:o}=this;if(!t)throw new E("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new E("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!o.operations.add)throw new E("invalid-abilities","addAttachment(): add abilities are required.");if(!n||typeof n.addAttachment!="function")throw new E("invalid-layer","addAttachment(): A valid layer is required.");const r=n.addAttachment(t,e).then(d=>this._queryAttachment(d.objectId,t)),c=await r;return s.add(c),c}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:n,graphic:s,abilities:o}=this;if(!e)throw new E("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!o.operations.delete)throw new E("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new E("invalid-layer","deleteAttachment(): A valid layer is required.");const r=t.deleteAttachments(s,[e.id]).then(()=>e),c=await r;return n.remove(c),c}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:n,attachmentInfos:s,graphic:o,abilities:r}=this;if(!e)throw new E("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new E("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.update)throw new E("invalid-abilities","updateAttachment(): Update abilities are required.");const c=s.findIndex(h=>h===t);if(!n||typeof n.updateAttachment!="function")throw new E("invalid-layer","updateAttachment(): A valid layer is required.");const d=n.updateAttachment(o,t.id,e).then(h=>this._queryAttachment(h.objectId)),u=await d;return s.splice(c,1,u),u}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const n={file:e,form:t};return this.fileInfos.add(n),n}updateFile(e,t,n=this.activeFileInfo){if(!e||!t||!n)return null;const s=this.fileInfos.findIndex(o=>n===o);return s>-1&&this.fileInfos.splice(s,1,{file:e,form:t}),this.fileInfos.items[s]}deleteFile(e){const t=this.fileInfos.find(n=>n.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new E("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:n}=this,s=this._getObjectId(t),o=new dr({objectIds:[s],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return n.queryAttachments(o).then(r=>r[s][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=fl(e);this._attachmentLayer=t?t.type==="scene"&&w(t.associatedLayer)?t.associatedLayer:t:null}};a([l()],fe.prototype,"abilities",void 0),a([be("abilities")],fe.prototype,"castAbilities",null),a([l()],fe.prototype,"activeAttachmentInfo",void 0),a([l()],fe.prototype,"activeFileInfo",void 0),a([l({readOnly:!0,type:Il})],fe.prototype,"attachmentInfos",void 0),a([l()],fe.prototype,"fileInfos",void 0),a([l({type:Ye})],fe.prototype,"graphic",void 0),a([l()],fe.prototype,"mode",void 0),a([l({readOnly:!0})],fe.prototype,"state",null),a([l()],fe.prototype,"filesEnabled",void 0),a([l({readOnly:!0})],fe.prototype,"supportsResizeAttachments",null),fe=a([M("esri.widgets.Attachments.AttachmentsViewModel")],fe);const No=fe;function Rr(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function gh(i){const e=Ya("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const Lr={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},I={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},Ss=window.CSS;let ae=class extends re{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new No,this.visibleElements={...Lr},this._supportsImageOrientation=Ss&&Ss.supports&&Ss.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([Se(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),Se(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),V)])}loadDependencies(){return Promise.all([b(()=>import("./calcite-icon-331afcfb.js"),["assets/calcite-icon-331afcfb.js","assets/icon-39f1fc65.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/observers-cf6d0d57.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...Lr,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(n=>(this._set("submitting",!1),this._set("error",null),t.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new E("attachments:add-attachment",this.messages.addErrorMessage,n)),n})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(n=>(this._set("submitting",!1),this._set("error",null),t.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new E("attachments:delete-attachment",this.messages.deleteErrorMessage,n)),n})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(n=>(this._set("submitting",!1),this._set("error",null),e.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new E("attachments:update-attachment",this.messages.updateErrorMessage,n)),n})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:n}=t;return m("div",{class:this.classes(I.base,I.esriWidget)},e?this.renderProgressBar():null,n==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?m("div",{key:"error-message",class:I.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:n}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(n||e):this.renderAttachmentContainer()}renderLoading(){return m("div",{class:I.loaderContainer,key:"loader"},m("div",{class:I.loader}))}renderProgressBar(){return this.visibleElements.progressBar?m("div",{class:I.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,n=e||!t,s=this.visibleElements.cancelAddButton?m("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(I.esriButton,I.esriButtonTertiary,I.esriButtonSmall,I.esriButtonHalf,e&&I.buttonDisabled)},this.messages.cancel):null,o=this.visibleElements.addSubmitButton?m("button",{type:"submit",disabled:n,class:this.classes(I.esriButton,I.esriButtonSecondary,I.esriButtonSmall,I.esriButtonHalf,{[I.buttonDisabled]:n})},this.messages.add):null,r=t?m("span",{key:"file-name",class:I.fileName},t.name):null,c=m("form",{bind:this,afterCreate:jn,afterRemoved:rr,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},m("fieldset",{class:I.fileFieldset},r,m("label",{class:this.classes(I.fileLabel,I.esriButton,I.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,m("input",{class:I.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),o,s);return m("div",{key:"add-form-container",class:I.formNode},c)}renderDetailsForm(e){const{visibleElements:t,viewModel:n,selectedFile:s,submitting:o}=this,{abilities:r}=n,c=o||!s;let d,u,h,p;s?(d=s.type,u=s.name,h=s.size):"file"in e?(d=e.file.type,u=e.file.name,h=e.file.size):(d=e.contentType,u=e.name,h=e.size,p=e.url);const g=r.editing&&r.operations.delete&&t.deleteButton?m("button",{key:"delete-button",type:"button",disabled:o,bind:this,onclick:z=>this._submitDeleteAttachment(z,e),class:this.classes(I.esriButton,I.esriButtonSmall,I.esriButtonTertiary,I.deleteButton,{[I.buttonDisabled]:o})},this.messages.delete):void 0,f=r.editing&&r.operations.update&&t.updateButton?m("button",{disabled:c,key:"update-button",type:"submit",class:this.classes(I.esriButton,I.esriButtonSmall,I.esriButtonThird,{[I.buttonDisabled]:c})},this.messages.update):void 0,_=this.visibleElements.cancelUpdateButton?m("button",{disabled:o,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(I.esriButton,I.esriButtonSmall,I.esriButtonTertiary,I.esriButtonThird,{[I.buttonDisabled]:o})},this.messages.cancel):void 0,C=r.editing&&r.operations.update?m("fieldset",{key:"file",class:I.fileFieldset},m("span",{key:"file-name",class:I.fileName},u),m("label",{class:this.classes(I.fileLabel,I.esriButton,I.esriButtonSecondary)},this.messages.changeFile,m("input",{class:I.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,T=m("fieldset",{key:"size",class:I.metadataFieldset},m("label",null,Ou(this.messagesUnits,h))),A=m("fieldset",{key:"content-type",class:I.metadataFieldset},m("label",null,d)),F=w(p)?m("a",{class:I.itemLink,href:p,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),m("div",{class:I.itemLinkOverlay},m("span",{class:I.itemLinkOverlayIcon},m("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),O=m("form",{bind:this,afterCreate:jn,afterRemoved:rr,"data-node-ref":"_updateAttachmentForm",onsubmit:z=>this._submitUpdateAttachment(z,e)},m("div",{class:I.metadata},T,A),C,m("div",{class:I.actions},g,_,f));return m("div",{key:"edit-form-container",class:I.formNode},F,O)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:n}=this.viewModel,s=gh(t),o={[I.itemImageResizable]:n};return m("div",{class:this.classes(I.itemMaskIcon,I.itemMask)},m("img",{title:e,alt:e,src:s,class:this.classes(o,I.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:n}=this.viewModel,{contentType:s,name:o,url:r}=e;if(!n||!Rr(s))return this.renderGenericImageMask(o,s);const c=this._getCSSTransform(e),d=c?{transform:c,"image-orientation":"none"}:{},u=`${r}${r.includes("?")?"&":"?"}w=${t}`,h={[I.itemImageResizable]:n};return m("div",{class:this.classes(I.itemMask)},m("img",{styles:d,alt:o,title:o,src:u,class:this.classes(h,I.itemImage)}))}renderFile(e){const{file:t}=e;return m("li",{class:I.item,key:t},m("button",{key:"details-button",bind:this,class:I.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),m("label",{class:I.itemLabel},m("span",{class:I.itemFilename},t.name||this.messages.noTitle),m("span",{"aria-hidden":"true",class:this.classes(I.itemChevronIcon,Ge(this.container)?I.iconLeft:I.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:n,effectiveDisplayType:s}=this,{abilities:o,supportsResizeAttachments:r}=n,{contentType:c,name:d,url:u}=e,h=this.renderImageMask(e,t==="list"?48:400),p=o.editing?m("span",{"aria-hidden":"true",class:this.classes(I.itemChevronIcon,Ge(this.container)?I.iconLeft:I.iconRight)}):null,g=[h,s==="preview"&&r&&Rr(c)?null:m("label",{class:I.itemLabel},m("span",{class:I.itemFilename},d||this.messages.noTitle),p)],f=o.editing?m("button",{key:"details-button",bind:this,class:I.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},g):m("a",{key:"details-link",class:I.itemButton,href:u,target:"_blank"},g);return m("li",{class:I.item,key:e},f)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:n}=this,{attachmentInfos:s,abilities:o,fileInfos:r}=t,c=!!(s!=null&&s.length),d=!!(r!=null&&r.length),u={[I.containerList]:e!=="preview",[I.containerPreview]:e==="preview"},h=o.editing&&o.operations.add&&n.addButton?m("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(I.esriButton,I.esriButtonTertiary,I.addAttachmentButton),type:"button"},m("span",{"aria-hidden":"true",class:this.classes(I.itemAddIcon,I.iconPlus)}),this.messages.add):void 0,p=c?m("ul",{key:"attachments-list",class:I.items},s.toArray().map(_=>this.renderAttachmentInfo({attachmentInfo:_,displayType:e}))):void 0,g=d?m("ul",{key:"file-list",class:I.items},r.toArray().map(_=>this.renderFile(_))):void 0,f=d||c?void 0:m("div",{class:I.empty},this.messages.noAttachments);return m("div",{key:"attachments-container",class:this.classes(I.container,u)},p,g,f,h)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};a([l()],ae.prototype,"abilities",null),a([l()],ae.prototype,"displayType",void 0),a([l({readOnly:!0})],ae.prototype,"effectiveDisplayType",null),a([l()],ae.prototype,"graphic",null),a([l()],ae.prototype,"label",null),a([l(),ne("esri/widgets/Attachments/t9n/Attachments")],ae.prototype,"messages",void 0),a([l(),ne("esri/core/t9n/Units")],ae.prototype,"messagesUnits",void 0),a([l({readOnly:!0})],ae.prototype,"selectedFile",void 0),a([l({readOnly:!0})],ae.prototype,"submitting",void 0),a([l({readOnly:!0})],ae.prototype,"error",void 0),a([l({type:No})],ae.prototype,"viewModel",void 0),a([l()],ae.prototype,"visibleElements",void 0),a([be("visibleElements")],ae.prototype,"castVisibleElements",null),ae=a([M("esri.widgets.Attachments")],ae);const fh=ae;let Ki=class extends No{constructor(e){super(e),this.description=null,this.title=null}};a([l()],Ki.prototype,"description",void 0),a([l()],Ki.prototype,"title",void 0),Ki=a([M("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],Ki);const zo=Ki,_h={heading:"esri-widget__heading"};function Bo(i,e){const t=yh(i.level),n=`h${t}`;return delete i.level,m(n,{...i,class:Jc(_h.heading,i.class),role:"heading","aria-level":String(t)},e)}function yh(i){return Si(Math.ceil(i),1,6)}const Rs={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let vi=class extends re{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return m("div",{class:Rs.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?m(Bo,{level:this.headingLevel,class:Rs.title},e):null}renderDescription(){const{description:e}=this;return e?m("div",{key:"description",class:Rs.description},e):null}};a([l()],vi.prototype,"description",void 0),a([l()],vi.prototype,"headingLevel",void 0),a([l()],vi.prototype,"title",void 0),vi=a([M("esri.widgets.Feature.support.FeatureElementInfo")],vi);const hs=vi,vh={base:"esri-feature-attachments"};let De=class extends re{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new fh,this.headingLevel=2,this.viewModel=new zo}initialize(){this._featureElementInfo=new hs,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),V),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,V)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return m("div",{class:vh.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:n}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:n})}};a([l({readOnly:!0})],De.prototype,"attachmentsWidget",void 0),a([l()],De.prototype,"description",null),a([l()],De.prototype,"displayType",null),a([l()],De.prototype,"graphic",null),a([l()],De.prototype,"headingLevel",void 0),a([l()],De.prototype,"title",null),a([l({type:zo})],De.prototype,"viewModel",void 0),De=a([M("esri.widgets.Feature.FeatureAttachments")],De);const wh=De;let Tt=class extends as(L){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(v(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},V))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:n}=this;e&&(Yn(n,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,n=Yn(e,{graphic:t}).catch(()=>null);this._loadingPromise=n,this.notifyChange("state");const s=await n;n===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",s))}};a([l({readOnly:!0})],Tt.prototype,"created",void 0),a([l()],Tt.prototype,"creator",void 0),a([l()],Tt.prototype,"destroyer",void 0),a([l({type:Ye})],Tt.prototype,"graphic",void 0),a([l({readOnly:!0})],Tt.prototype,"state",null),Tt=a([M("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Tt);const Qn=Tt;function Ee(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:Mh(i[e])}}}function bh(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Mh(i){return function(e,...t){bh(e)?Xc(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function Cl(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,n=Array.isArray(i)?i:Ih(i);t.push(...n)}}function Ih(i){return i.split(",").map(e=>e.trim())}const Tl="calcite-theme-";function Ch(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function Jn(){return Ch().startsWith("dark")}function Th(){return`${Tl}${Jn()?"dark":"light"}`}function Eh(i){xh(i),i.classList.add(Th())}function xh(i){Array.from(i.classList).forEach(e=>{e.startsWith(Tl)&&i.classList.remove(e)})}const Ls={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let wi=class extends re{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=n=>{Array.from(n.querySelectorAll("a")).forEach(s=>{_l(s.href)&&!s.hasAttribute("target")&&s.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return m("div",{class:Ls.loaderContainer,key:"loader"},m("div",{class:Ls.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?m("div",{key:e,bind:e,afterCreate:this._attachToNode}):Ba(e)?m("div",{key:e},!e.destroyed&&e.render()):m("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return m("div",{class:Ls.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};a([l()],wi.prototype,"creator",null),a([l()],wi.prototype,"graphic",null),a([l({type:Qn})],wi.prototype,"viewModel",void 0),wi=a([M("esri.widgets.Feature.FeatureContent")],wi);const $n=wi;let ot=class extends L{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,n=[];return t==null||t.forEach(s=>{if(!(!s.hasOwnProperty("visible")||s.visible))return;const o=s.clone();o.label=yl(o,e),n.push(o)}),n}};a([l()],ot.prototype,"attributes",void 0),a([l({type:[cd]})],ot.prototype,"expressionInfos",void 0),a([l()],ot.prototype,"description",void 0),a([l({type:[Wa]})],ot.prototype,"fieldInfos",void 0),a([l({readOnly:!0})],ot.prototype,"formattedFieldInfos",null),a([l()],ot.prototype,"title",void 0),ot=a([M("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],ot);const ps=ot,kh=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Ah(i){let e=null;return kh.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function Ph(i,e){if(typeof e!="string"||!e)return e;const t=Ah(e);if(!t)return e;const n=e.match(t.pattern),s=n&&n[2],o=Ri(Ri(t.label,{messages:i,hierPart:s}),{appName:t.appName}),r=t.target?` target="${t.target}"`:"",c=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${r} href="$1"${c}>${o}</a>`)}const Di={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let $e=class extends re{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new ps,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new hs,this.addHandles(v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),V))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:n}=this.viewModel,s=e.fieldName,o=e.label||s,r=n?n[s]==null?"":n[s]:"",c=!(!e.format||!e.format.dateFormat),d=typeof r=="number"&&!c?this._forceLTR(r):Ph(this.messagesURIUtils,r),u={[Di.fieldDataDate]:c};return m("tr",{key:`fields-element-info-row-${s}-${t}`},m("th",{key:`fields-element-info-row-header-${s}-${t}`,class:Di.fieldHeader,innerHTML:o}),m("td",{key:`fields-element-info-row-data-${s}-${t}`,class:this.classes(Di.fieldData,u),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?m("table",{class:Di.esriTable,summary:this.messages.fieldsSummary},m("tbody",null,e.map((t,n)=>this.renderFieldInfo(t,n)))):null}render(){var e;return m("div",{class:Di.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};a([l()],$e.prototype,"attributes",null),a([l()],$e.prototype,"description",null),a([l()],$e.prototype,"expressionInfos",null),a([l()],$e.prototype,"fieldInfos",null),a([l()],$e.prototype,"title",null),a([l({type:ps,nonNullable:!0})],$e.prototype,"viewModel",void 0),a([l(),ne("esri/widgets/Feature/t9n/Feature")],$e.prototype,"messages",void 0),a([l(),ne("esri/widgets/support/t9n/uriUtils")],$e.prototype,"messagesURIUtils",void 0),$e=a([M("esri.widgets.Feature.FeatureFields")],$e);const El=$e,$h={maximumFractionDigits:20};function Sh(i){return So(i,$h)}const Rh="<",Lh=">",Fh=Ga("short-date");function Oh(i,e,t,n){let s="";e===0?s=`${Rh} `:e===t&&(s=`${Lh} `);let o=null;return o=n?Gn(i,Fh):Sh(i),s+o}const Dh=new Ut([64,64,64]);function Vh(i,e){const t=[],n=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,n),i.map((s,o)=>t.includes(o)?Oh(s,o,n,e):null)}async function Nh(i,e,t){let n=!1,s=[],o=[];if(i.stops){const u=i.stops;s=u.map(h=>h.value),n=u.some(h=>!!h.label),n&&(o=u.map(h=>h.label))}const r=s[0],c=s[s.length-1];if(r==null&&c==null)return null;const d=n?null:Vh(s,t);return(await Promise.all(s.map(async(u,h)=>({value:u,color:i.type==="opacity"?await zh(u,i,e):(await b(()=>import("./UniqueValueRenderer-08aa8b40.js").then(p=>p.v),["assets/UniqueValueRenderer-08aa8b40.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/enumeration-cda3949b.js","assets/jsonMap-c8081704.js","assets/Extent-54ef1174.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/Clonable-c315fc8d.js","assets/LegendOptions-998df0a8.js","assets/reactiveUtils-b911287d.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/PopupTemplate-2917795f.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/jsonUtils-196b5f3d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js"])).getColor(i,u),label:n?o[h]:d[h]})))).reverse()}async function zh(i,e,t=Dh){const n=new Ut(t),s=(await b(()=>import("./UniqueValueRenderer-08aa8b40.js").then(o=>o.v),["assets/UniqueValueRenderer-08aa8b40.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/enumeration-cda3949b.js","assets/jsonMap-c8081704.js","assets/Extent-54ef1174.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/Clonable-c315fc8d.js","assets/LegendOptions-998df0a8.js","assets/reactiveUtils-b911287d.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/PopupTemplate-2917795f.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/jsonUtils-196b5f3d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js"])).getOpacity(e,i);return s!=null&&(n.a=s),n}function Bh(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(n=>{var s;return((s=n.color)==null?void 0:s.a)>0});let t=e.length-1;if(e&&e[0]){const n=e[t];n&&n.ratio!==1&&(e.push(new wd({ratio:1,color:n.color})),t++)}return e.map((n,s)=>{var r,c;let o="";return s===0?o=((r=i.legendOptions)==null?void 0:r.minLabel)||"low":s===t&&(o=((c=i.legendOptions)==null?void 0:c.maxLabel)||"high"),{color:n.color,label:o,ratio:n.ratio}}).reverse()}R.getLogger("esri.renderers.support.utils");async function Me(i,e,t){qc(i,e,()=>[]).push(...t)}async function qh(i){var t,n;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const s=i.visualVariables.filter(o=>o.type==="color");for(const o of s){const r=(await Nh(o)).map(c=>c.color);await Me(e,o.field||o.valueExpression,r)}}if(i.type==="heatmap"){const s=Bh(i).map(o=>o.color);await Me(e,i.field||i.valueExpression,s)}else if(i.type==="pie-chart"){for(const s of i.attributes)await Me(e,s.field||s.valueExpression,[s.color]);await Me(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,mi(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const s of i.attributes)await Me(e,s.field||s.valueExpression,[s.color]);await Me(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((n=i.authoringInfo)==null?void 0:n.type)==="predominance")for(const s of i.uniqueValueInfos??[])await Me(e,s.value.toString(),[mi(s.symbol,null)]);else{const s=(i.uniqueValueInfos??[]).map(u=>mi(u.symbol,null)),{field:o,field2:r,field3:c,valueExpression:d}=i;(o||d)&&await Me(e,o||d,s),r&&await Me(e,r,s),c&&await Me(e,c,s)}else if(i.type==="class-breaks"){const s=i.classBreakInfos.map(c=>mi(c.symbol,null)),{field:o,valueExpression:r}=i;await Me(e,o??r,s)}else i.type==="simple"&&await Me(e,"default",[mi(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await Me(e,"default",[mi(i.defaultSymbol,null)]),e.forEach((s,o)=>{const r=Rc(s.filter(Boolean),(c,d)=>JSON.stringify(c)===JSON.stringify(d));e.set(o,r)}),e}const Uh="esri.widgets.Feature.support.relatedFeatureUtils",Fr=R.getLogger(Uh),Or=new Map;function uo(i){if(!ht(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function Hh(i,e){if(!e.relationships)return null;let t=null;const{relationships:n}=e;return n.some(s=>s.id===parseInt(i,10)&&(t=s,!0)),t}function jh({originRelationship:i,relationships:e,layerId:t}){let n;return e&&e.some(s=>(`${s.relatedTableId}`===t&&s.id===i.id&&(n=s),!!n)),n}function Gh(i,e){const t=e.toLowerCase();for(const n in i)if(n.toLowerCase()===t)return i[n];return null}function Wh(i,e){const t=Hh(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function Zh(i,e){if(!e||!i)return;const{features:t,statsFeatures:n}=i,s=t&&t.value;e.relatedFeatures=s?s.features:[];const o=n&&n.value;e.relatedStatsFeatures=o?o.features:[]}function Kh(i,e,t,n){const s=new Xs;return s.outFields=["*"],s.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),s.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(s,n)}function Yh(i,e,t){let n=0;const s=[];for(;n<e.length;)s.push(`${i} IN (${e.slice(n,t+n)})`),n+=t;return s.join(" OR ")}async function Qh(i,e,t,n){const s=t.layerId.toString(),{layerInfo:o,relation:r,relatedFields:c,outStatistics:d,url:u,sourceSpatialReference:h}=e,p=jh({originRelationship:r,relationships:o.relationships,layerId:s});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const f=(await Kh(i,p,t,n))[i.attributes[t.objectIdField]];if(!f)return null;const _=f.features.map(C=>C.attributes[o.objectIdField]);if((d==null?void 0:d.length)>0&&o.supportsStatistics){const C=new bs;C.where=Yh(o.objectIdField,_,1e3),C.outFields=c,C.outStatistics=d,C.sourceSpatialReference=h;const T={features:Promise.resolve(f),statsFeatures:vs(u,C)};return qt(T)}}const g=p==null?void 0:p.keyField;if(g){const f=ad(ip(o.fields,g)),_=Gh(i.attributes,r.keyField),C=f?`${g}=${_}`:`${g}='${_}'`,T=vs(u,new bs({where:C,outFields:e.relatedFields,sourceSpatialReference:h}),n),A=e.outStatistics&&e.outStatistics.length>0&&o.supportsStatistics?vs(u,new bs({where:C,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:h}),n):null,F={features:T};return A&&(F.statsFeatures=A),qt(F)}return null}function Jh(i,e){return Ja(i,{query:{f:"json"},signal:e&&e.signal})}function Xh({relatedInfos:i,layer:e},t){const n={};return i.forEach((s,o)=>{const{relation:r}=s;if(!r){const p=new E("relation-required","A relation is required on a layer to retrieve related records.");throw Fr.error(p),p}const{relatedTableId:c}=r;if(typeof c!="number"){const p=new E("A related table ID is required on a layer to retrieve related records.");throw Fr.error(p),p}const d=`${e.url}/${c}`,u=Or.get(d),h=u||Jh(d,t);u||Or.set(d,h),n[o]=h}),qt(n)}function ep({graphic:i,relatedInfos:e,layer:t},n){const s={};return e.forEach((o,r)=>{o.layerInfo&&(s[r]=Qh(i,o,t,n))}),qt(s)}function tp({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const n=new bd({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(n)}}function ip(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const Dr={chartAnimation:!0};let X=class extends L{constructor(e){super(e),this.abilities={...Dr},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...Dr,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,n=(e+t)%t;this.activeMediaInfoIndex=n}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,n=t+e;this._setContentElementMedia(n)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:n,expressionAttributes:s,fieldInfoMap:o,layer:r}=this;return t==null?void 0:t.map(c=>{const d=c==null?void 0:c.clone();if(!d)return null;if(d.title=oi({attributes:e,fieldInfoMap:o,globalAttributes:n,expressionAttributes:s,layer:r,text:d.title}),d.caption=oi({attributes:e,fieldInfoMap:o,globalAttributes:n,expressionAttributes:s,layer:r,text:d.caption}),d.altText=oi({attributes:e,fieldInfoMap:o,globalAttributes:n,expressionAttributes:s,layer:r,text:d.altText}),d.type==="image"){const{value:u}=d;return this._setImageValue({value:u,formattedAttributes:n,layer:r}),d.value.sourceURL?d:void 0}if(d.type==="pie-chart"||d.type==="line-chart"||d.type==="column-chart"||d.type==="bar-chart"){const{value:u}=d;return this._setChartValue({value:u,chartType:d.type,attributes:e,formattedAttributes:n,layer:r,expressionAttributes:s}),d}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:n,formattedAttributes:s,layer:o}=e,{linkURL:r,sourceURL:c}=n;if(c){const d=co(c,o);n.sourceURL=lo({formattedAttributes:s,template:d,fieldInfoMap:t})}if(r){const d=co(r,o);n.linkURL=lo({formattedAttributes:s,template:d,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:n,formattedAttributes:s,chartType:o,layer:r,expressionAttributes:c}=e,{popupTemplate:d,relatedInfos:u}=this,{fields:h,normalizeField:p}=t;if(t.fields=Zu(h,r),p&&(t.normalizeField=cn(p,r)),!h.some(f=>!!(s[f]!=null||ht(f)&&u.size)))return;const g=d==null?void 0:d.fieldInfos;h.forEach(f=>{if(ht(f))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:g,fieldName:f,formattedAttributes:s,chartType:o,value:t})]);const _=this._getChartOption({value:t,attributes:n,chartType:o,formattedAttributes:s,expressionAttributes:c,fieldName:f,fieldInfos:g});t.series.push(_)})}_getRelatedChartInfos(e){var C;const{fieldInfos:t,fieldName:n,formattedAttributes:s,chartType:o,value:r}=e,c=[],d=uo(n),{layerId:u,fieldName:h}=d,p=(C=this.relatedInfos)==null?void 0:C.get(u.toString());if(!p)return c;const{relatedFeatures:g,relation:f}=p;if(!f||!g)return c;const{cardinality:_}=f;return g.forEach(T=>{const{attributes:A}=T;A&&Object.keys(A).forEach(F=>{F===h&&c.push(this._getChartOption({value:r,attributes:A,formattedAttributes:s,fieldName:n,chartType:o,relatedFieldName:F,fieldInfos:t}))})}),_==="one-to-many"||_==="many-to-many"?c:[c[0]]}_getTooltip({label:e,value:t,chartType:n}){return n==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var J;const{value:t,attributes:n,formattedAttributes:s,expressionAttributes:o,fieldName:r,relatedFieldName:c,fieldInfos:d,chartType:u}=e,{layer:h,fieldInfoMap:p}=this,{normalizeField:g,tooltipField:f}=t,_=g?ht(g)?n[uo(g).fieldName]:n[g]:null,C=Oo(r)&&o&&o[r]!==void 0?o[r]:c&&n[c]!==void 0?n[c]:n[r]!==void 0?n[r]:s[r],T=new dd({fieldName:r,value:C===void 0?null:C&&_?C/_:C});if(ht(r)){const B=p.get(r.toLowerCase()),de=p.get(f.toLowerCase()),Fe=(B==null?void 0:B.fieldName)??r,Qe=s[(de==null?void 0:de.fieldName)??f]??(B==null?void 0:B.label)??(B==null?void 0:B.fieldName)??c,gt=s[Fe];return T.tooltip=this._getTooltip({label:Qe,value:gt,chartType:u}),T}const A=wl(d,r),F=cn(r,h),O=f&&s[f]!==void 0?s[f]:yl(A||new Wa({fieldName:F}),(J=this.popupTemplate)==null?void 0:J.expressionInfos),z=s[F];return T.tooltip=this._getTooltip({label:O,value:z,chartType:u}),T}};a([l()],X.prototype,"abilities",void 0),a([be("abilities")],X.prototype,"castAbilities",null),a([l()],X.prototype,"activeMediaInfoIndex",void 0),a([l({readOnly:!0})],X.prototype,"activeMediaInfo",null),a([l()],X.prototype,"attributes",void 0),a([l()],X.prototype,"description",void 0),a([l()],X.prototype,"fieldInfoMap",void 0),a([l()],X.prototype,"formattedAttributes",void 0),a([l()],X.prototype,"expressionAttributes",void 0),a([l({readOnly:!0})],X.prototype,"formattedMediaInfos",null),a([l()],X.prototype,"layer",void 0),a([l({readOnly:!0})],X.prototype,"formattedMediaInfoCount",null),a([l()],X.prototype,"mediaInfos",void 0),a([l()],X.prototype,"popupTemplate",void 0),a([l()],X.prototype,"relatedInfos",void 0),a([l()],X.prototype,"title",void 0),X=a([M("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],X);const ri=X;var Vr=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],np=[].concat(Vr.slice(30,39),Vr.slice(28,30).reverse()),sp=[{name:"default",colors:np},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const Nr="en-us",qo=new Map([["ar",()=>b(()=>import("./ar-7e4d7001.js"),["assets/ar-7e4d7001.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.a)],["bg-bg",()=>b(()=>import("./bg_BG-fa0eaeae.js"),["assets/bg_BG-fa0eaeae.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["bs-ba",()=>b(()=>import("./bs_BA-4f949e9b.js"),["assets/bs_BA-4f949e9b.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["ca-es",()=>b(()=>import("./ca_ES-ac250c21.js"),["assets/ca_ES-ac250c21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["cs-cz",()=>b(()=>import("./cs_CZ-41aa2dde.js"),["assets/cs_CZ-41aa2dde.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["da-dk",()=>b(()=>import("./da_DK-3cc83778.js"),["assets/da_DK-3cc83778.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-de",()=>b(()=>import("./de_DE-7cf156b8.js"),["assets/de_DE-7cf156b8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-ch",()=>b(()=>import("./de_CH-b40119c2.js"),["assets/de_CH-b40119c2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["el-gr",()=>b(()=>import("./el_GR-f5b4e421.js"),["assets/el_GR-f5b4e421.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-us",()=>b(()=>import("./en_US-b653138f.js"),["assets/en_US-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-ca",()=>b(()=>import("./en_CA-b653138f.js"),["assets/en_CA-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["es-es",()=>b(()=>import("./es_ES-21713ea8.js"),["assets/es_ES-21713ea8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["et-ee",()=>b(()=>import("./et_EE-7e4a5525.js"),["assets/et_EE-7e4a5525.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["fi-fi",()=>b(()=>import("./fi_FI-9ff24319.js"),["assets/fi_FI-9ff24319.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["fr-fr",()=>b(()=>import("./fr_FR-51c37695.js"),["assets/fr_FR-51c37695.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["he-il",()=>b(()=>import("./he_IL-5c441159.js"),["assets/he_IL-5c441159.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hr-hr",()=>b(()=>import("./hr_HR-f42ffa87.js"),["assets/hr_HR-f42ffa87.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hu-hu",()=>b(()=>import("./hu_HU-5fba6ab9.js"),["assets/hu_HU-5fba6ab9.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["id-id",()=>b(()=>import("./id_ID-981fbb86.js"),["assets/id_ID-981fbb86.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["it-it",()=>b(()=>import("./it_IT-c635b784.js"),["assets/it_IT-c635b784.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["ja-jp",()=>b(()=>import("./ja_JP-e2cf7b21.js"),["assets/ja_JP-e2cf7b21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.j)],["ko-kr",()=>b(()=>import("./ko_KR-32aae4f2.js"),["assets/ko_KR-32aae4f2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.k)],["lt-lt",()=>b(()=>import("./lt_LT-3c0b9d54.js"),["assets/lt_LT-3c0b9d54.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["lv-lv",()=>b(()=>import("./lv_LV-c1cc4a4c.js"),["assets/lv_LV-c1cc4a4c.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["nb-no",()=>b(()=>import("./nb_NO-5958d98d.js"),["assets/nb_NO-5958d98d.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["nl-nl",()=>b(()=>import("./nl_NL-004b20fd.js"),["assets/nl_NL-004b20fd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["pl-pl",()=>b(()=>import("./pl_PL-d6d01c5e.js"),["assets/pl_PL-d6d01c5e.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-br",()=>b(()=>import("./pt_BR-a08a6ce1.js"),["assets/pt_BR-a08a6ce1.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-pt",()=>b(()=>import("./pt_PT-d532c840.js"),["assets/pt_PT-d532c840.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["ro-ro",()=>b(()=>import("./ro_RO-e4007f77.js"),["assets/ro_RO-e4007f77.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["ru-ru",()=>b(()=>import("./ru_RU-905ac2e8.js"),["assets/ru_RU-905ac2e8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["sk-sk",()=>b(()=>import("./sk_SK-cae815ce.js"),["assets/sk_SK-cae815ce.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sl-sl",()=>b(()=>import("./sl_SL-50353bbe.js"),["assets/sl_SL-50353bbe.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sr-rs",()=>b(()=>import("./sr_RS-9a9b8450.js"),["assets/sr_RS-9a9b8450.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sv-se",()=>b(()=>import("./sv_SE-346c1643.js"),["assets/sv_SE-346c1643.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["th-th",()=>b(()=>import("./th_TH-210af5ed.js"),["assets/th_TH-210af5ed.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["tr-tr",()=>b(()=>import("./tr_TR-855c517f.js"),["assets/tr_TR-855c517f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["uk-ua",()=>b(()=>import("./uk_UA-7de21af4.js"),["assets/uk_UA-7de21af4.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.u)],["vi-vn",()=>b(()=>import("./vi_VN-f87f03fa.js"),["assets/vi_VN-f87f03fa.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.v)],["zh-cn",()=>b(()=>import("./zh_Hans-79f10982.js"),["assets/zh_Hans-79f10982.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-hk",()=>b(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-tw",()=>b(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)]]);function op(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const n of qo.keys())if(n.startsWith(e)){t=n;break}return t}function rp(i){return i?qo.has(i.toLowerCase())?i.toLowerCase():op(i)||Nr:Nr}let _i,Vi;async function ap(i=Ed()){if(i=rp(i),_i&&i===Vi)return _i;_i=b(()=>import("./index-3c8f1bc3.js"),["assets/index-3c8f1bc3.js","assets/_commonjsHelpers-a430e9ea.js"]).then(e=>e.i),Vi=i;try{const[e,t]=await Promise.all([_i,qo.get(Vi)()]);Vi===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return _i=null,Vi=null,null}return _i}function lp(i,e="default"){const t=sp.find(n=>n.name===e);return t?t.colors.map(n=>i.color(n)):null}const W={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},Fs=.05,Os=.95,Ds=15,Je="color",_t="tooltip",Ni="value",zr="default-line-value";let _e=class extends re{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new ri,this.messages=null,this._getChartDependencies=async n=>{const s=await ap(),{destroyed:o,viewModel:r}=this;if(o||!r||!n)return;const{activeMediaInfo:c}=r,d=await this._getRendererColors(s);this._renderChart({chartDiv:n,mediaInfo:c,chartsModule:s,colorMap:d})}}initialize(){this._featureElementInfo=new hs,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),V),v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),V)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return m("div",{bind:this,class:W.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?m("div",{key:"media-element-container",class:W.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:n,formattedMediaInfoCount:s}=this.viewModel,{value:o,refreshInterval:r,altText:c,title:d,type:u}=e,{sourceURL:h,linkURL:p}=o,g=_l(p)?"_blank":"_self",f=g==="_blank"?"noreferrer":"",_=r?t:null,C=_?_.timestamp:0,T=_?_.sourceURL:h,A=m("img",{alt:c||d,key:`media-${u}-${n}-${s}-${C}`,src:T});return(p?m("a",{title:d,href:p,rel:f,target:g},A):null)||A}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:n}=this.viewModel;return m("div",{key:`media-${e.type}-${t}-${n}`,bind:this,class:W.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?m("div",{key:"media-title",class:W.mediaItemTitle,innerHTML:e.title}):null,n=e.caption?m("div",{key:"media-caption",class:W.mediaItemCaption,innerHTML:e.caption}):null;return m("div",{key:"media-container",class:W.mediaItemContainer},m("div",{key:"media-item-container",class:W.mediaItem},this.renderMediaInfoType()),t,n)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",n=t?this.messages.previous:this.messages.next,s=t?this.classes(W.mediaButton,W.mediaPrevious):this.classes(W.mediaButton,W.mediaNext),o=t?this.classes(W.mediaIcon,W.mediaPreviousIconLTR,W.iconLeftTriangleArrow):this.classes(W.mediaIcon,W.mediaNextIconLTR,W.iconRightTriangleArrow),r=t?this.classes(W.mediaIcon,W.mediaPreviousIconRTL,W.iconRightTriangleArrow):this.classes(W.mediaIcon,W.mediaNextIconRTL,W.iconLeftTriangleArrow),c=t?"media-previous":"media-next",d=t?this._previous:this._next;return m("button",{type:"button",key:c,title:n,"aria-label":n,tabIndex:0,class:s,bind:this,onclick:d},m("span",{"aria-hidden":"true",class:o}),m("span",{"aria-hidden":"true",class:r}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var c,d;const{am4core:t}=e,n=new Map,s=(d=(c=this.viewModel)==null?void 0:c.layer)==null?void 0:d.renderer,o="default";if(!s)return n;const r=await qh(s);return r.delete(o),Array.from(r.values()).every(u=>(u==null?void 0:u.length)===1)&&(n.set(zr,t.color({r:50,g:50,b:50,a:1})),Array.from(r.keys()).forEach(u=>{u&&n.set(u,t.color(r.get(u)[0].toCss(!0)))})),n}_handleMediaKeyup(e){const t=ii(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:n,chartDiv:s,mediaInfo:o,colorMap:r}=e,{value:c,type:d}=o,{am4core:u}=n,h=lp(u);function p(_){_ instanceof u.ColorSet&&h&&(_.list=h)}Jn()&&u.useTheme(n.am4themes_dark);const g=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!g.matches?u.useTheme(n.am4themes_animated):u.unuseTheme(n.am4themes_animated),u.useTheme(p);const f=d==="pie-chart"?this._createPieChart(e):this._createXYChart(e);s.setAttribute("aria-label",o.altText||o.title),f.data=c.series.map(_=>({[_t]:_.tooltip,[Ni]:_.value,[Je]:r.get(_.fieldName)})).filter(_=>d!=="pie-chart"||_.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:n}=e,{am4core:s,am4charts:o}=n,r=s.create(t,o.PieChart);r.rtl=Ge(this.container);const c=r.series.push(new o.PieSeries);return c.labels.template.disabled=!0,c.ticks.template.disabled=!0,c.dataFields.value=Ni,c.dataFields.category=_t,this._customizeChartTooltip(c.tooltip,s),c.slices.template.propertyFields.fill=Je,c.slices.template.propertyFields.stroke=Je,r}_getMinSeriesValue(e){let t=0;return e.forEach(n=>t=Math.min(n.value,t)),t}_createColumnChart(e,t){const{chartsModule:n,mediaInfo:s}=t,{value:o}=s,{am4core:r,am4charts:c}=n,d=e.xAxes.push(new c.CategoryAxis);d.dataFields.category=_t,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,r),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dy=-d.tooltip.contentHeight});const u=e.yAxes.push(new c.ValueAxis),h=u.renderer.labels.template;u.renderer.minLabelPosition=Fs,u.renderer.maxLabelPosition=Os,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,r),h.wrap=!0;const p=e.series.push(new c.ColumnSeries);p.dataFields.valueY=Ni,p.dataFields.categoryX=_t,p.columns.template.propertyFields.fill=Je,p.columns.template.propertyFields.stroke=Je,e.cursor=new c.XYCursor,o.series.length>Ds&&(e.scrollbarX=new r.Scrollbar)}_createBarChart(e,t){const{chartsModule:n,mediaInfo:s}=t,{value:o}=s,{am4core:r,am4charts:c}=n,d=e.yAxes.push(new c.CategoryAxis);d.dataFields.category=_t,d.renderer.inversed=!0,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,r),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dx=d.tooltip.contentWidth});const u=e.xAxes.push(new c.ValueAxis),h=u.renderer.labels.template;u.renderer.minLabelPosition=Fs,u.renderer.maxLabelPosition=Os,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,r),h.wrap=!0;const p=e.series.push(new c.ColumnSeries);p.dataFields.valueX=Ni,p.dataFields.categoryY=_t,p.columns.template.propertyFields.fill=Je,p.columns.template.propertyFields.stroke=Je,e.cursor=new c.XYCursor,o.series.length>Ds&&(e.scrollbarY=new r.Scrollbar)}_createLineChart(e,t){const{chartsModule:n,mediaInfo:s,colorMap:o}=t,{value:r}=s,{am4core:c,am4charts:d}=n,u=e.xAxes.push(new d.CategoryAxis);u.dataFields.category=_t,u.renderer.labels.template.disabled=!0,this._customizeChartTooltip(u.tooltip,c),u.tooltip.events.on("sizechanged",()=>{u.tooltip.dy=-u.tooltip.contentHeight});const h=e.yAxes.push(new d.ValueAxis),p=h.renderer.labels.template;h.renderer.minLabelPosition=Fs,h.renderer.maxLabelPosition=Os,h.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(h.tooltip,c),p.wrap=!0;const g=e.series.push(new d.LineSeries);g.dataFields.categoryX=_t,g.dataFields.valueY=Ni,g.strokeWidth=1;const f=o.get(zr);f&&(g.stroke=f);const _=g.bullets.push(new d.CircleBullet);_.propertyFields.fill=Je,_.propertyFields.stroke=Je,e.cursor=new d.XYCursor,r.series.length>Ds&&(e.scrollbarX=new c.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:n,mediaInfo:s}=e,{type:o}=s,{am4core:r,am4charts:c}=n,d=r.create(t,c.XYChart);return d.rtl=Ge(this.container),o==="column-chart"&&this._createColumnChart(d,e),o==="bar-chart"&&this._createBarChart(d,e),o==="line-chart"&&this._createLineChart(d,e),d}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:n}=e;if(!t)return;const s=6e4*t;this._updateMediaInfoTimestamp(n.sourceURL);const o=setInterval(()=>{this._updateMediaInfoTimestamp(n.sourceURL)},s);this._refreshTimer=o}_getImageSource(e,t){const n=e.includes("?")?"&":"?",[s,o=""]=e.split("#");return`${s}${n}timestamp=${t}${o?"#":""}${o}`}};a([l()],_e.prototype,"attributes",null),a([l()],_e.prototype,"activeMediaInfoIndex",null),a([l()],_e.prototype,"description",null),a([l()],_e.prototype,"fieldInfoMap",null),a([l()],_e.prototype,"layer",null),a([l()],_e.prototype,"mediaInfos",null),a([l()],_e.prototype,"popupTemplate",null),a([l()],_e.prototype,"relatedInfos",null),a([l()],_e.prototype,"title",null),a([l({type:ri})],_e.prototype,"viewModel",void 0),a([l(),ne("esri/widgets/Feature/t9n/Feature")],_e.prototype,"messages",void 0),_e=a([M("esri.widgets.Feature.FeatureMedia")],_e);const xl=_e,cp=["$datastore","$map","$layer","$aggregatedfeatures"],dp="esri.widgets.Feature.support.arcadeFeatureUtils",up=R.getLogger(dp);function hp(i){return typeof i=="string"?fn(Vo(i)):Array.isArray(i)?pp(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?mp(i):i}function pp(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?fn(Vo(e)):e}</li>`).join("")}</ul>`}function mp(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?fn(Vo(t)):t}</td></tr>`}).join("")}</table>`}function gp({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:n,viewInfo:s,map:o,graphic:r,interceptor:c}){t.forEach(d=>{const u=d.toLowerCase(),h={map:o,spatialReference:s.sr,interceptor:c};if(u==="$map"&&(n.vars[u]=e.convertMapToFeatureSetCollection(h)),u==="$layer"&&(n.vars[u]=e.convertFeatureLayerToFeatureSet({layer:r.sourceLayer,spatialReference:s.sr,interceptor:c})),u==="$datastore"&&(n.vars[u]=e.convertServiceUrlToWorkspace({url:r.sourceLayer.url,spatialReference:s.sr,interceptor:c})),u==="$aggregatedfeatures"){const p=r.layer,{fields:g,objectIdField:f,geometryType:_,spatialReference:C,displayField:T}=p,A=new kd({fields:g,objectIdField:f,geometryType:_,spatialReference:C,displayField:T,...p.type==="feature"?{templates:p.templates,typeIdField:p.typeIdField,types:p.types}:null,source:i});n.vars[u]=e.convertFeatureLayerToFeatureSet({layer:A,spatialReference:s.sr,interceptor:c})}})}function kl(){return b(()=>import("./arcadeUtils-38db4e06.js").then(i=>i.ay),["assets/arcadeUtils-38db4e06.js","assets/geometry-22feb2bb.js","assets/ArrayPool-45db95ab.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/Error-1dfe2922.js","assets/Extent-54ef1174.js","assets/cast-7ef3a066.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/preload-helper-596b5639.js","assets/number-a88b0f3f.js","assets/locale-30120714.js","assets/Field-a857bb5a.js","assets/enumeration-cda3949b.js","assets/fieldType-36e8171c.js","assets/jsonUtils-196b5f3d.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/request-3bbdab19.js","assets/unitUtils-58dc72ed.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/sizeVariableUtils-d4870b0d.js"])}function fp(i){return"createQuery"in i&&"queryFeatures"in i}async function _p({graphic:i,view:e}){const{isAggregate:t,layer:n}=i;if(!t||!n||(e==null?void 0:e.type)!=="2d")return[];const s=await e.whenLayerView(n);if(!fp(s))return[];const o=s.createQuery();o.aggregateIds=[i.getObjectId()];const{features:r}=await s.queryFeatures(o);return r}async function Al({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:n,map:s,graphic:o,view:r}){if(!i||!i.expression)return null;const c=e.createSyntaxTree(i.expression),d=cp.filter(f=>e.hasVariable(c,f)),[u]=await Promise.all([_p({graphic:o,view:r}),e.loadScriptDependencies(c,!0,d)]),h=e.getViewInfo({spatialReference:n}),p=e.createExecContext(o,h);p.interceptor=t,p.useAsync=!0,gp({aggregatedFeatures:u,arcadeUtils:e,featureSetVars:d,context:p,viewInfo:h,map:s,graphic:o,interceptor:t});const g=e.createFunction(c,p);return e.executeAsyncFunction(g,p).catch(f=>up.error("arcade-execution-error",{error:f,graphic:o,expressionInfo:i}))}async function yp({expressionInfos:i,spatialReference:e,graphic:t,interceptor:n,map:s,view:o}){if(!i||!i.length)return{};const r=await kl(),c={};for(const h of i)c[`expression/${h.name}`]=Al({expressionInfo:h,arcadeUtils:r,interceptor:n,spatialReference:e,map:s,graphic:t,view:o});const d=await qt(c),u={};for(const h in d)u[h]=hp(d[h].value);return u}const vp=1;let Ie=class extends as(L){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var s,o;const t=(s=this.contentElement)==null?void 0:s.type;(o=this.contentElementViewModel)==null||o.destroy();const n=t==="fields"?new ps:t==="media"?new ri:t==="text"?new Qn:null;this._set("contentElementViewModel",n)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=Pi(this._compile,vp,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:n,interceptor:s,spatialReference:o,map:r,view:c,_abortController:d}=this;if(!(t&&n&&o&&r))return void this._set("contentElement",null);const u=await kl();if(d!==this._abortController)return;const h=await Al({arcadeUtils:u,expressionInfo:t,graphic:n,interceptor:s,map:r,spatialReference:o,view:c});if(!h||h.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const p=await h.castAsJsonAsync(d.signal),g=p==null?void 0:p.type,f=g==="media"?ud.fromJSON(p):g==="text"?Za.fromJSON(p):g==="fields"?hd.fromJSON(p):null;this._set("contentElement",f)},this.handles.add([v(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),V),v(()=>[this.contentElement],()=>this._createVM(),V)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:n}=this;return e?"loading":t||n?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};a([l()],Ie.prototype,"_abortController",void 0),a([l({type:pd})],Ie.prototype,"expressionInfo",void 0),a([l({type:Ye})],Ie.prototype,"graphic",void 0),a([l({readOnly:!0})],Ie.prototype,"contentElement",void 0),a([l({readOnly:!0})],Ie.prototype,"contentElementViewModel",void 0),a([l()],Ie.prototype,"interceptor",void 0),a([l()],Ie.prototype,"spatialReference",null),a([l({readOnly:!0})],Ie.prototype,"state",null),a([l()],Ie.prototype,"map",null),a([l()],Ie.prototype,"view",void 0),Ie=a([M("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Ie);const Uo=Ie,wn={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let Sn=class extends re{constructor(e,t){super(e,t),this.viewModel=new Uo}initialize(){this.addHandles(v(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),V))}destroy(){this._destroyContentWidget()}renderLoading(){return m("div",{key:"loading-container",class:wn.loadingSpinnerContainer},m("span",{class:this.classes(wn.iconLoading,wn.spinner)}))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:wn.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,n=t==null?void 0:t.type;this._destroyContentWidget();const s=e?n==="fields"?new El({viewModel:e}):n==="media"?new xl({viewModel:e}):n==="text"?new $n({viewModel:e}):null:null;this._contentWidget=s,this.scheduleRender()}};a([l({type:Uo})],Sn.prototype,"viewModel",void 0),Sn=a([M("esri.widgets.Feature.FeatureExpression")],Sn);const wp=Sn,Vs=100;let q=class extends La(tl(as(L))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await tn(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await tn(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await tn(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=Pi(this._queryController,Vs,this),this._queryFeatureCountThrottled=Pi(this._queryFeatureCountController,Vs,this),this._queryPageThrottled=Pi(this._queryPageController,Vs,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:n}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,n.removeAll(),n.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([v(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),V),v(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),v(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:n}=this,s=1,o=Math.ceil(n/t)||1;this._set("featurePage",Math.min(Math.max(e,s),o))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(n=>{const s=n.clone(),o=cn(n.field,t);return s.field=o,s}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new G}get relatedLayer(){const{layer:e,map:t,relationship:n}=this;return e!=null&&e.loaded?mh(t,e,n):null}get relationship(){var n;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((n=t==null?void 0:t.relationships)==null?void 0:n.find(({id:s})=>s===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new G}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:n,graphic:s,relatedLayer:o}=this;return t?"loading":e||n?"querying":s&&o?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var h,p,g,f;const{layer:e,relatedLayer:t,relationshipId:n,objectId:s,_queryFeatureCountAbortController:o}=this;if(await(e==null?void 0:e.load()),!t||typeof s!="number"||!((p=(h=e==null?void 0:e.capabilities)==null?void 0:h.queryRelated)!=null&&p.supportsCount))return void this._set("featureCount",0);await t.load();const r=t.createQuery(),c=((f=(g=e.capabilities)==null?void 0:g.queryRelated)==null?void 0:f.supportsCacheHint)??!1,d=new Xs({cacheHint:c,relationshipId:n,returnGeometry:!1,objectIds:[s],where:r.where}),u=await e.queryRelatedFeaturesCount(d,{signal:o==null?void 0:o.signal});this._set("featureCount",u[s]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:n}=this;return t?e:n?e.slice(0,n):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:n,_queryPageAbortController:s}=this;!n||t<2||e.addMany(await this._queryRelatedFeatures({signal:s==null?void 0:s.signal}))}async _queryRelatedFeatures(e){var B,de,Fe,Qe,gt;const{orderByFieldsFixedCasing:t,showAllEnabled:n,featuresPerPage:s,displayCount:o,layer:r,relationshipId:c,featurePage:d,featureCount:u,relatedLayer:h}=this;await(r==null?void 0:r.load());const{relationship:p,objectId:g}=this;if(!p||typeof g!="number"||!((de=(B=r==null?void 0:r.capabilities)==null?void 0:B.queryRelated)!=null&&de.supportsPagination))return[];const f=n?((d-1)*s+u)%u:0,_=n?s:o;if(!h)return[];await h.load();const C=h.objectIdField,T=[...t==null?void 0:t.map(ue=>ue.field),C],A=t==null?void 0:t.map(ue=>`${ue.field} ${ue.order}`),F=((Qe=(Fe=r.capabilities)==null?void 0:Fe.queryRelated)==null?void 0:Qe.supportsCacheHint)||!1,O=h.createQuery(),z=new Xs({orderByFields:A,start:f,num:_,outFields:T,cacheHint:F,relationshipId:c,returnGeometry:!1,objectIds:[g],where:O.where}),J=((gt=(await r.queryRelatedFeatures(z,{signal:e==null?void 0:e.signal}))[g])==null?void 0:gt.features)||[];return J.forEach(ue=>ue.sourceLayer=h),J}};a([l()],q.prototype,"_queryAbortController",void 0),a([l()],q.prototype,"_queryPageAbortController",void 0),a([l()],q.prototype,"_queryFeatureCountAbortController",void 0),a([l({value:1})],q.prototype,"featurePage",null),a([l()],q.prototype,"featuresPerPage",void 0),a([l({readOnly:!0})],q.prototype,"orderByFieldsFixedCasing",null),a([l()],q.prototype,"description",void 0),a([l({readOnly:!0})],q.prototype,"itemDescriptionFieldName",null),a([l({value:3})],q.prototype,"displayCount",null),a([l({type:Ye})],q.prototype,"graphic",void 0),a([l()],q.prototype,"layer",void 0),a([l()],q.prototype,"map",void 0),a([l({readOnly:!0})],q.prototype,"objectId",null),a([l({readOnly:!0})],q.prototype,"objectIdField",null),a([l()],q.prototype,"orderByFields",void 0),a([l({readOnly:!0})],q.prototype,"relatedFeatures",null),a([l({readOnly:!0})],q.prototype,"relatedLayer",null),a([l({readOnly:!0})],q.prototype,"relationship",null),a([l({readOnly:!0})],q.prototype,"featureCount",void 0),a([l({readOnly:!0})],q.prototype,"relatedFeatureViewModels",null),a([l()],q.prototype,"relationshipId",void 0),a([l()],q.prototype,"showAllEnabled",void 0),a([l({readOnly:!0})],q.prototype,"state",null),a([l()],q.prototype,"title",void 0),q=a([M("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],q);const Ho=q,Xe={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},Br={title:!0,description:!0};let pe=class extends re{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([n])=>{n!=null&&n.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new Ho,this.messages=null,this.messagesCommon=null,this.visibleElements={...Br},this._increaseFeaturePage=()=>{const{state:n,showAllEnabled:s,relatedFeatures:o,featuresPerPage:r,featurePage:c}=this.viewModel;n==="ready"&&s&&o.length>=r*c&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new hs,this.addHandles([v(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),V),v(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),Se(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([b(()=>import("./calcite-list-b49a71d2.js"),["assets/calcite-list-b49a71d2.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/interactive-52dcf836.js"]),b(()=>import("./calcite-list-item-97c9b4ac.js"),["assets/calcite-list-item-97c9b4ac.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/conditionalSlot-b3cf38bb.js","assets/observers-cf6d0d57.js","assets/interactive-52dcf836.js"]),b(()=>import("./calcite-icon-331afcfb.js"),["assets/calcite-icon-331afcfb.js","assets/icon-39f1fc65.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/observers-cf6d0d57.js"]),b(()=>import("./calcite-notice-d72081f8.js"),["assets/calcite-notice-d72081f8.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/conditionalSlot-b3cf38bb.js","assets/observers-cf6d0d57.js","assets/icon-39f1fc65.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=ge(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:n}=this.viewModel;return!e&&(t>n||n===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return je(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...Br,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?m("div",{key:"sticky-loader",class:Xe.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return m("span",{class:this.classes(Xe.iconLoading,Xe.spinner)})}renderLoading(){return m("div",{key:"loading-container",class:Xe.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return m("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=Ge(this.container)?"chevron-left":"chevron-right";return m("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var o,r;const{itemDescriptionFieldName:t}=this.viewModel,n=e.title;e.description=t&&((o=e.formattedAttributes)==null?void 0:o.global[t]);const s=e.state==="loading";return m("calcite-list-item",{key:e.uid,label:s?`${(r=this.messagesCommon)==null?void 0:r.loading}`:n,description:s?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?m("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return m("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return m("div",{key:"feature-observer",class:Xe.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return m("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return m("div",{key:"list-container",class:this.classes(Xe.listContainer,{[Xe.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return m("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:this.classes(Xe.base,Xe.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(n=>{this.addHandles(v(()=>[n.title,n.state],()=>this.scheduleRender(),V),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,n=t.description&&this.description,s=t.title&&this.title;this._featureElementInfo.set({description:n,title:s,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await Po(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};a([l()],pe.prototype,"_relatedFeatureIntersectionObserverNode",void 0),a([l({readOnly:!0})],pe.prototype,"displayShowAllButton",null),a([l({readOnly:!0})],pe.prototype,"displayListItems",null),a([l()],pe.prototype,"description",null),a([l({readOnly:!0})],pe.prototype,"featureCountDescription",null),a([l()],pe.prototype,"headingLevel",void 0),a([l()],pe.prototype,"title",null),a([l({type:Ho})],pe.prototype,"viewModel",void 0),a([l(),ne("esri/widgets/Feature/t9n/Feature")],pe.prototype,"messages",void 0),a([l(),ne("esri/t9n/common")],pe.prototype,"messagesCommon",void 0),a([l()],pe.prototype,"visibleElements",void 0),a([be("visibleElements")],pe.prototype,"castVisibleElements",null),pe=a([M("esri.widgets.Feature.FeatureRelationship")],pe);const qr=pe;let bp=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=n=>{}),this.preRequestCallback||(this.preLayerQueryCallback=n=>{})}};var Yi;const Mp=1,Ur="content-view-models",Hr="relationship-view-models",jr={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let H=Yi=class extends tl(L){constructor(i){super(i),this._handles=new Ke,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=Pi(this._graphicChanged,Mp,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...jr},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(v(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),V))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return w(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return rh(kr(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return fl(this.graphic)}castAbilities(i){return{...jr,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof ri&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof ri&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof ri&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){Na(t)||(this._error=t,R.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new Za({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(Hr),(e=this._handles)==null||e.remove(Ur),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var s;const t=(s=i==null?void 0:i.graphic)==null?void 0:s.getObjectId(),n=e==null?void 0:e.getObjectId();return w(t)&&w(n)&&t===n}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(n=>{i.find(s=>this._matchesFeature(s,n))||i.add(new Yi({abilities:{relationshipContent:!1},map:t,graphic:n}))}),i.forEach(n=>{(e==null?void 0:e.find(o=>this._matchesFeature(n,o)))||i.remove(n)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:n,contentElementViewModel:s}=i,o=n==null?void 0:n.type;s&&o&&(o==="fields"&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:e,formattedAttributes:t}),s.set(this._createFieldsVMParams(n,e))),o==="media"&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:e,formattedAttributes:t}),s.set(this._createMediaVMParams(n,e))),o==="text"&&s.set(this._createTextVMParams(n)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:n,relationshipId:s,title:o,description:r}=i,{_sourceLayer:c,graphic:d,map:u}=this,h=new Ho({displayCount:t,graphic:d,orderByFields:n,relationshipId:s,layer:c,map:u,...this._compileTitleAndDesc({title:o,description:r})});return this.contentViewModels[e]=h,this._handles.add(Se(()=>h.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(h)),Hr),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:n,map:s,spatialReference:o,view:r}=this,c=new Uo({expressionInfo:t,graphic:n,interceptor:Yi.interceptor,map:s,spatialReference:o,view:r});return this.contentViewModels[e]=c,this._handles.add(v(()=>c.contentElementViewModel,()=>this._setExpressionContentVM(c,e),V),Ur),i}_compileAttachments(i,e){const{graphic:t}=this,{description:n,title:s}=i;return this.contentViewModels[e]=new zo({graphic:t,...this._compileTitleAndDesc({title:s,description:n})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:n,destroyer:s}=i;return this.contentViewModels[e]=new Qn({graphic:t,creator:n,destroyer:s}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:n,graphic:s,formattedAttributes:o,_expressionAttributes:r}=this,{attributes:c}=s,d=o.global;return{title:oi({attributes:c,fieldInfoMap:t,globalAttributes:d,expressionAttributes:r,layer:n,text:i}),description:oi({attributes:c,fieldInfoMap:t,globalAttributes:d,expressionAttributes:r,layer:n,text:e})}}_createFieldsVMParams(i,e){var u;const{_effectivePopupTemplate:t,formattedAttributes:n}=this,s={...n.global,...n.content[e]},o=(u=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:u.filter(({fieldName:h})=>Oo(h)||ht(h)||s.hasOwnProperty(h)),r=t==null?void 0:t.expressionInfos,{description:c,title:d}=i;return{attributes:s,expressionInfos:r,fieldInfos:o,...this._compileTitleAndDesc({title:d,description:c})}}_compileFields(i,e){const t=i.clone(),n=new ps(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=n,t.fieldInfos=n.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:n,_fieldInfoMap:s,formattedAttributes:o,_effectivePopupTemplate:r,relatedInfos:c,_sourceLayer:d,_expressionAttributes:u}=this,{attributes:h}=n,{description:p,mediaInfos:g,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:h,layer:d,fieldInfoMap:s,formattedAttributes:{...o.global,...o.content[e]},expressionAttributes:u,mediaInfos:g,popupTemplate:r,relatedInfos:c,...this._compileTitleAndDesc({title:f,description:p})}}_compileMedia(i,e){const t=i.clone(),n=new ri(this._createMediaVMParams(i,e));return t.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[e]=n,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:n,_expressionAttributes:s}=this;if(i&&i.text){const{attributes:o}=e,r=this.formattedAttributes.global;i.text=oi({attributes:o,fieldInfoMap:t,globalAttributes:r,expressionAttributes:s,layer:n,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new Qn(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:n}=i,s=e==null?void 0:e.editFieldsInfo;return n&&s?oh(s,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:n,_expressionAttributes:s}=this,{attributes:o}=n,r=this.formattedAttributes.global;return oi({attributes:o,fieldInfoMap:e,globalAttributes:r,expressionAttributes:s,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return Yn(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return Yn(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:n,_effectivePopupTemplate:s,spatialReference:o,map:r,view:c}=this;if(e!==this._featureAbortController||!n)return;await ch({graphic:n,popupTemplate:s,layer:t,spatialReference:o},i);const{content:{value:d},title:{value:u}}=await qt({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:h}}=await qt({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:yp({expressionInfos:s==null?void 0:s.expressionInfos,spatialReference:o,graphic:n,map:r,interceptor:Yi.interceptor,view:c})});e===this._featureAbortController&&n&&(this._expressionAttributes=h,this._graphicExpressionAttributes={...n.attributes,...h},this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(u)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:n,graphic:s,relatedInfos:o,_sourceLayer:r,_fieldInfoMap:c,_graphicExpressionAttributes:d}=this;t.content[e]=$s({fieldInfos:n==null?void 0:n.fieldInfos,graphic:s,attributes:{...d,...i.attributes},layer:r,fieldInfoMap:c,relatedInfos:o})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:n,relatedInfos:s,_sourceLayer:o,_fieldInfoMap:r,_graphicExpressionAttributes:c}=this;t.content[e]=$s({fieldInfos:i.fieldInfos,graphic:n,attributes:{...c,...i.attributes},layer:o,fieldInfoMap:r,relatedInfos:s})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:n,_sourceLayer:s,_fieldInfoMap:o,_graphicExpressionAttributes:r}=this,c=e==null?void 0:e.fieldInfos,d={global:$s({fieldInfos:c,graphic:t,attributes:r,layer:s,fieldInfoMap:o,relatedInfos:n}),content:[]};return Array.isArray(i)&&i.forEach((u,h)=>{u.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:u,contentElementIndex:h,formattedAttributes:d}),u.type==="media"&&this._createMediaFormattedAttributes({contentElement:u,contentElementIndex:h,formattedAttributes:d})}),d}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,kr(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:n,_sourceLayer:s}=this;n.clear();const o=w(s.associatedLayer)?await s.associatedLayer.load(t):s;if(!o)return;const r=e.filter(u=>u&&ht(u.fieldName));if(!r||!r.length)return;e.forEach(u=>this._configureRelatedInfo(u,o));const c=await Xh({relatedInfos:n,layer:o},t);Object.keys(c).forEach(u=>{var g;const h=n.get(u.toString()),p=(g=c[u])==null?void 0:g.value;h&&p&&(h.layerInfo=p.data)});const d=await ep({graphic:i,relatedInfos:n,layer:o},t);Object.keys(d).forEach(u=>{var h;Zh((h=d[u])==null?void 0:h.value,n.get(u.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,n=uo(i.fieldName);if(!n)return;const{layerId:s,fieldName:o}=n;if(!s)return;const r=t.get(s.toString())||Wh(s,e);r&&(tp({relatedInfo:r,fieldName:o,fieldInfo:i}),this.relatedInfos.set(s,r))}};H.interceptor=new bp(hh,ph),a([l()],H.prototype,"_error",void 0),a([l()],H.prototype,"_featureAbortController",void 0),a([l({readOnly:!0})],H.prototype,"_effectivePopupTemplate",null),a([l({readOnly:!0})],H.prototype,"_fieldInfoMap",null),a([l({readOnly:!0})],H.prototype,"_sourceLayer",null),a([l()],H.prototype,"abilities",void 0),a([be("abilities")],H.prototype,"castAbilities",null),a([l({readOnly:!0})],H.prototype,"content",void 0),a([l({readOnly:!0})],H.prototype,"contentViewModels",void 0),a([l()],H.prototype,"description",void 0),a([l({type:Boolean})],H.prototype,"defaultPopupTemplateEnabled",void 0),a([l({readOnly:!0})],H.prototype,"state",null),a([l({readOnly:!0})],H.prototype,"formattedAttributes",void 0),a([l({type:Ye,value:null})],H.prototype,"graphic",null),a([l({readOnly:!0})],H.prototype,"lastEditInfo",void 0),a([l({readOnly:!0})],H.prototype,"relatedInfos",void 0),a([l()],H.prototype,"spatialReference",null),a([l({readOnly:!0})],H.prototype,"title",void 0),a([l()],H.prototype,"map",null),a([l({readOnly:!0})],H.prototype,"waitingForContent",null),a([l()],H.prototype,"view",void 0),H=Yi=a([M("esri.widgets.FeatureViewModel")],H);const jo=H,j={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},Pl=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>Ba(t)&&!t.destroyed?m("div",{class:j.contentNode,key:t},t.render()):t instanceof HTMLElement?m("div",{class:j.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):ed(t)?m("div",{class:j.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const n=this;t.appendChild(n)}};return e=a([M("esri.widgets.Feature.ContentMixin")],e),e};var ho;const Gr={title:!0,content:!0,lastEditedInfo:!0},Wr="relationship-handles";let ie=ho=class extends Pl(re){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...Gr},this.viewModel=new jo}initialize(){this.addHandles(v(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),V))}loadDependencies(){return b(()=>import("./calcite-notice-d72081f8.js"),["assets/calcite-notice-d72081f8.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/conditionalSlot-b3cf38bb.js","assets/observers-cf6d0d57.js","assets/icon-39f1fc65.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...Gr,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=m("div",{class:j.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return m("div",{class:this.classes(j.base,j.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return m("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?m("div",{key:"error-title",slot:"title"},i.errorMessage):null,m("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return m("div",{key:"loading-container",class:j.loadingSpinnerContainer},m("span",{class:this.classes(j.iconLoading,j.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?m("div",{class:j.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?m(Bo,{level:this.headingLevel,class:j.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?m("div",{class:j.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:m("div",{class:j.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:n}=e.viewModel;return t==="loading"||n.length>0?m("div",{key:this._buildKey("attachments-element",i),class:this.classes(j.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?m("div",{key:this._buildKey("relationship-element",i),class:j.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("expression-element",i),class:j.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,n=this._contentWidgets[e];return!n||n.destroyed?null:t?m("div",{key:this._buildKey("custom-element",e),class:j.contentElement},n.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("fields-element",i),class:j.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("media-element",i),class:j.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:n,user:s}=t,o=t.type==="edit"?s?e.lastEditedByUser:e.lastEdited:s?e.lastCreatedByUser:e.lastCreated,r=je(o,{date:n,user:s});return m("div",{key:"edit-info-element",class:this.classes(j.lastEditedInfo,j.contentElement)},r)}renderText(i,e){const t=i.text,n=this._contentWidgets[e];return!n||n.destroyed?null:t?m("div",{key:this._buildKey("text-element",e),class:this.classes(j.contentElement,j.text)},n.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(Wr),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([Se(()=>i,"select-record",({featureViewModel:n})=>{e&&(n.abilities={relationshipContent:!0},e.push(new ho({flowItems:e,viewModel:n,visibleElements:t})))}),Se(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:n}=i;n.showAllEnabled=!0;const s=new qr({visibleElements:{title:!1,description:!1},viewModel:n});this._addFeatureRelationshipHandles(s),e.push(s)})],Wr)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:n}=this.viewModel;if(Array.isArray(t))t.forEach((s,o)=>{if(s.type==="attachments"&&(this._contentWidgets[o]=new wh({displayType:s.displayType,headingLevel:e.title?i+1:i,viewModel:n[o]})),s.type==="fields"&&(this._contentWidgets[o]=new El({viewModel:n[o]})),s.type==="media"&&(this._contentWidgets[o]=new xl({viewModel:n[o]})),s.type==="text"&&(this._contentWidgets[o]=new $n({viewModel:n[o]})),s.type==="custom"&&(this._contentWidgets[o]=new $n({viewModel:n[o]})),s.type==="expression"&&(this._contentWidgets[o]=new wp({viewModel:n[o]})),s.type==="relationship"){const r=new qr({viewModel:n[o]});this._addFeatureRelationshipHandles(r),this._contentWidgets[o]=r}},this);else{const s=n[0];s&&!s.destroyed&&(this._contentWidgets[0]=new $n({viewModel:s}))}this.scheduleRender()}};a([l()],ie.prototype,"graphic",null),a([l()],ie.prototype,"defaultPopupTemplateEnabled",null),a([l()],ie.prototype,"flowItems",void 0),a([l()],ie.prototype,"headingLevel",void 0),a([l()],ie.prototype,"label",null),a([l(),ne("esri/widgets/Feature/t9n/Feature")],ie.prototype,"messages",void 0),a([l(),ne("esri/t9n/common")],ie.prototype,"messagesCommon",void 0),a([l(),ne("esri/widgets/support/t9n/uriUtils")],ie.prototype,"messagesURIUtils",void 0),a([l()],ie.prototype,"spatialReference",null),a([l({readOnly:!0})],ie.prototype,"title",null),a([l()],ie.prototype,"visibleElements",void 0),a([be("visibleElements")],ie.prototype,"castVisibleElements",null),a([l()],ie.prototype,"map",null),a([l()],ie.prototype,"view",null),a([l({type:jo})],ie.prototype,"viewModel",void 0),ie=ho=a([M("esri.widgets.Feature")],ie);const Ip=ie;var $l;const Rn=Symbol("anchorHandles");let Kt=class extends pn.EventedAccessor{constructor(e){super(e),this[$l]=new Ke,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[Rn].add([mt(()=>Gi(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),v(()=>this.screenLocation,(t,n)=>{w(t)&&w(n)&&this.emit("view-change")})])}destroy(){this.view=null,this[Rn]=ge(this[Rn])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:n}=this;return n&&w(e)&&w(t)&&t.ready?t.toScreen(e):null}};$l=Rn,a([l()],Kt.prototype,"location",void 0),a([l()],Kt.prototype,"screenLocation",null),a([l()],Kt.prototype,"screenLocationEnabled",void 0),a([l()],Kt.prototype,"view",void 0),Kt=a([M("esri.widgets.support.AnchorElementViewModel")],Kt);const Sl=Kt,Cp="esri.widgets.CompassViewModel";let Ln=class extends Sl{constructor(e){super(e),this.visible=!1}};a([l()],Ln.prototype,"visible",void 0),Ln=a([M(Cp)],Ln);const Rl=Ln,Ns={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let Yt=class extends re{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new Rl}initialize(){this.addHandles(v(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:n}=e;t&&(this.viewModel.location=t),this.visible=!0;const s=()=>this.hide();n&&n.catch(()=>{}).then(s)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,n=!!t,s=e&&n,o=!e&&n,r={[Ns.spinnerStart]:s,[Ns.spinnerFinish]:o},c=this._getPositionStyles();return m("div",{class:this.classes(Ns.base,r),styles:c})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=Po(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if($(t)||$(e))return{};const{padding:n}=t;return{left:e.x-n.left+"px",top:e.y-n.top+"px"}}};a([l()],Yt.prototype,"location",null),a([l()],Yt.prototype,"view",null),a([l({type:Rl})],Yt.prototype,"viewModel",void 0),a([l()],Yt.prototype,"visible",null),Yt=a([M("esri.widgets.Spinner")],Yt);const Tp=Yt,Ep="OBJECTID";var Zr;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(Zr||(Zr={}));const Kr=ve("android");ve("chrome")||Kr&&Kr>=4;Js();function Ll(i){return i&&"opacity"in i?i.opacity*Ll(i.parent):1}async function xp(i,e){if(!i)return;const t=i.sourceLayer,n=(w(e)&&e.useSourceLayer?t:i.layer)??t,s=Ll(n);if(w(i.symbol)&&(!w(e)||e.ignoreGraphicSymbol!==!0)){const T=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:w(e)?e.webStyleCache:null}):i.symbol.clone();return ws(T,null,s),T}const o=(w(e)?e.renderer:null)??(n&&"renderer"in n?n.renderer:null);let r=o&&"getSymbolAsync"in o?await o.getSymbolAsync(i,e):null;if(!r)return;if(r=r.type==="web-style"?await r.fetchSymbol({...e,cache:w(e)?e.webStyleCache:null}):r.clone(),!(o&&"visualVariables"in o&&o.visualVariables&&o.visualVariables.length))return ws(r,null,s),r;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&($(e)||$(e.arcade))){const T={...Te(e)};T.arcade=await Ka(),e=T}const c=await b(()=>import("./UniqueValueRenderer-08aa8b40.js").then(T=>T.v),["assets/UniqueValueRenderer-08aa8b40.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/enumeration-cda3949b.js","assets/jsonMap-c8081704.js","assets/Extent-54ef1174.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/Clonable-c315fc8d.js","assets/LegendOptions-998df0a8.js","assets/reactiveUtils-b911287d.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/PopupTemplate-2917795f.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/jsonUtils-196b5f3d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js"]),d=[],u=[],h=[],p=[];for(const T of o.visualVariables)switch(T.type){case"color":d.push(T);break;case"opacity":u.push(T);break;case"rotation":p.push(T);break;case"size":T.target||h.push(T)}const g=!!d.length&&d[d.length-1],f=g?c.getColor(g,i,e):null,_=!!u.length&&u[u.length-1];let C=_?c.getOpacity(_,i,e):null;if(s!=null&&(C=C!=null?C*s:s),ws(r,f,C),h.length){const T=c.getAllSizes(h,i,e);await _d(r,T)}for(const T of p)yd(r,c.getRotationAngle(T,i,e),T.axis);return r}let kp=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const n in e){const s=e[n],o=new Tc(s,void 0,void 0,2,2);this._properties[n]={pool:o,acquired:[]}}this._afterDispatchHandle=Ec(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const n of t.acquired)tr(n)||t.pool.release(n);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),n=this._properties[e];let s=n.pool.acquire();for(n.acquired.push(s);s===t;)n.acquired.push(s),s=n.pool.acquire();return s}_release(){for(const e in this._properties){const t=this._properties[e];let n=0;for(const s of t.acquired)tr(s)?t.acquired[n++]=s:t.pool.release(s);t.acquired.length=n}}};const Ap=ve("mac")?"Meta":"Ctrl",ms={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)ms[i]=String.fromCharCode(i);for(let i=1;i<25;i++)ms[111+i]=`F${i}`;for(let i=65;i<91;i++)ms[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function Pp(i){if(i.key!==void 0)return ii(i);const e=ms[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function $p(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let Sp=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const n of this.keyModifiers)if(!t.has(n))return!1;return!0}};const Yr=R.getLogger("esri.views.input.InputHandler");let te=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const n of t)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?Yr.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,n){let s;typeof t=="function"?(n=t,s=[]):s=t||[];const o=typeof e=="string"?new Sp(e,s):e,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},c=h=>{const p=this._incoming[h.match.eventType];if(p){const g=p.indexOf(h);p.splice(g,1),r(),this._manager&&this._manager.updateDependencies()}},d=new Rp(o,n,{onPause:c,onRemove:c,onResume:h=>{const p=this._incoming[h.match.eventType];p&&!p.includes(h)&&(p.push(h),r(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[o.eventType];return u||(u=[],this._incoming[o.eventType]=u),u.push(d),r(),this._manager&&this._manager.updateDependencies(),d}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new Lp(e,{onEmit:(n,s,o,r)=>{var c;(c=this._manager)==null||c.emit(n.eventType,s,o,r)},onRemove:n=>{var s;delete this._outgoing[n.eventType],(s=this._manager)==null||s.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Yr.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var n;const t=this._incoming[e.type];if(t){for(const s of t)if(s.match.matches(e)&&((n=s.callback)==null||n.call(s,e),e.shouldStopPropagation()))break}}},Rp=class{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Lp=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},Fp=class extends te{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:s}=e;t===this._value&&this._x===n&&this._y===s||(this._value=t,this._x=n,this._y=s,this._onChange(t,n,s))}},Op=class extends te{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new Sd(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},Ve=class extends L{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Ap,this._latestPointerType="mouse",this._propertiesPool=new kp({latestPointerLocation:Vp},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,n=Nt.INTERNAL){if(this._nameToGroup[e])return void R.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void R.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const s={name:e,handlers:t.map(o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let o=s.handlers.length-1;o>=0;o--){const r=s.handlers[o];this._handlers.push(r),r.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(c,d,u,h,p)=>{this._emitInputEvent(r.priorityIndex+1,c,d,u,p,h)},setPointerCapture:(c,d)=>{this._setPointerCapture(s,r,c,d)},setEventCallback:c=>{r.eventCallback=c},setUninstallCallback:c=>{r.uninstallCallback=c},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(n=>{var s;n.removed=!0,(s=n.uninstallCallback)==null||s.call(n)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):R.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const s=this._handlers[n];s.priorityIndex=n,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const s=this._handlersPriority[n];s.priorityIndex=n;let o=s.handler.hasSideEffects;if(!o){for(const r of s.handler.outgoingEventTypes)if(e.has(r)){o=!0;break}}if(o)for(const r of s.handler.incomingEventMatches){e.add(r.eventType);for(const c of r.keyModifiers)$p(c)||t.add(c)}s.active=o}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,n){this._latestPointerType=e;const s=this._get("latestPointerLocation");if($(s)||s.x!==t||s.y!==n){const o=this._propertiesPool.get("latestPointerLocation");o.x=t,o.y=n,this._set("latestPointerLocation",o)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const o=t;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,t);const n=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,s=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,n,s)}_updateKeyModifiers(e,t){if(!t)return;let n=!1;const s=()=>{if(!n){const c=new Set;this._activeKeyModifiers.forEach(d=>{c.add(d)}),this._activeKeyModifiers=c,n=!0}},o=(c,d)=>{d&&!this._activeKeyModifiers.has(c)?(s(),this._activeKeyModifiers.add(c)):!d&&this._activeKeyModifiers.has(c)&&(s(),this._activeKeyModifiers.delete(c))};if(e==="key-down"||e==="key-up"){const c=t.key;this._keyModifiers.has(c)&&o(c,e==="key-down")}const r=t.native;o("Alt",!(!r||!r.altKey)),o("Ctrl",!(!r||!r.ctrlKey)),o("Shift",!(!r||!r.shiftKey)),o("Meta",!(!r||!r.metaKey)),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Fp((e,t,n)=>this._setLatestPointer(e,t,n)),this._multiTouchHandler=new Op,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Nt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Nt.INTERNAL)}_setPointerCapture(e,t,n,s){const o=e.name+"-"+t.priorityIndex,r=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,r),s?(r.add(o),r.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):r.has(o)&&(r.delete(o),r.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,n,s){this._emitInputEvent(0,e,t,n,s)}_emitInputEvent(e,t,n,s,o,r){const c=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),d=o!==void 0&&o,u={event:new Dp(t,n,c,r||this._activeKeyModifiers,d),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new hr,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,n;const e=Lc(this._currentPropagation);for(;e.events.length>0;){const{event:s,priorityIndex:o}=e.events.pop(),r=s.data&&s.data.eventId;if(!(r!=null&&this._stoppedPropagationEventIds.has(r)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!s.shouldStopPropagation()&&((n=(t=e.currentHandler).eventCallback)==null||n.call(t,s)),s.shouldStopPropagation()){r!=null&&this._stoppedPropagationEventIds.add(r);break}if(s.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:s,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new hr;t.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)t.push(n.events.pop());n.events=t,n.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const s of t.handler.incomingEventMatches){if(n.eventType!==s.eventType)continue;const o=n.keyModifiers.filter(r=>s.keyModifiers.includes(r));if(o.length===n.keyModifiers.length!=(o.length===s.keyModifiers.length))return n.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const n of e){let s=0;for(;s<t.length&&this._compareHandlerPriority(n,t[s])>=0;)s++;t.splice(s,0,n)}return t}get debug(){const e=t=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=n};return{injectEvent:(t,n)=>{e(()=>{this._onEventReceived(t,n)})},disablePointerCapture:e}}};a([l({readOnly:!0})],Ve.prototype,"hasPendingInputs",null),a([l({constructOnly:!0})],Ve.prototype,"eventSource",void 0),a([l({constructOnly:!0})],Ve.prototype,"recognizers",void 0),a([l()],Ve.prototype,"_latestPointerType",void 0),a([l()],Ve.prototype,"latestPointerType",null),a([l()],Ve.prototype,"multiTouchActive",null),a([l({readOnly:!0})],Ve.prototype,"latestPointerLocation",void 0),Ve=a([M("esri.views.input.InputManager")],Ve);let Dp=class{constructor(e,t,n,s,o){this.type=e,this.data=t,this.timestamp=n,this.modifiers=s,this.cancelable=o,this._propagationState=Ot.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Ot.STOPPED}shouldStopPropagation(){return(this._propagationState&Ot.STOPPED)!=0}async(e){this._propagationState|=Ot.PAUSED;const t=(n,s)=>{this._propagationState&=~Ot.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),s)throw n;return n};return(typeof e=="function"?e():e).then(n=>t(n,!1),n=>t(n,!0))}shouldPausePropagation(e){return!!(this._propagationState&Ot.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Ot;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Ot||(Ot={}));const Nt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Vp=class{};function Qr(i){return i&&typeof i.highlight=="function"}const gs={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},ai=new hn({id:"zoom-to-feature",title:"{messages.zoom}",className:gs.iconZoom}),po=new hn({id:"remove-selected-feature",title:"{messages.remove}",className:gs.iconTrash}),xi=new hn({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:gs.iconZoom}),ki=new hn({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:gs.iconBrowseClusteredFeatures}),Np="esri.widgets.Popup.PopupViewModel",Xn=R.getLogger(Np),zp=i=>{const{event:e,view:t}=i,{action:n}=e,s=t&&t.popup;if(!n)return Promise.reject(new E("trigger-action:missing-arguments","Event has no action"));if(!s)return Promise.reject(new E("trigger-action:missing-arguments","view.popup is missing"));const{disabled:o,id:r}=n;if(!r)return Promise.reject(new E("trigger-action:invalid-action","action.id is missing"));if(o)return Promise.reject(new E("trigger-action:invalid-action","Action is disabled"));if(r===ai.id)return qp(s.viewModel).catch(Hc);if(r===xi.id)return Up(s.viewModel);if(r===ki.id)return s.featureMenuOpen=!s.featureMenuOpen,s.viewModel.browseClusterEnabled=!s.viewModel.browseClusterEnabled,Promise.resolve();if(s.viewModel.browseClusterEnabled=!1,r===po.id){s.close();const{selectedFeature:c}=s;if(!c)return Promise.reject(new E(`trigger-action:${po.id}`,"selectedFeature is required",{selectedFeature:c}));const{sourceLayer:d}=c;return d?d.remove(c):t.graphics.remove(c),Promise.resolve()}return Promise.resolve()};function Fl(i){const{selectedFeature:e,location:t,view:n}=i;return n?n.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function ni(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function Bp(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let n;try{n=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!n||!n.boundingBox||n.boundingBox[0]===n.boundingBox[3]&&n.boundingBox[1]===n.boundingBox[4]&&n.boundingBox[2]===n.boundingBox[5]}return!0}async function qp(i){const{location:e,selectedFeature:t,view:n,zoomFactor:s}=i,o=Fl(i);if(!o){const u=new E("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:o,view:n});throw Xn.error(u),u}const r=n.scale/s,c=i.get("selectedFeature.geometry")||e,d=c&&c.type==="point"&&await Bp(t,n);ai.active=!0,ai.disabled=!0;try{await i.zoomTo({target:{target:o,scale:d?r:void 0}})}catch{const h=new E("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});Xn.error(h)}finally{ai.active=!1,ai.disabled=!1,i.zoomToLocation=null,d&&(i.location=c)}}async function Up(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const c=new E("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw Xn.error(c),c}if(!ni(e)){const c=new E("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw Xn.error(c),c}const n=e.sourceLayer,s=await t.whenLayerView(n),o=s.createQuery();o.aggregateIds=[e.getObjectId()],xi.active=!0,xi.disabled=!0;const{extent:r}=await s.queryExtent(o);await i.zoomTo({target:r}),xi.active=!1,xi.disabled=!1}async function Hp(i){const{selectedFeature:e,view:t}=i,n=e.sourceLayer,s=await t.whenLayerView(n),o=s.createQuery();o.aggregateIds=[e.getObjectId()];const{extent:r}=await s.queryExtent(o);i.selectedClusterBoundaryFeature.geometry=r,t.graphics.add(i.selectedClusterBoundaryFeature)}async function jp(i){const{selectedFeature:e,view:t}=i,n=e.sourceLayer,s=await t.whenLayerView(n),o=s.createQuery();o.aggregateIds=[e.getObjectId()],ki.active=!0,ki.disabled=!0;const{features:r}=await s.queryFeatures(o);ki.active=!1,ki.disabled=!1,t.popup.open({features:[e].concat(r),featureMenuOpen:!0})}function Gp(i){const e=i.features.filter(t=>ni(t));e.length&&(i.features=e)}const Go=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:n}=this;return this.goToOverride?this.goToOverride(n,t):n.goTo(t.target,t.options)}};return a([l()],e.prototype,"goToOverride",void 0),a([l()],e.prototype,"view",void 0),e=a([M("esri.widgets.support.GoTo")],e),e},sn=G.ofType({key:"type",defaultKeyValue:"button",base:md,typeMap:{button:hn,toggle:gd}}),Wp=()=>[ai.clone()],Zp=()=>[xi.clone(),ki.clone()];let S=class extends Go(Sl){constructor(e){super(e),this._handles=new Ke,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new sn,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new Ye({symbol:new Qa({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([v(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),v(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),v(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),v(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),v(()=>this.location,e=>this._locationChange(e)),v(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),v(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),v(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),v(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>zp({event:e,view:this.view})),mt(()=>!this.waitingForResult,()=>this._waitingForResultChange(),rn),v(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),v(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),mt(()=>!this.visible,()=>this.browseClusterEnabled=!1),v(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new sn;e.removeAll();const{actions:t,defaultActions:n,defaultPopupTemplateEnabled:s,includeDefaultActions:o,selectedFeature:r}=this,c=o?n.concat(t):t,d=r&&(typeof r.getEffectivePopupTemplate=="function"&&r.getEffectivePopupTemplate(s)||r.popupTemplate),u=d&&d.actions,h=d&&d.overwriteActions?u:u?u.concat(c):c;return h&&h.filter(Boolean).forEach(p=>e.add(p)),e}get defaultActions(){const e=this._get("defaultActions")||new sn;return e.removeAll(),e.addMany(ni(this.selectedFeature)?Zp():Wp()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:n,promiseCount:s,selectedFeatureIndex:o}=this,r=s&&t.length;r&&n&&o===-1?this.selectedFeatureIndex=0:r&&o!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=ko(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const n=o=>{this._pendingPromises.has(t)&&this._updateFeatures(o),this._updatePendingPromises(t)},s=()=>this._updatePendingPromises(t);t.then(n,s)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=Fl(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new E("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:n}=this;if(!n||!e)throw new E("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:n});return n.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:n}=t;delete t.fetchFeatures,n&&this._setFetchFeaturesPromises(t.location);const s=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const o of s)delete t[o];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){Gp(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?ni(t)?(await Hp(this),await jp(this)):R.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):R.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(ai.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(ni(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:n}=this;n&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:n,featuresPerPage:s,featureViewModels:o}=this;if(n===null)return;const r=((n-1)*s+t)%t,c=r+s;o.slice(r,c).forEach((d,u)=>{d&&!d.graphic&&(d.graphic=e[r+u])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:n,view:s}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(s.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),ni(e)?void 0:(e.symbol=await xp(e),this._selectedClusterFeature=e,void s.graphics.add(this._selectedClusterFeature));!n&&t||!e.geometry?n&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=s.center.clone()}):this.location=Te(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:n,promisesPerLayerView:s}=t,o=Promise.resolve(n),r=s.map(c=>c.promise);this.promises=[o,...r]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:n}=this;if(ni(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const s=n.slice(0),o=[];t.forEach((r,c)=>{var u,h;if(!r)return;let d=null;if(s.some((p,g)=>(p&&p.graphic===r&&(d=p,s.splice(g,1)),!!d)),d)o[c]=d;else{const p=new jo({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(u=this.view)==null?void 0:u.spatialReference,graphic:r===e?r:null,map:(h=this.view)==null?void 0:h.map,view:this.view});o[c]=p}}),s.forEach(r=>r&&!r.destroyed&&r.destroy()),this._set("featureViewModels",o)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:n}=this;if(t.remove(e),n&&this.view){const s=this.view.on("click",o=>{o.pointerType==="mouse"&&o.button!==0||this._fetchFeaturesAndOpen(o)},Nt.WIDGET);t.add(s,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const n=new AbortController,{signal:s}=n;this._fetchFeaturesController=n,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:s,event:t});return o.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:n}=e,{view:s}=this;this._fetchFeaturesWithController(t,e).then(o=>{const{clientOnlyGraphics:r,promisesPerLayerView:c,location:d}=o,u=[Promise.resolve(r),...c.map(h=>h.promise)];return s.popup.open({location:d||n,promises:u}),o})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return $(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:n}=e;return n&&"layer"in n&&n.layer?n.layer:(n==null?void 0:n.type)==="map-notes"||(n==null?void 0:n.type)==="subtype-group"?n:t}_getHighlightTarget(e,t){const n=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||Ep:null,s=e.attributes;return s&&n&&s[n]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:n,activeFeature:s,visible:o}=this;if(!(s&&n&&t&&o))return;const r=this._getHighlightLayer(s);if(!(r&&r instanceof ur))return;const c=this._getLayerView(n,r);this._highlightActiveFeaturePromise=c;const d=await c;if(!(d&&Qr(d)&&this._highlightActiveFeaturePromise===c&&this.activeFeature&&this.highlightEnabled))return;const u=d.highlight(this._getHighlightTarget(s,r));this._handles.add(u,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:n,view:s,visible:o}=this;if(!(t&&s&&n&&o))return;const r=this._getHighlightLayer(t);if(!(r&&r instanceof ur))return;const c=this._getLayerView(s,r);this._highlightSelectedFeaturePromise=c;const d=await c;if(!(d&&Qr(d)&&this._highlightSelectedFeaturePromise===c&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u=d.highlight(this._getHighlightTarget(t,r));this._handles.add(u,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const n=e.filter(s=>!t.includes(s));this.features=t.concat(n)}};a([l()],S.prototype,"featurePage",void 0),a([l()],S.prototype,"isLoadingFeature",null),a([l({type:sn})],S.prototype,"actions",void 0),a([l({readOnly:!0})],S.prototype,"active",null),a([l()],S.prototype,"activeFeature",void 0),a([l({readOnly:!0})],S.prototype,"allActions",null),a([l({type:Boolean})],S.prototype,"defaultPopupTemplateEnabled",void 0),a([l()],S.prototype,"autoCloseEnabled",void 0),a([l()],S.prototype,"autoOpenEnabled",void 0),a([l()],S.prototype,"browseClusterEnabled",void 0),a([l()],S.prototype,"content",void 0),a([l({type:sn,readOnly:!0})],S.prototype,"defaultActions",null),a([l({readOnly:!0})],S.prototype,"featureCount",null),a([l()],S.prototype,"features",null),a([l()],S.prototype,"featuresPerPage",void 0),a([l()],S.prototype,"featureViewModelAbilities",void 0),a([l({readOnly:!0})],S.prototype,"featureViewModels",void 0),a([l()],S.prototype,"highlightEnabled",void 0),a([l()],S.prototype,"includeDefaultActions",void 0),a([l({type:Y})],S.prototype,"location",null),a([l({readOnly:!0})],S.prototype,"pendingPromisesCount",null),a([l({readOnly:!0})],S.prototype,"selectedClusterBoundaryFeature",void 0),a([l({readOnly:!0})],S.prototype,"waitingForResult",null),a([l({readOnly:!0})],S.prototype,"promiseCount",null),a([l()],S.prototype,"promises",null),a([l({value:null,readOnly:!0})],S.prototype,"selectedFeature",null),a([l({value:-1})],S.prototype,"selectedFeatureIndex",null),a([l({readOnly:!0})],S.prototype,"selectedFeatureViewModel",null),a([l({readOnly:!0})],S.prototype,"state",null),a([l()],S.prototype,"title",void 0),a([l()],S.prototype,"updateLocationEnabled",void 0),a([l()],S.prototype,"view",void 0),a([l()],S.prototype,"visible",void 0),a([l()],S.prototype,"zoomFactor",void 0),a([l()],S.prototype,"zoomToLocation",void 0),a([l()],S.prototype,"centerAtLocation",null),S=a([M("esri.widgets.Popup.PopupViewModel")],S);const Ol=S,Jr="selected-index",Kp=0,Xr="popup-spinner",y={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},ea={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},ta="esri-popup";function et(i,e){return e===void 0?`${ta}__${i}`:`${ta}__${i}-${e}`}const ia={closeButton:!0,featureNavigation:!0};let x=class extends Pl(re){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Ke,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([n])=>{n!=null&&n.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=Pi(()=>this._displaySpinner(),Kp),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new G,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new Ol,this.visibleElements={...ia},this._addSelectedFeatureIndexHandle(),this.addHandles([v(()=>{var n;return(n=this.viewModel)==null?void 0:n.screenLocation},()=>this._positionContainer()),v(()=>{var n;return[(n=this.viewModel)==null?void 0:n.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),v(()=>{var n;return(n=this.viewModel)==null?void 0:n.screenLocation},(n,s)=>{!!n!=!!s&&this.reposition()}),v(()=>{var n,s,o,r,c,d;return[(s=(n=this.viewModel)==null?void 0:n.view)==null?void 0:s.padding,(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.size,(c=this.viewModel)==null?void 0:c.active,(d=this.viewModel)==null?void 0:d.location,this.alignment]},()=>this.reposition()),v(()=>this.spinnerEnabled,n=>this._spinnerEnabledChange(n)),v(()=>{var n,s;return(s=(n=this.viewModel)==null?void 0:n.view)==null?void 0:s.size},(n,s)=>this._updateDockEnabledForViewSize(n,s)),v(()=>{var n;return(n=this.viewModel)==null?void 0:n.view},(n,s)=>this._viewChange(n,s)),v(()=>{var n,s;return(s=(n=this.viewModel)==null?void 0:n.view)==null?void 0:s.ready},(n,s)=>this._viewReadyChange(n,s)),v(()=>{var n,s;return[(n=this.viewModel)==null?void 0:n.waitingForResult,(s=this.viewModel)==null?void 0:s.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),v(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),v(()=>{var n,s,o,r;return[(s=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:s.title,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setTitleFromFeatureWidget()),v(()=>{var n,s,o,r;return[(s=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:s.content,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setContentFromFeatureWidget()),mt(()=>!this.collapsed,()=>{var n,s;((s=(n=this.viewModel)==null?void 0:n.view)==null?void 0:s.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),Se(()=>{var n;return(n=this.viewModel)==null?void 0:n.allActions},"change",()=>this._watchActions()),v(()=>{var n;return(n=this.viewModel)==null?void 0:n.allActions},()=>this._watchActions(),V),v(()=>{var n;return(n=this.viewModel)==null?void 0:n.featureViewModels},()=>this._featureMenuViewportScrollTop()),Se(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),v(()=>{var n,s,o,r;return[(s=(n=this._activeFlowItemWidget)==null?void 0:n.viewModel)==null?void 0:s.state,(r=(o=this._activeFlowItemWidget)==null?void 0:o.viewModel)==null?void 0:r.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([b(()=>import("./calcite-flow-c9a0d1af.js"),["assets/calcite-flow-c9a0d1af.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/observers-cf6d0d57.js"]),b(()=>import("./calcite-flow-item-207bf571.js"),["assets/calcite-flow-item-207bf571.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js","assets/action-8e2ac47b.js","assets/observers-cf6d0d57.js","assets/interactive-52dcf836.js","assets/icon-39f1fc65.js","assets/tooltip-4230b4f6.js"]),b(()=>import("./calcite-action-125ea472.js"),["assets/calcite-action-125ea472.js","assets/action-8e2ac47b.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/observers-cf6d0d57.js","assets/interactive-52dcf836.js","assets/icon-39f1fc65.js","assets/guid-e49c4e43.js"]),b(()=>import("./calcite-tooltip-cfcd26c3.js"),["assets/calcite-tooltip-cfcd26c3.js","assets/tooltip-4230b4f6.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js"]),b(()=>import("./calcite-icon-331afcfb.js"),["assets/calcite-icon-331afcfb.js","assets/icon-39f1fc65.js","assets/widget-99edfa96.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/intl-c3eb9a7a.js","assets/number-1bdcdfd9.js","assets/jsonMap-c8081704.js","assets/locale-30120714.js","assets/messages-c2cf09a4.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/assets-04f03891.js","assets/Evented-7dfb249a.js","assets/Promise-e08b9d4d.js","assets/reactiveUtils-b911287d.js","assets/uuid-73213768.js","assets/observers-cf6d0d57.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const n=e.viewModel;if(n!=null&&n.waitingForContent||(n==null?void 0:n.state)==="error")return!0;const s=n==null?void 0:n.content;return Array.isArray(s)?!!s.length:!!s}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||ea}set dockOptions(e){const t={...ea},n=this.get("viewModel.view.breakpoints"),s={};n&&(s.width=n.xsmall,s.height=n.xsmall);const o={...t,...e},r={...t.breakpoint,...s},{breakpoint:c}=o;c===!0?o.breakpoint=r:typeof c=="object"&&(o.breakpoint={...r,...c}),this._set("dockOptions",o),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:n,_flowItems:s}=this,{selectedFeatureViewModel:o}=this.viewModel,r={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=r):this._feature=new Ip({flowItems:s,headingLevel:n+1,viewModel:o,visibleElements:r}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...ia,...e}}blur(){const{active:e}=this.viewModel;e||R.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||R.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var o,r;this._handles.remove(Jr);const t=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:t};((r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint)==="xsmall"&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var C,T,A,F;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:n,dividedActions:s,currentAlignment:o,currentDockPosition:r}=this,{active:c}=this.viewModel,{menuActions:d}=s,u=c&&d.length>1&&e,h=c&&t,p=c&&!t,g=(T=(C=this.selectedFeature)==null?void 0:C.layer)==null?void 0:T.title,f=(F=(A=this.selectedFeature)==null?void 0:A.layer)==null?void 0:F.id,_={[y.alignTopCenter]:o==="top-center",[y.alignBottomCenter]:o==="bottom-center",[y.alignTopLeft]:o==="top-left",[y.alignBottomLeft]:o==="bottom-left",[y.alignTopRight]:o==="top-right",[y.alignBottomRight]:o==="bottom-right",[y.isDocked]:h,[y.shadow]:p,[y.isDockedTopLeft]:r==="top-left",[y.isDockedTopCenter]:r==="top-center",[y.isDockedTopRight]:r==="top-right",[y.isDockedBottomLeft]:r==="bottom-left",[y.isDockedBottomCenter]:r==="bottom-center",[y.isDockedBottomRight]:r==="bottom-right",[y.isFeatureMenuOpen]:n,[y.isActionsMenuOpen]:u};return m("div",{class:this.classes(y.base,_),role:"presentation","data-layer-title":g,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return m("span",{"aria-hidden":"true",class:this.classes(y.icon,y.iconLoading,y.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?m("div",{key:et("loading-container"),role:"presentation",class:y.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=Ge(this.container),t={[y.iconRightTriangleArrow]:e,[y.paginationPreviousIconRTL]:e,[y.iconLeftTriangleArrow]:!e,[y.paginationPreviousIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(y.icon,t)})}renderPreviousButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(y.button,y.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=Ge(this.container),t={[y.iconLeftTriangleArrow]:e,[y.paginationNextIconRTL]:e,[y.iconRightTriangleArrow]:!e,[y.paginationNextIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(y.icon,t)})}renderNextButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(y.button,y.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:n}=this,{featureCount:s,selectedFeatureIndex:o}=this.viewModel;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(y.button,y.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":n.menu,title:n.menu},this._getPageText(s,o))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),n={[y.iconUndock]:e,[y.iconDock]:!e,[y.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[y.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[y.iconDockToTop]:!e&&t==="top-center",[y.iconDockToBottom]:!e&&t==="bottom-center"};return m("span",{"aria-hidden":"true",class:this.classes(n,y.icon)})}renderDockButton(){var o,r,c;const{dockEnabled:e,messages:t}=this,n=(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint,s=e?t.undock:t.dock;return n!=="xsmall"&&((c=this.dockOptions)!=null&&c.buttonEnabled)?m("div",{role:"button","aria-label":s,title:s,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(y.button,y.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:n,contentCollapsed:s,messagesCommon:o}=this,r={[y.headerContainerButton]:n},c=m(Bo,{level:this.headingLevel,class:y.headerTitle,innerHTML:e}),d=n?m("button",{key:`${e}--collapsible`,id:t,title:s?o.expand:o.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(y.headerContainer,r),"aria-expanded":s?"false":"true",onclick:this._toggleCollapsed,type:"button"},c,m("calcite-icon",{class:y.collapseIcon,key:"collapse-icon",icon:s?"chevron-down":"chevron-up",scale:"m"})):m("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(y.headerContainer,r)},c);return e?d:null}renderCloseIcon(){return m("span",{"aria-hidden":"true",class:this.classes(y.icon,y.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?m("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:y.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return m("header",{class:y.header},this.renderTitle(),m("div",{class:y.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:n,_flowItems:s,messagesCommon:o}=this,{content:r}=this.viewModel,c=s.toArray(),d={[y.contentHasFlows]:!!c.length};return t&&!n?m("div",{key:r,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(y.content,d)},m("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},m("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":o.back,afterCreate:jn,key:"root-flow-item"},this.renderContent()),c.map(u=>this.renderFlowItem(u))),c.map(u=>this.renderFlowItemTooltip(u))):null}renderFlowItem(e){const{messages:t,messagesCommon:n}=this,s=Jn();return m("calcite-flow-item",{class:this.classes({[y.calciteThemeDark]:!s,[y.calciteThemeLight]:s}),heading:e.title,"intl-back":n.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},m("calcite-action",{class:y.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:o=>this._storeExitRelatedRecordsAction(e,o),onclick:this._destroyFlowItemWidgets}),m("div",{class:this.classes(y.contentFlowItem,{[y.calciteThemeDark]:s,[y.calciteThemeLight]:!s})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:n}=this,s=Jn();return m("calcite-tooltip",{class:this.classes({[y.calciteThemeDark]:!s,[y.calciteThemeLight]:s}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:n.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:n,dividedActions:s,messagesCommon:o}=this,r=n?o.close:o.open,{menuActions:c}=s;return c.length?m("div",{key:et("actions-menu-button"),class:this.classes(y.button,y.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":n?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},m("span",{"aria-hidden":"true",class:y.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:n,dividedActions:s}=this,{menuActions:o}=s;return o.length&&n?m("ul",{id:e,role:"menu","aria-labelledby":t,key:et("actions"),class:y.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},o.toArray().map(r=>this.renderAction({action:r,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,n=!!e.length,s=!!t.length;return n||s?m("div",{key:"inline-actions-container","data-inline-actions":n.toString(),"data-menu-actions":s.toString(),class:y.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?m("section",{key:et("navigation"),class:this.classes(y.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:n,menuActions:s}=t,o=!!n.length,r=!!s.length,c={[y.footerHasPagination]:e,[y.footerHasActions]:o,[y.footerHasActionsMenu]:r};return e||o?m("div",{key:et("feature-buttons"),class:this.classes(y.footer,c)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:n}=this.viewModel,s=je(e.selectedFeatures,{total:t.length});return m("section",{key:et("menu"),class:y.featureMenu},m("strong",{class:y.featureMenuHeader},s),m("nav",{bind:this,class:y.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:jn},this.renderFeatureMenu(),m("div",{class:y.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),n?m("div",{class:y.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:m("div",{key:et("pointer"),class:y.pointer,role:"presentation"},m("div",{class:this.classes(y.pointerDirection,y.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:n,titleId:s,contentId:o,collapsible:r,hasContent:c,contentCollapsed:d,visibleElements:u}=this,{title:h}=this.viewModel,p=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||n==="top-left"||n==="top-center"||n==="top-right",g=t==="top-left"||t==="top-center"||t==="top-right"||n==="bottom-left"||n==="bottom-center"||n==="bottom-right",f={[y.shadow]:e,[y.isCollapsible]:r,[y.isCollapsed]:d};return m("div",{class:this.classes(y.main,y.widget,f),tabIndex:u.closeButton?null:-1,role:"dialog","aria-labelledby":h?s:"","aria-describedby":c&&!d?o:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},p?this.renderFooter():null,p?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),g?this.renderFooter():null,g?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?m("div",{class:j.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return m("span",{key:"text",class:y.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),n=this._getActionImage(e),s={[y.iconLoading]:e.active,[y.rotating]:e.active,[y.icon]:!!t,[y.actionImage]:!e.active&&!!n};return t&&(s[t]=!e.active),m("span",{key:"icon","aria-hidden":"true",class:this.classes(y.icon,s),styles:this._getIconStyles(n)})}renderAction(e){const{action:t,type:n}=e,s=this._getActionTitle(t),o={[y.action]:t.type!=="toggle",[y.actionToggle]:t.type==="toggle",[y.actionToggleOn]:t.type==="toggle"&&t.value,[y.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(s)],c=n==="menu-item"?m("li",{key:t.uid,role:"menuitem",tabIndex:0,title:s,"aria-label":s,class:this.classes(y.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r):m("div",{key:t.uid,role:"button",tabIndex:0,title:s,"aria-label":s,class:this.classes(y.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?c:null}renderFeatureMenuItem(e,t){const{messages:n,messagesCommon:s}=this,{selectedFeatureIndex:o,selectedFeatureViewModel:r}=this.viewModel,c=e===r,d={[y.featureMenuSelected]:c},u=c?m("span",{key:et(`feature-menu-selected-feature-${o}`),title:n.selectedFeature,"aria-label":n.selectedFeature,class:y.iconCheckMark}):null,h=m("span",{innerHTML:e.title||s.untitled});return m("li",{role:"menuitem",tabIndex:-1,key:et(`feature-menu-feature-${o}`),class:this.classes(d,y.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},m("span",{class:y.featureMenuTitle},h,u))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?m("ol",{class:y.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(n=>!!n.graphic).map((n,s)=>this.renderFeatureMenuItem(n,s))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:n,messagesCommon:s}=this,{id:o}=e,r=n==null?void 0:n.attributes,c=o==="zoom-to-feature"?je(e.title,{messages:t}):o==="remove-selected-feature"?je(e.title,{messages:s}):o==="zoom-to-clustered-features"||o==="browse-clustered-features"?je(e.title,{messages:t}):e.title;return c&&r?je(c,r):c}_getActionClass(e){const{selectedFeature:t}=this,n=t==null?void 0:t.attributes,{className:s,image:o}=e,r=o||s?s:y.iconDefaultAction;return r&&n?je(r,n):r}_getActionImage(e){const{selectedFeature:t}=this,n=t==null?void 0:t.attributes,{image:s}=e;return s&&n?je(s,n):s}_createFeatureUpdatedAnimation(){return td("enter",y.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const n=Math.round(e);return Math.max(t?n-1:n,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(n=>{this._handles.add(v(()=>[n.uid,n.active,n.className,n.disabled,n.id,n.title,n.image,n.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(r=>r.visible),n=this._getInlineActionCount(),s=n===null,o=n===0;return{inlineActions:s?t.slice(0):o?new G:t.slice(0,n),menuActions:s?new G:o?t.slice(0):t.slice(n)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var n,s;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((n=e.viewModel)==null?void 0:n.state)==="error"?t.errorMessage:((s=e.viewModel)==null?void 0:s.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){ii(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){ii(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,n=e.currentTarget["data-feature-index"];t.activeFeature=t.features[n]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=ii(e),{_featureMenuNode:n}=this,s=e.currentTarget["data-feature-index"];if(!n)return;const o=n.querySelectorAll("li"),r=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(s+1+r)%r].focus()):(e.stopPropagation(),o[(s-1+r)%r].focus())}_handleActionMenuItemKeyup(e){const t=ii(e),{_actionsMenuNode:n}=this,s=e.currentTarget.dataset.actionUid,{menuActions:o}=this.dividedActions,r=o.findIndex(u=>u.uid===s);if(!n)return;const c=n.querySelectorAll("li"),d=c.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),c[c.length-1].focus()):(e.stopPropagation(),c[0].focus()):(e.stopPropagation(),c[(r+1+d)%d].focus()):(e.stopPropagation(),c[(r-1+d)%d].focus())}_handleMainKeyup(e){const t=ii(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:n}=this.viewModel;n?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await $o(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=v(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,n)=>this._selectedFeatureIndexUpdated(t,n));this._handles.add(e,Jr)}_selectedFeatureIndexUpdated(e,t){const{featureCount:n}=this;n&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:n,screenLocation:s,side:o,view:r}=e;if(isNaN(n)||isNaN(t)||!r||!s)return!1;const c=r.padding;return o==="right"&&s.x+n/2>r.width-c.right||o==="left"&&s.x-n/2<c.left||o==="top"&&s.y-t<c.top||o==="bottom"&&s.y+t>r.height-c.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:n,_mainContainerNode:s,viewModel:o}=this,{screenLocation:r,view:c}=o;if($(r)||!c||!n)return"top-center";if(!this._isScreenLocationWithinView(r,c))return this._get("currentAlignment")||"top-center";function d(z){return parseInt(z.replace(/[^-\d\.]/g,""),10)}const u=s?window.getComputedStyle(s,null):null,h=u?d(u.getPropertyValue("max-height")):0,p=u?d(u.getPropertyValue("height")):0,{height:g,width:f}=n.getBoundingClientRect(),_=f+t,C=Math.max(g,h,p)+t,T=this._isOutsideView({popupHeight:C,popupWidth:_,screenLocation:r,side:"right",view:c}),A=this._isOutsideView({popupHeight:C,popupWidth:_,screenLocation:r,side:"left",view:c}),F=this._isOutsideView({popupHeight:C,popupWidth:_,screenLocation:r,side:"top",view:c}),O=this._isOutsideView({popupHeight:C,popupWidth:_,screenLocation:r,side:"bottom",view:c});return A?F?"bottom-right":"top-right":T?F?"bottom-left":"top-left":F?O?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return Ge(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var c;if(e!=="auto")return e;const t=(c=this.viewModel)==null?void 0:c.view,n=Ge(this.container)?"top-left":"top-right";if(!t)return n;const s=t.padding||{left:0,right:0,top:0,bottom:0},o=t.width-s.left-s.right,{breakpoints:r}=t;return r&&o<=r.xsmall?"bottom-center":n}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:n}=e.getBoundingClientRect(),s=this._calculatePositionStyle(t,n);s&&(e.style.top=s.top,e.style.left=s.left,e.style.bottom=s.bottom,e.style.right=s.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:n}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+n:e}_calculateAlignmentPosition(e,t,n,s){const{currentAlignment:o,_pointerOffsetInPx:r}=this,c=s/2,d=n.height-t,u=n.width-e,{padding:h}=this.view;return o==="bottom-center"?{top:t+r-h.top,left:e-c-h.left}:o==="top-left"?{bottom:d+r-h.bottom,right:u+r-h.right}:o==="bottom-left"?{top:t+r-h.top,right:u+r-h.right}:o==="top-right"?{bottom:d+r-h.bottom,left:e+r-h.left}:o==="bottom-right"?{top:t+r-h.top,left:e+r-h.left}:o==="top-center"?{bottom:d+r-h.bottom,left:e-c-h.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:n,view:s}=this;if(!s)return;if(n)return{left:"",top:"",right:"",bottom:""};if($(e)||!t)return;const o=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,s,o);return r?{top:r.top!==void 0?`${r.top}px`:"auto",left:r.left!==void 0?`${r.left}px`:"auto",bottom:r.bottom!==void 0?`${r.bottom}px`:"auto",right:r.right!==void 0?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const n=this.get("viewModel.view");this._wireUpView(n)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,n){const[s,o]=e,[r,c]=t,{width:d,height:u}=n;return s<=d&&r>d||s>d&&r<=d||o<=u&&c>u||o>u&&c<=u}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const n=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},s=n.left+n.right,o=n.top+n.bottom,r=[],c=[];r[0]=e[0]-s,r[1]=e[1]-o,c[0]=t[0]-s,c[1]=t[1]-o;const{dockOptions:d}=this,u=d.breakpoint;this._dockingThresholdCrossed(r,c,u)&&this._setDockEnabledForViewSize(d),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const n=t.active&&!e;t.screenLocationEnabled=n}_shouldDockAtCurrentViewSize(e){var d,u;const t=e.breakpoint,n=(u=(d=this.viewModel)==null?void 0:d.view)==null?void 0:u.ui;if(!n)return!1;const{width:s,height:o}=n;if(isNaN(s)||isNaN(o))return!1;const r=t.hasOwnProperty("width")&&s<=t.width,c=t.hasOwnProperty("height")&&o<=t.height;return r||c}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?je(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,Xr),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new Tp({view:e}),e.ui.add(this._spinner,{key:Xr,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:n}=this.viewModel,s=n.findIndex(r=>r.uid===t),o=n.getItemAt(s);o&&o.type==="toggle"&&(o.value=!o.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(s)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};a([l({readOnly:!0})],x.prototype,"actionsMenuId",null),a([l({readOnly:!0})],x.prototype,"actionsMenuButtonId",null),a([l({readOnly:!0})],x.prototype,"featureMenuId",null),a([l({readOnly:!0})],x.prototype,"titleId",null),a([l({readOnly:!0})],x.prototype,"contentId",null),a([l({readOnly:!0})],x.prototype,"hasContent",null),a([l({readOnly:!0})],x.prototype,"featureNavigationVisible",null),a([l({readOnly:!0})],x.prototype,"collapsible",null),a([l({readOnly:!0})],x.prototype,"featureMenuVisible",null),a([l({readOnly:!0})],x.prototype,"contentCollapsed",null),a([l({readOnly:!0})],x.prototype,"dividedActions",null),a([l({readOnly:!0,dependsOn:["_flowItems.length"]})],x.prototype,"_activeFlowItemWidget",null),a([l()],x.prototype,"actions",null),a([l()],x.prototype,"actionsMenuOpen",null),a([l()],x.prototype,"alignment",void 0),a([l()],x.prototype,"autoCloseEnabled",null),a([l()],x.prototype,"autoOpenEnabled",null),a([l()],x.prototype,"defaultPopupTemplateEnabled",null),a([l()],x.prototype,"content",null),a([l()],x.prototype,"collapsed",void 0),a([l()],x.prototype,"collapseEnabled",void 0),a([l({readOnly:!0})],x.prototype,"currentAlignment",null),a([l({readOnly:!0})],x.prototype,"currentDockPosition",null),a([l()],x.prototype,"dockOptions",null),a([l()],x.prototype,"dockEnabled",void 0),a([l({readOnly:!0})],x.prototype,"featureCount",null),a([l()],x.prototype,"featureMenuOpen",void 0),a([l()],x.prototype,"features",null),a([l()],x.prototype,"goToOverride",null),a([l()],x.prototype,"headingLevel",void 0),a([l()],x.prototype,"highlightEnabled",null),a([l()],x.prototype,"location",null),a([l()],x.prototype,"label",null),a([l()],x.prototype,"maxInlineActions",void 0),a([l(),ne("esri/widgets/Popup/t9n/Popup")],x.prototype,"messages",void 0),a([l(),ne("esri/t9n/common")],x.prototype,"messagesCommon",void 0),a([l()],x.prototype,"promises",null),a([l({readOnly:!0})],x.prototype,"selectedFeature",null),a([l()],x.prototype,"selectedFeatureIndex",null),a([l({readOnly:!0})],x.prototype,"selectedFeatureWidget",null),a([l()],x.prototype,"spinnerEnabled",void 0),a([l()],x.prototype,"title",null),a([l()],x.prototype,"updateLocationEnabled",null),a([l()],x.prototype,"view",null),a([l({type:Ol}),Cl(["triggerAction","trigger-action"])],x.prototype,"viewModel",void 0),a([l()],x.prototype,"visible",null),a([l()],x.prototype,"visibleElements",void 0),a([be("visibleElements")],x.prototype,"castVisibleElements",null),a([Ee()],x.prototype,"_close",null),a([Ee()],x.prototype,"_toggleDockEnabled",null),a([Ee()],x.prototype,"_toggleFeatureMenu",null),a([Ee()],x.prototype,"_toggleActionsMenu",null),a([Ee()],x.prototype,"_triggerAction",null),a([Ee()],x.prototype,"_selectFeature",null),a([Ee()],x.prototype,"_next",null),a([Ee()],x.prototype,"_previous",null),x=a([M("esri.widgets.Popup")],x);const na=x,zs=[0,0];function Yp(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return zs[0]=t.left+((e==null?void 0:e.pageXOffset)??0),zs[1]=t.top+((e==null?void 0:e.pageYOffset)??0),zs}function sa(i){i&&(Ua(i),i.parentNode&&i.parentNode.removeChild(i))}function Qp(i){const e=document.createElement("div");return i.appendChild(e),e}const zi=16,bn=750,Jp=512,Xp=2,em=i=>{let e=class extends i{constructor(...t){var n;super(...t),this._freqInfo={freq:zi,time:bn},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((n=t[0])==null?void 0:n.popup)!==void 0||(this.popup=new na({view:this})),this.handles.add([v(()=>this.cursor,s=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",s)}),v(()=>this.interacting,s=>{const{surface:o}=this;o&&o.setAttribute("data-interacting",s.toString())})])}initialize(){this.handles.add(v(()=>this.ui,(t,n)=>this._handleUIChange(t,n))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=ge(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const n=this._get("container"),s=qa(t),o=s instanceof HTMLDivElement?s:null;if(o||typeof t!="string"||R.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),n===o)return;const r="dom-size";if(this.handles.remove(r),this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(sa(this.root),this._set("root",null)),this.userContent&&(ar(this.userContent,n),sa(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");const c=document.createElement("div");c.className="esri-view-user-storage",ar(o,c),o.appendChild(c),this._set("userContent",c);const d=document.createElement("div");d.className="esri-view-root",o.insertBefore(d,o.firstChild),this._set("root",d);const u=document.createElement("div");u.className="esri-view-surface",u.setAttribute("role","application"),u.tabIndex=0,d.appendChild(u),this._set("surface",u);const h=new Cr;d.appendChild(h.surface),this._set("overlay",h),v(()=>h.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=$i({render:()=>{var g;return(g=this.overlay)==null?void 0:g.render()}}):this._overlayRenderTaskHandle=Bt(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(v(()=>this.size,p=>{const[g,f]=p,_="esri-view-surface--inset-outline";g>=document.body.clientWidth||f>=document.body.clientHeight?u.classList.add(_):u.classList.remove(_)},V),r),this._set("container",o),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const n=this._get("popup");n&&n!==t&&n.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,n,s){const o=this.position;return t-=o?o[0]:0,n-=o?o[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}containerToPage(t,n,s){const o=this.position;return t+=o?o[0]:0,n+=o?o[1]:0,s?(s[0]=t,s[1]=n):s=[t,n],s}_handleUIChange(t,n){n&&(this.handles.remove("ui"),n.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([v(()=>this.root,n=>{t.container=n?Qp(n):null},V),v(()=>this.popup,(n,s)=>{const o="popup",r="manual";s&&t.remove(s,o),n&&(n.view=t.view,t.add(n,{key:o,position:r}))},V)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=zi,t.time=bn,this.handles.add([(()=>{const n=()=>{t.freq=zi,t.time=bn};return window.addEventListener("resize",n),{remove(){window.removeEventListener("resize",n)}}})(),$i({prepare:n=>{const s=this._measure(),o=this._freqInfo;if(o.time+=n.deltaTime,s&&(o.freq=zi,this._get("resizing")||this._set("resizing",!0)),o.time<o.freq)return;o.time=0;const r=this._position();o.freq=r||s?zi:Math.min(bn,o.freq*Xp),!s&&o.freq>=Jp&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,n=t?t.clientWidth:0,s=t?t.clientHeight:0;if(n===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,r=this.height;return n===o&&s===r?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:r,width:n,height:s}),!0)}_position(){const t=this.container,n=this.position,s=t&&Yp(t);return!!s&&(!n||s[0]!==n[0]||s[1]!==n[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return a([l()],e.prototype,"container",null),a([l({readOnly:!0})],e.prototype,"focused",null),a([l({readOnly:!0})],e.prototype,"height",void 0),a([l({type:na})],e.prototype,"popup",null),a([l({type:Cr})],e.prototype,"overlay",void 0),a([l({readOnly:!0})],e.prototype,"position",void 0),a([l({readOnly:!0})],e.prototype,"resizing",void 0),a([l({readOnly:!0})],e.prototype,"root",void 0),a([l({value:null,readOnly:!0})],e.prototype,"size",null),a([l({readOnly:!0})],e.prototype,"surface",void 0),a([l({readOnly:!0})],e.prototype,"suspended",void 0),a([l()],e.prototype,"ui",void 0),a([l({readOnly:!0})],e.prototype,"userContent",void 0),a([l({readOnly:!0})],e.prototype,"width",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),e=a([M("esri.views.DOMContainer")],e),e},tm=i=>{let e=class extends i{async fetchPopupFeatures(t,n){await this.when();const{location:s,queryArea:o,layerViewsAndGraphics:r,clientOnlyGraphics:c}=await this._prepareFetchPopupFeatures(t,n),d=Promise.resolve(c),u=this._queryLayerPopupFeatures(o,r,n),h=u.map(p=>p.promise);return{location:s,clientOnlyGraphics:c,allGraphicsPromise:jc([d,...h]).then(p=>Array.from(new Set(p.flat()))),promisesPerLayerView:u}}_queryLayerPopupFeatures(t,n,s){return n.map(({layerView:o,graphics:r})=>{const c={clientGraphics:r,event:w(s)?s.event:null,signal:w(s)?s.signal:null,defaultPopupTemplateEnabled:!!w(s)&&!!s.defaultPopupTemplateEnabled},d=o.fetchPopupFeatures(t,c);return{layerView:o,promise:d}})}_isValidPopupGraphic(t,n){return t&&!!t.getEffectivePopupTemplate(w(n)&&n.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,n){const{clientGraphics:s,queryArea:o,location:r}=await this._popupHitTestGraphics(t,n),c=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:d,clientOnlyGraphics:u}=this._graphicsPerFetchPopupLayerView(s,c);return{clientOnlyGraphics:u,layerViewsAndGraphics:d,queryArea:o,location:r}}async _popupHitTestGraphics(t,n){const{results:s,mapPoint:o}=await this.popupHitTest(t),r=s.filter(d=>d.type==="graphic"&&this._isValidPopupGraphic(d.graphic,n)),c=r.length?r[0].mapPoint:null;return{clientGraphics:r.map(d=>d.graphic),queryArea:o,location:o||c}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(n=>{this._isValidPopupLayerView(n)&&t.push(n)}),w(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return w(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,n){const s=[],o=new Map,r=n.map(c=>{const d=[];return"layer"in c?o.set(c.layer,d):o.set(c.graphics,d),{layerView:c,graphics:d}});for(const c of t){const d=o.get(c.layer)||o.get(c.sourceLayer)||null;d?d.push(c):s.push(c)}return{layerViewsAndGraphics:r,clientOnlyGraphics:s}}};return e=a([M("esri.views.PopupView")],e),e};var mo;let Fn=mo=class extends Re{constructor(i){super(i),this.type="none"}clone(){return new mo({type:this.type})}};a([Vd({none:"none",stayAbove:"stay-above"})],Fn.prototype,"type",void 0),Fn=mo=a([M("esri.ground.NavigationConstraint")],Fn);let U=class extends L{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};a([l()],U.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),a([l()],U.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),a([l()],U.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),a([l()],U.prototype,"DECONFLICTOR_SHOW_GRID",void 0),a([l()],U.prototype,"LABELS_SHOW_BORDER",void 0),a([l()],U.prototype,"TEXT_SHOW_BASELINE",void 0),a([l()],U.prototype,"TEXT_SHOW_BORDER",void 0),a([l()],U.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),a([l()],U.prototype,"OVERLAY_SHOW_CENTER",void 0),a([l()],U.prototype,"SHOW_POI",void 0),a([l()],U.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),a([l()],U.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),a([l()],U.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),a([l()],U.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),a([l()],U.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),a([l()],U.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),a([l()],U.prototype,"I3S_TREE_SHOW_TILES",void 0),a([l()],U.prototype,"I3S_SHOW_MODIFICATIONS",void 0),a([l()],U.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),a([l()],U.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),a([l()],U.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),a([l()],U.prototype,"LINE_WIREFRAMES",void 0),a([l()],U.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),U=a([M("esri.views.3d.support.DebugFlags")],U);const im=new U;var go;let Ne=go=class extends xc(to){constructor(i){super(i),this.opacity=1,this.shading=!im.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new G;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type!=="elevation"&&n.type!=="base-elevation"&&R.getLogger(this.declaredClass).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=n=>{n.parent=null};this.layers.on("after-add",n=>e(n.item)),this.layers.on("after-remove",n=>t(n.item))}initialize(){this.when().catch(i=>{R.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",Fd(i,this._get("layers")))}writeLayers(i,e,t,n){const s=[];i&&(n={...n,layerContainerType:"ground"},i.forEach(o=>{if("write"in o){const r={};Od(o)().write(r,n)&&s.push(r)}else n&&n.messages&&n.messages.push(new E("layer:unsupported",`Layers (${o.title}, ${o.id}) of type '${o.declaredClass}' cannot be persisted in the ground`,{layer:o}))})),e.layers=s}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return Dd(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await b(()=>import("./ElevationQuery-8ca0a535.js"),["assets/ElevationQuery-8ca0a535.js","assets/asyncUtils-bd6eb812.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/unitUtils-58dc72ed.js","assets/jsonMap-c8081704.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/projection-6d5d9468.js","assets/preload-helper-596b5639.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-ddf0ceba.js","assets/mat4-62d5e6a4.js","assets/assets-04f03891.js","assets/request-3bbdab19.js","assets/zscale-65468675.js","assets/aaBoundingRect-e7f76732.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/TileInfo-9954a0c0.js"]);Vt(e);const n=new t,s=this.layers.filter(oa).toArray();return n.queryAll(s,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await b(()=>import("./ElevationQuery-8ca0a535.js"),["assets/ElevationQuery-8ca0a535.js","assets/asyncUtils-bd6eb812.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/unitUtils-58dc72ed.js","assets/jsonMap-c8081704.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/projection-6d5d9468.js","assets/preload-helper-596b5639.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-ddf0ceba.js","assets/mat4-62d5e6a4.js","assets/assets-04f03891.js","assets/request-3bbdab19.js","assets/zscale-65468675.js","assets/aaBoundingRect-e7f76732.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/TileInfo-9954a0c0.js"]);Vt(e);const n=new t,s=this.layers.filter(oa).toArray();return n.createSamplerAll(s,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:Qs(this.surfaceColor),navigationConstraint:Qs(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new go({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const n=e&&e.origin||"web-scene",s=e&&e.portal||null,o=e&&e.url||null;return b(()=>import("./layersCreator-8a9393ec.js"),["assets/layersCreator-8a9393ec.js","assets/Collection-8f94e599.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/lazyLayerLoader-c3069eea.js","assets/preload-helper-596b5639.js","assets/PortalItem-49bcac17.js","assets/assets-04f03891.js","assets/request-3bbdab19.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/Extent-54ef1174.js","assets/Portal-af5b2c18.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/jsonMap-c8081704.js","assets/PortalUser-0170111d.js","assets/portalLayers-03c7c834.js","assets/layersLoader-cefb6b83.js","assets/Layer-d4420615.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/Identifiable-d701141a.js","assets/arcgisLayerUrl-af21cccf.js","assets/persistableUrlUtils-2c2cd088.js","assets/jsonContext-96bc6b0c.js","assets/portalItemUtils-187d4bc6.js","assets/projection-6d5d9468.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-58dc72ed.js","assets/mat4-62d5e6a4.js","assets/zscale-65468675.js","assets/styleUtils-d1f4a996.js","assets/asyncUtils-bd6eb812.js"]).then(({populateOperationalLayers:r})=>{Vt(t);const c=[];if(i.layers&&Array.isArray(i.layers)){const d={context:{origin:n,url:o,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};c.push(r(this.layers,i.layers,d))}return qt(c)}).then(()=>{})}};function nm(i){return i&&"createElevationSampler"in i}function oa(i){return i.type==="elevation"||nm(i)}a([l({json:{read:!1}})],Ne.prototype,"layers",null),a([Fa("layers")],Ne.prototype,"writeLayers",null),a([l({readOnly:!0})],Ne.prototype,"resourceInfo",void 0),a([l({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:sr,read:{reader:Nd,source:"transparency"},write:{writer:(i,e)=>{e.transparency=zd(i)},target:"transparency"}}})],Ne.prototype,"opacity",void 0),a([l({type:Boolean,nonNullable:!0,json:{read:!1}})],Ne.prototype,"shading",void 0),a([l({type:Ut,json:{type:[sr],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],Ne.prototype,"surfaceColor",void 0),a([l({type:Fn,json:{write:!0}})],Ne.prototype,"navigationConstraint",void 0),Ne=go=a([M("esri.Ground")],Ne);const es=Ne;function sm(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const ra=R.getLogger("esri.support.basemapUtils");function om(){return{}}function rm(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function am(i,e){let t;if(typeof i=="string"){if(!(i in pr)){const n=Object.entries(pr).filter(([s,o])=>Hn.apiKey&&!o.classic||!Hn.apiKey&&o.classic&&!o.deprecated).map(([s])=>`"${s}"`).join(", ");return ra.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${n}`),null}e&&(t=e[i]),t||(t=eo.fromId(i),e&&(e[i]=t))}else t=Ht(eo,i);return t!=null&&t.destroyed&&(ra.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}const aa={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function lm(i){let e=null;if(typeof i=="string")if(i in aa){const t=aa[i];e=new es({resourceInfo:{data:{layers:[t]}}})}else R.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=Ht(es,i);return e}let ze=class extends Bd(qd(pn.EventedMixin(L))){constructor(e){super(e),this.allLayers=new Un({getCollections:()=>{var t,n,s;return[(t=this.basemap)==null?void 0:t.baseLayers,(n=this.ground)==null?void 0:n.layers,this.layers,(s=this.basemap)==null?void 0:s.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=Ud(this),this.basemap=null,this.editableLayers=new Un({getCollections:()=>[this.allLayers],itemFilterFunction:sm}),this.ground=new es,this._basemapCache=om()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),rm(this._basemapCache),this._basemapCache=null}castBasemap(e){return am(e,this._basemapCache)}castGround(e){const t=lm(e);return $(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};a([l({readOnly:!0,dependsOn:[]})],ze.prototype,"allLayers",void 0),a([l({readOnly:!0})],ze.prototype,"allTables",void 0),a([l({type:eo})],ze.prototype,"basemap",void 0),a([be("basemap")],ze.prototype,"castBasemap",null),a([l({readOnly:!0})],ze.prototype,"editableLayers",void 0),a([l({type:es,nonNullable:!0})],ze.prototype,"ground",void 0),a([be("ground")],ze.prototype,"castGround",null),ze=a([M("esri.Map")],ze);const cm=ze;let ts=class extends Zd{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{$(t.item)||t.item.parent===this.owner&&(R.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};ts=a([M("esri.support.AnalysesCollection")],ts);let Et=class extends L{constructor(e){super(e),this.view=null,this.baseLayerViews=new G,this.referenceLayerViews=new G,this._loadingHandle=v(()=>{var t,n;return(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap},t=>{t&&t.load().catch(()=>{})},V)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,n;if(this.view&&this.view.suspended)return!1;const e=(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};a([l({constructOnly:!0})],Et.prototype,"view",void 0),a([l({readOnly:!0})],Et.prototype,"baseLayerViews",void 0),a([l({readOnly:!0})],Et.prototype,"referenceLayerViews",void 0),a([l({readOnly:!0})],Et.prototype,"suspended",null),a([l({type:Boolean,readOnly:!0})],Et.prototype,"updating",null),Et=a([M("esri.views.BasemapView")],Et);let dm=class{constructor(e,t,n){this.layer=e,this.view=t,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=za(),this._started=!1,this.done=!1,or(this._controller.signal,()=>{const s=new E("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:n}=this;t.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var s,o;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:n}=this;this._map=n.map;try{let r,c;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)r=await t.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new E("layer:view-not-supported","No layerview implementation was found");const h=await this.layerViewImporter.importLayerView(t);Vt(e),r="default"in h?new h.default({layer:t,view:n}):new h({layer:t,view:n})}const d=()=>{c=Bt(c),r.destroyed||r.destroy(),r.layer=null,r.parent=null,r.view=null,this.done=!0};c=or(e,d),Vt(e);try{await r.when()}catch(h){throw d(),h}if(!((o=(s=this._map)==null?void 0:s.allLayers)==null?void 0:o.includes(t)))return d(),void this._deferred.reject(new E("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=r,t.emit("layerview-create",{view:n,layerView:r}),n.emit("layerview-create",{layer:t,layerView:r}),this.done=!0,this._deferred.resolve(r)}catch(r){t.emit("layerview-create-error",{view:n,error:r}),n.emit("layerview-create-error",{layer:t,error:r}),this.done=!0,this._deferred.reject(new E("layerview:create-error","layerview creation failed",{layer:t,error:r}))}}},ke=class extends L{constructor(i){super(i),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new Ha,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var t;const e=(t=this.view.map)==null?void 0:t.allLayers;if(e)for(const n of e)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>($(this._workPromise)&&(this._workPromise=za(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(kc(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var r,c,d;const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),$(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const t=[],n=u=>{if(!$(u))for(const h of u)h&&(t.push(h),this._createLayerView(h),"layers"in h&&h.layers&&n(h.layers))};for(const u of this._rootCollectionNames)n(this.get(u));this._refreshCollections();for(const[u,h]of this._layerLayerViewInfoMap)t.includes(u)||(this._layerLayerViewInfoMap.delete(h.layer),h.destroy());const s=t.filter(u=>u.type==="group").map(u=>u.layers),o=[(r=e==null?void 0:e.ground)==null?void 0:r.layers,(c=e==null?void 0:e.basemap)==null?void 0:c.baseLayers,(d=e==null?void 0:e.basemap)==null?void 0:d.referenceLayers,e==null?void 0:e.layers,...s].filter(u=>!!u);this.addHandles(o.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([Se(()=>{var i,e;return(e=(i=this.view)==null?void 0:i.map)==null?void 0:e.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),v(()=>{const i=this.view,e=i==null?void 0:i.map;return[e==null?void 0:e.basemap,e==null?void 0:e.ground,e==null?void 0:e.layers,i==null?void 0:i.ready]},()=>this._reschedule(),Zt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,w(this._workPromise)&&(this._workPromise.reject(Gc()),this._workPromise=null)}get _layersToLayerViews(){const i=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&i.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(i)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return w(this._workPromise)||this._watchUpdatingTracking.updating||ns(this._layerLayerViewInfoMap,i=>!i.done)}get updatingRemaining(){let i=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++i;return i}clear(){if(!this.destroyed){for(const i of this._layerLayerViewInfoMap.values())i.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(i){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(i))throw new E("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:i});return this._layerLayerViewInfoMap.get(i).promise}_refreshCollections(){for(const[i,e]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(i),this.get(e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(i,e,t){if(!i||!e)return void(e&&e.removeAll());let n=0;for(const s of i){const o=this._layerLayerViewInfoMap.get(s);if(!o||!o.layerView)continue;const r=o.layerView;r.layer=s,r.parent=t,e.getItemAt(n)!==r&&e.splice(n,0,r),s.layers&&this._populateLayerViewsOwners(s.layers,r.layerViews,r),n+=1}n<e.length&&e.splice(n,e.length)}_createLayerView(i){if(this._layerLayerViewInfoMap.has(i))return this.view.ready&&this._layerLayerViewInfoMap.get(i).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");i.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);const e=new dm(i,this.view,this.layerViewImporter);e.promise.then(()=>this._refreshCollections(),t=>{t&&(Na(t)||t.name==="cancelled:layerview-create")||R.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${i.title??"no title"}', id:'${i.id??"no id"}' of type '${i.type}'.`,{layer:i,error:t}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(i,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([l()],ke.prototype,"_workPromise",void 0),a([l({readOnly:!0})],ke.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],ke.prototype,"_layersToLayerViews",null),a([l({readOnly:!0})],ke.prototype,"_rootCollectionNames",null),a([l()],ke.prototype,"layerViewImporter",void 0),a([l()],ke.prototype,"supportsGround",void 0),a([l({readOnly:!0})],ke.prototype,"updating",null),a([l({readOnly:!0})],ke.prototype,"updatingRemaining",null),a([l({constructOnly:!0})],ke.prototype,"view",void 0),ke=a([M("esri.views.LayerViewManager")],ke);const um=ke;let Ce=class extends L{constructor(e){super(e),this.factor=1.5,this.offset=we(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([l({type:Number})],Ce.prototype,"factor",void 0),a([l({nonNullable:!0})],Ce.prototype,"offset",void 0),a([l()],Ce.prototype,"position",void 0),a([l({type:Number,range:{min:0}})],Ce.prototype,"size",void 0),a([l()],Ce.prototype,"maskUrl",void 0),a([l()],Ce.prototype,"maskEnabled",void 0),a([l()],Ce.prototype,"overlayUrl",void 0),a([l()],Ce.prototype,"overlayEnabled",void 0),a([l({readOnly:!0})],Ce.prototype,"version",null),a([l({type:Boolean})],Ce.prototype,"visible",void 0),Ce=a([M("esri.views.Magnifier")],Ce);const Dl=Ce;let Qi=class extends L{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(Rd.TEXTURE_UNLOAD))??Ld}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,n){const s=this.makeUid(e);let o=this._textureRequests.get(s);return o||(o={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:n},this._stage&&(this._stage.add(o.texture),this._stage.loadImmediate(o.texture)),this._textureRequests.set(s,o)),o.referenceCount++,{uid:s,texture:o.texture,release:()=>this._release(s)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return w(t)?`${e}.${t}px`:e}};a([l()],Qi.prototype,"_frameTask",void 0),a([l()],Qi.prototype,"updating",null),Qi=a([M("esri.views.3d.support.TextureCollection")],Qi);var la;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(la||(la={}));const Vl=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],Nl={};function zl(i){return!!Nl[i]}function hm(i){for(const e of i)if(!zl(e))return!1;return!0}Vl.forEach(i=>{Nl[i]=!0});let pm=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:n},s)=>this.inputManager.installHandlers(s,[t],n))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,n,s){const o=Array.isArray(e)?e:e.split(",");if(!hm(o))return o.some(zl)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,c;Array.isArray(t)?c=t:(r=t,c=[]),typeof n=="function"?r=n:s=n,s=s??Nt.DEFAULT;const d=this._createUniqueGroupName(),u=new mm(this.view,o,c,r);this._handlers.set(d,{handler:u,priority:s});for(const h of o){const p=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,p+1)}return this.inputManager&&this.inputManager.installHandlers(d,[u],s),{remove:()=>this._removeHandler(d,o)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of t){const s=this._handlerCounts.get(n);s===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",n):s===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,s-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},mm=class extends te{constructor(e,t,n,s){super(!0),this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",n,r=>s(this._wrapClick(r)));break;case"double-click":this.registerIncoming("double-click",n,r=>s(this._wrapDoubleClick(r)));break;case"immediate-click":this.registerIncoming("immediate-click",n,r=>s(this._wrapImmediateClick(r)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,r=>s(this._wrapImmediateDoubleClick(r)));break;case"hold":this.registerIncoming("hold",n,r=>s(this._wrapHold(r)));break;case"drag":this.registerIncoming("drag",n,r=>{const c=this._wrapDrag(r);c&&s(c)});break;case"key-down":this.registerIncoming("key-down",n,r=>s(this._wrapKeyDown(r)));break;case"key-up":this.registerIncoming("key-up",n,r=>s(this._wrapKeyUp(r)));break;case"pointer-down":this.registerIncoming("pointer-down",n,r=>s(this._wrapPointer(r,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,r=>s(this._wrapPointer(r,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,r=>s(this._wrapPointer(r,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,r=>s(this._wrapPointerDrag(r)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,r=>s(this._wrapMouseWheel(r)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,r=>s(this._wrapPointer(r,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,r=>s(this._wrapPointer(r,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,r=>{s(this._wrapGamepad(r))});break;case"focus":this.registerIncoming("focus",n,r=>{s(this._wrapFocus(r))});break;case"blur":this.registerIncoming("blur",n,r=>{s(this._wrapBlur(r))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:n,buttons:s,x:o,y:r,native:c,eventId:d}=e.data,{cancelable:u,timestamp:h}=e;return{type:"click",pointerType:t,button:n,buttons:s,x:o,y:r,native:c,timestamp:h,screenPoint:we(o,r),mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:n,buttons:s,x:o,y:r,native:c,eventId:d}=e.data,{cancelable:u,timestamp:h}=e;return{type:"double-click",pointerType:t,button:n,buttons:s,x:o,y:r,native:c,timestamp:h,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:n,buttons:s,x:o,y:r,native:c,eventId:d}=e.data,u=c.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-click",pointerId:u,pointerType:t,button:n,buttons:s,x:o,y:r,native:c,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:n,buttons:s,x:o,y:r,native:c,eventId:d}=e.data,u=c.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-double-click",pointerId:u,pointerType:t,button:n,buttons:s,x:o,y:r,native:c,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:n,buttons:s,x:o,y:r,native:c}=e.data,{cancelable:d,timestamp:u}=e;return{type:"hold",pointerType:t,button:n,buttons:s,x:o,y:r,native:c,timestamp:u,mapPoint:this._getMapPoint(o,r),cancelable:d,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(we(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:n,y:s}=t.center,{action:o,pointerType:r,button:c}=t;if(o==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const d=t.pointer.native,u=t.buttons,{cancelable:h,timestamp:p}=e,g={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:n,y:s,origin:g,pointerType:r,button:c,buttons:u,radius:t.radius,angle:$c(t.angle),native:d,timestamp:p,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:n,native:s}=e.data,{cancelable:o,timestamp:r}=e;return{type:"key-down",key:t,repeat:n,native:s,timestamp:r,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:n}=e.data,{cancelable:s,timestamp:o}=e;return{type:"key-up",key:t,native:n,timestamp:o,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:r=>e.async(r),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:n,y:s,button:o,buttons:r,native:c,eventId:d}=e.data,u=c.pointerId,h=c.pointerType,{cancelable:p,timestamp:g}=e;return{type:t,x:n,y:s,pointerId:u,pointerType:h,button:o,buttons:r,native:c,timestamp:g,eventId:d,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:n,buttons:s,native:o,eventId:r}=e.data.currentEvent,{button:c}=e.data.startEvent,d=e.data.startEvent.native.pointerId,u=e.data.startEvent.native.pointerType,h=e.data.action,p={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:g,timestamp:f}=e;return{type:"pointer-drag",x:t,y:n,pointerId:d,pointerType:u,button:c,buttons:s,action:h,origin:p,native:o,timestamp:f,eventId:r,cancelable:g,stopPropagation:()=>e.stopPropagation(),async:_=>e.async(_),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:n,timestamp:s}=e,{x:o,y:r,deltaY:c,native:d}=n;return{type:"mouse-wheel",x:o,y:r,deltaY:c,native:d,timestamp:s,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:n,device:s}=e.data,{cancelable:o,timestamp:r}=e,{buttons:c,axes:d}=n;return{type:"gamepad",device:s,timestamp:r,action:t,buttons:c,axes:d,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}};var dn,ca,da;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(dn||(dn={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(ca||(ca={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(da||(da={}));function gm(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return R.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function fo(i){return i.visible&&i.getEditableFlag(dn.USER)&&i.getEditableFlag(dn.MANAGER)}function Be(i){return we(i.x,i.y)}function Bl(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return we(e.clientX-t.left,e.clientY-t.top)}function ua(i,e){return e instanceof Event?Bl(i,e):Be(e)}function ha(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let fm=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":pa(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!ma(e))break;const s=Be(e),o=this._intersect(s,e.pointerType,t.forEachTool);if($(o))break;const r=o.manipulator,c=o.tool;!(w(r)&&w(c)&&r.interactive)||r.grabbable&&r.grabbableForEvent(e)||!r.grabbing||r.dragging||this._ungrabManipulatorBeforeDragging(r,e,t),w(r)&&w(c)&&r.interactive&&r.grabbable&&r.grabbableForEvent(e)&&!r.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:r,tool:c,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&$(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),r.grabbing=!0,r.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!ma(e))break;const s=this._grabbedManipulators.get(e.pointerId),o=Gi(s,({manipulator:h})=>h),r=Gi(s,({tool:h})=>h);if($(o)||$(r))break;const c=Be(e);c.x=Si(c.x,0,t.view.width),c.y=Si(c.y,0,t.view.height);const d=Te(s).start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,u?o.events.emit("drag",{action:"update",start:d,screenPoint:c}):o.events.emit("drag",{action:"start",start:d,screenPoint:c,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:r,manipulator:o,start:d}));break;case"end":o.dragging=!1,u&&o.events.emit("drag",{action:"end",start:d,screenPoint:c}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}n();break}case"immediate-click":{const s=Be(e),o=this._intersect(s,e.pointerType,t.forEachTool);if(_m(e)||t.forEachTool(u=>{if((!w(o)||o.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let h=!1;u.manipulators.forEach(({manipulator:p})=>{p.selected&&(p.selected=!1,h=!0)}),h&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),$(o))break;const{manipulator:r,tool:c}=o;if(!r.interactive)break;r.selectable&&c.automaticManipulatorSelection&&(r.selected=!r.selected,c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged());const d=e.native.shiftKey;r.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:d,stopPropagation:n});break}case"click":{const s=Be(e),o=this._intersect(s,e.pointerType,t.forEachTool),r=w(o)?o.manipulator:null;if($(r)||!r.interactive)break;const c=e.native.shiftKey;r.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c}),n();break}case"double-click":{const s=Be(e),o=this._intersect(s,e.pointerType,t.forEachTool),r=w(o)?o.manipulator:null;if($(r)||!r.interactive)break;const c=e.native.shiftKey;r.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n});break}case"immediate-double-click":{const s=Be(e),o=this._intersect(s,e.pointerType,t.forEachTool),r=w(o)?o.manipulator:null;if($(r)||!r.interactive)break;const c=e.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Be(t)}),this._grabbedManipulators.forEach(({manipulator:s},o)=>{s===e&&this._grabbedManipulators.delete(o)}),this._afterManipulatorUngrab(n.setActiveTool)}_handlePointerEnd(e,t){const n=Gi(this._grabbedManipulators.get(e.pointerId),({manipulator:s})=>s);$(n)||n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Be(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return ns(e,({manipulator:n})=>!($(n)||!n.interactive)&&(n.grabbing&&n.grabCursor?(t=n.grabCursor,!0):!!n.cursor&&(t=n.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:s})=>{t.add(s)}),this._hoveredManipulators.forEach(({tool:s})=>{n.add(s)}),e(s=>{s.hasGrabbedManipulators=t.has(s),s.hasHoveredManipulators=n.has(s);const o=this._grabbedManipulators.values(),r=Ac(o,({tool:c})=>c===s);s.firstGrabbedManipulator=w(r)?r.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:n},s=!0,o){const r=(c,d)=>c===e&&($(o)||o===d);this._grabbedManipulators.forEach(({tool:c,manipulator:d,pointerType:u},h)=>{r(c,d)&&(this._grabbedManipulators.delete(h),d.grabbing=!1,d.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:c,manipulator:d},u)=>{r(c,d)&&(this._draggedManipulators.delete(u),d.dragging=!1,d.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:c,manipulator:d},u)=>{r(c,d)&&(this._hoveredManipulators.delete(u),d.hovering=!1)}),this._afterManipulatorUngrab(n),this._onFocusChange(t)}_intersect(e,t,n){let s=null;return n(o=>{if(o.manipulators==null||!fo(o))return!1;const r=o.manipulators.intersect(e,t);return!$(r)&&(s={tool:o,manipulator:r},!0)}),s}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,n)=>{this._updateHoveredStateForPointerAtScreenPosition(we(t.x,t.y),n,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!pa(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Be(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,n,s){let o=this._intersect(e,n,s);const r=Gi(this._hoveredManipulators.get(t),({manipulator:c})=>c);w(o)&&!o.manipulator.interactive&&(o=null),w(o)&&r===o.manipulator||(w(r)&&(r.hovering=!1),w(o)?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(s))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function pa(i){return i==="mouse"}function ma(i){return i.pointerType!=="mouse"||i.button===0}function _m(i){return!!i.native.shiftKey}const ga="attached",Bs="tools";let rt=class extends ja{constructor(e){super(e),this._manipulatorState=new fm,this.tools=new G,this.cursor=null,this._forEachTool=t=>{for(const n of this.tools.items)if(t(n))return}}initialize(){this.handles.add([this.view.on(Vl,e=>{this._handleInputEvent(e)},Nt.TOOL),...gm(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(w(e)&&!this.view.ready)return void R.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),w(t)&&t.deactivate(),w(e)&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const s=fo(n);!$(this.activeTool)&&s||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new Qi(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([v(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),Ra(()=>this._set("textures",ge(this.textures)))],ga)):this.handles.add(v(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){w(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(ga)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:n})=>e(n,t))})}_handleInputEvent(e){let t=!1;const n={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};w(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(s=>{!t&&s.visible&&s.handleInputEvent(n)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),!t&&w(this.activeTool)&&this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(Bs),this._forEachTool(e=>{if(e instanceof L){const t=v(()=>[e.cursor,e.visible,e.editable],()=>{fo(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,Bs)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Bs)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(dn.MANAGER,$(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;$(e)&&this._forEachTool(t=>!(!w(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>($(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};a([l({constructOnly:!0,nonNullable:!0})],rt.prototype,"view",void 0),a([l({readOnly:!0,nonNullable:!0})],rt.prototype,"textures",void 0),a([l({value:null})],rt.prototype,"activeTool",null),a([l({readOnly:!0,type:G})],rt.prototype,"tools",void 0),a([l({readOnly:!0})],rt.prototype,"cursor",void 0),a([l({readOnly:!0})],rt.prototype,"updating",null),rt=a([M("esri.views.ToolViewManager")],rt);const ym=rt;let bi=class extends L{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":vm.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return wm[this.deviceType]}};a([l({nonNullable:!0,readOnly:!0})],bi.prototype,"nativeIndex",void 0),a([l({type:String,readOnly:!0})],bi.prototype,"deviceType",null),a([l({type:Number,readOnly:!0})],bi.prototype,"axisThreshold",null),bi=a([M("esri.views.input.gamepad.GamepadInputDevice")],bi);const vm=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),wm={standard:.15,spacemouse:.025,unknown:0},Wo=bi;let Ji=class extends L{constructor(...e){super(...e),this.devices=new G,this.enabledFocusMode="document"}};a([l({type:G.ofType(Wo),readOnly:!0})],Ji.prototype,"devices",void 0),a([l({type:["document","view","none"]})],Ji.prototype,"enabledFocusMode",void 0),Ji=a([M("esri.views.input.gamepad.GamepadSettings")],Ji);const bm=Ji;let On=class extends L{constructor(){super(...arguments),this.gamepad=new bm}};a([l({readOnly:!0})],On.prototype,"gamepad",void 0),On=a([M("esri.views.input.Input")],On);const Mm=On;let xt=class extends L{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([l({type:Boolean,nonNullable:!0})],xt.prototype,"enabled",void 0),a([l({type:Wo})],xt.prototype,"device",void 0),a([l({type:["pan","zoom"],nonNullable:!0})],xt.prototype,"mode",void 0),a([l({type:["forward-down","forward-up"],nonNullable:!0})],xt.prototype,"tiltDirection",void 0),a([l({type:Number,nonNullable:!0})],xt.prototype,"velocityFactor",void 0),xt=a([M("esri.views.navigation.gamepad.GamepadSettings")],xt);const ql=xt;let Qt=class extends L{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new ql,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};a([l({type:Boolean})],Qt.prototype,"browserTouchPanEnabled",void 0),a([l({type:ql,nonNullable:!0})],Qt.prototype,"gamepad",void 0),a([l({type:Boolean})],Qt.prototype,"momentumEnabled",void 0),a([l({type:Boolean})],Qt.prototype,"mouseWheelZoomEnabled",void 0),Qt=a([M("esri.views.navigation.Navigation")],Qt);const Ul=Qt;var fa;function Im(i){var n;const e=i.url?Yd(i.url):void 0;return!(((n=i.spatialReference)==null?void 0:n.vcsWkid)==null&&w(e)&&e.serverType==="ImageServer")&&Hl(i)&&i.heightModelInfo?i.heightModelInfo:Cm(i)?Fo.deriveUnitFromSR(Em,i.spatialReference):null}function Hl(i){return"heightModelInfo"in i}function jl(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function Cm(i){return jl(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):Gl(i)}function Tm(i){return i.layers!=null||Gl(i)||jl(i)||Hl(i)}function Gl(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(fa||(fa={}));const Em=new Fo({heightModel:"gravity-related-height"});let _o,qs=null;async function xm(i){qs||(qs=b(()=>import("./geometryServiceUtils-4e2b6988.js"),["assets/geometryServiceUtils-4e2b6988.js","assets/Error-1dfe2922.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/Portal-af5b2c18.js","assets/preload-helper-596b5639.js","assets/cast-7ef3a066.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/request-3bbdab19.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/Extent-54ef1174.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/jsonMap-c8081704.js","assets/PortalUser-0170111d.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/jsonUtils-196b5f3d.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/reactiveUtils-b911287d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/Queue-26a7c9c9.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/projection-6d5d9468.js","assets/unitUtils-58dc72ed.js","assets/mat4-62d5e6a4.js","assets/zscale-65468675.js","assets/TileInfo-9954a0c0.js","assets/aaBoundingRect-e7f76732.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/HandleOwner-2d282b7c.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/normalizeUtils-5312bea5.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/pbf-99764d75.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/RelationshipQuery-2b83908f.js","assets/LegendOptions-998df0a8.js","assets/utils-4b8ae1e2.js","assets/asyncUtils-bd6eb812.js","assets/parser-60fed632.js","assets/ItemCache-eb0f81ed.js","assets/MemCache-15515535.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/deprecate-9e0289e6.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/featureConversionUtils-99b22ab9.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/BlendLayer-00b35d0f.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/FeatureReductionLayer-df295e9a.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/FieldsIndex-b44c88ca.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/mat2d-80bd93af.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/vec2-f978aef8.js","assets/vec2f64-e0301652.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-dddb0ea5.js","assets/context-util-87dfae31.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"]).then(e=>_o=e)),await qs,Vt(i)}async function Wl(i,e,t,n){if(!i)return null;const s=i.spatialReference;return an()||os(s,e)?un(i,e):_o?_o.projectGeometry(i,e,t,n):(await Promise.race([xm(n),rs(n)]),Wl(i,e,t,n))}let N=class extends L{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Ys(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return w(this.userSpatialReference)?this.userSpatialReference:Te(this._spatialReferenceTask.spatialReference)}get extent(){return Te(this._extentTask.extent)}get heightModelInfo(){return Te(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return Te(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return Te(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return $(this.userSpatialReference)||this.userSpatialReference.equals(Te(this._spatialReferenceTask.spatialReference))?Te(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return Te(this._tileInfoTask.tileInfo)}get mapCollections(){var n,s,o,r;const e=(n=this.map)==null?void 0:n.call(this),t=[];return w(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(s=e==null?void 0:e.basemap)==null?void 0:s.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(o=e==null?void 0:e.ground)==null?void 0:o.layers},{parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let n=null;for(const o of e){const r=this._getSupportedSpatialReferences(o);if(r.length>0){const c=this._narrowDownSpatialReferenceCandidates(n,r);w(c)&&(n=c)}if(w(n)&&n.length===1)break}if(t&&($(n)||n.length!==1))return{updating:!0};const s=this._pickSpatialReferenceCandidate(n);return{spatialReference:w(s)?s.spatialReference:null,viewingMode:w(s)?s.viewingMode:null,updating:!1}}get _tileInfoTask(){var n,s,o,r,c,d,u;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(s=(n=this.map)==null?void 0:n.call(this))==null?void 0:s.basemap,layers:(c=(r=(o=this.map)==null?void 0:o.call(this))==null?void 0:r.basemap)==null?void 0:c.baseLayers},{layers:(u=(d=this.map)==null?void 0:d.call(this))==null?void 0:u.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const h=e[0].tileInfo;return{tileInfo:h&&h.spatialReference.equals(this.spatialReference)?h:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var n,s,o;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const r of e)if(Tm(r)){const c=Im(r);if(c)return{heightModelInfo:c,vcsWkid:(s=r.spatialReference)==null?void 0:s.vcsWkid,latestVcsWkid:(o=r.spatialReference)==null?void 0:o.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,n=[];for(const s of e.layers){const o="fullExtents"in s&&s.fullExtents||(w(s.fullExtent)?[s.fullExtent]:[]),r=this.requiresExtentInSpatialReference?null:o[0],c=o.find(d=>d.spatialReference.equals(this.spatialReference))??r;if(c)return{candidates:[{extent:c,layer:s}],updating:!1};if(this._getSupportedSpatialReferences(s).length>0)for(const d of o)n.push({extent:d,layer:s})}return{candidates:n,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if($(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),s=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:w(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(w(this._projectExtentTask.task)&&(this._projectExtentTask.task=Ys(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:s.clone(),task:ol(async o=>{try{const r=await Wl(n.extent,s,n.layer.portalItem,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:r}}catch{if(Wc(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if($(e))return t;const n=[],s=(o,r)=>w(o)?w(r)?o===r&&o:o:r;for(const o of e)for(const r of t){if(!o.spatialReference.equals(r.spatialReference))continue;const c=s(o.viewingMode,r.viewingMode);if(c!==!1){n.push({spatialReference:o.spatialReference,viewingMode:c});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return $(e)||e.length<1?w(t)?{spatialReference:t,viewingMode:null}:null:(w(t)&&e.length>1&&e.some(({spatialReference:n})=>n.equals(t))&&(e=e.filter(({spatialReference:n})=>n.equals(t))),e.length>1&&e.some(({viewingMode:n})=>n!==gr.Local)&&(e=e.filter(({viewingMode:n})=>n!==gr.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const n=[];for(const s of t){const o=this.getSpatialReferenceSupport({spatialReference:s,layer:e});if(w(o)){const r=w(o.constraints)?o.constraints:[{spatialReference:s,viewingMode:null}];for(const{spatialReference:c,viewingMode:d}of r)(!this.requiresExtentInSpatialReference||$(this.userSpatialReference)||c.equals(this.userSpatialReference))&&n.push({spatialReference:c,viewingMode:d})}}return n}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:n})=>t.equals(n.spatialReference))||e[0]}_collectLayers(e){var n;if(this._loadMaybe((n=this.map)==null?void 0:n.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const s of e)if(this._collectCollection(s,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const n of e.layers){switch(this._loadMaybe(n)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(n),"layers"in n&&this._collectCollection({layers:n.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};a([l()],N.prototype,"required",void 0),a([l({constructOnly:!0})],N.prototype,"map",void 0),a([l({constructOnly:!0})],N.prototype,"getSpatialReferenceSupport",void 0),a([l()],N.prototype,"defaultSpatialReference",void 0),a([l()],N.prototype,"userSpatialReference",void 0),a([l()],N.prototype,"sourcePreloadCount",void 0),a([l()],N.prototype,"priorityCollection",void 0),a([l()],N.prototype,"requiresExtentInSpatialReference",void 0),a([l()],N.prototype,"suspended",void 0),a([l({readOnly:!0})],N.prototype,"ready",null),a([l({readOnly:!0})],N.prototype,"heightModelInfoReady",null),a([l({readOnly:!0})],N.prototype,"spatialReference",null),a([l({readOnly:!0})],N.prototype,"extent",null),a([l({readOnly:!0})],N.prototype,"heightModelInfo",null),a([l({readOnly:!0})],N.prototype,"vcsWkid",null),a([l({readOnly:!0})],N.prototype,"latestVcsWkid",null),a([l({readOnly:!0})],N.prototype,"viewingMode",null),a([l({readOnly:!0})],N.prototype,"tileInfo",null),a([l({readOnly:!0})],N.prototype,"mapCollections",null),a([l({readOnly:!0})],N.prototype,"_allLayers",null),a([l({readOnly:!0})],N.prototype,"_spatialReferenceTask",null),a([l({readOnly:!0})],N.prototype,"_tileInfoTask",null),a([l({readOnly:!0})],N.prototype,"_heightModelInfoTask",null),a([l({readOnly:!0})],N.prototype,"_extentCandidatesTask",null),a([l()],N.prototype,"_extentTask",null),a([l()],N.prototype,"_projectExtentTask",void 0),N=a([M("esri.views.support.DefaultsFromMap")],N);var Dn;let k=Dn=class extends as(pn.EventedMixin(Gd(L))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new Un({getCollections:()=>{var e,t,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new rl,this.analyses=new ts,this.typeSpecificPreconditionsReady=!0,this.layerViews=new G,this.magnifier=new Dl,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Mm,this.navigation=new Ul,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new pm(this),this.persistableViewModels=new G,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(v(()=>this.preconditionsReady,e=>{var t,n;e?(this._currentSpatialReference=this.spatialReference,Dn.views.add(this)):(this._currentSpatialReference=null,Dn.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),w(this.analysisViewManager)&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown()):e&&!this.ready&&(this._startup(),w(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},rn))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,$o(()=>this.ready)))),this.basemapView=new Et({view:this}),this.layerViewManager=new um({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new ym({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([v(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),v(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),v(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([v(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var n;const t=((n=this.map)==null?void 0:n.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(w(i))return;const s=Ra(()=>i=Ys(i));i=ol(async o=>{try{await Po(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{i=null}R.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(s,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=ge(this.graphics),this.analyses=ge(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),ge(this.analysisViewManager),this.toolViewManager=ge(this.toolViewManager),this.layerViewManager=ge(this.layerViewManager),this.basemapView=ge(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return R.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new N({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||to.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(R.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),to.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!is(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return w(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new E("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return w(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&R.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(mt(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};k.views=new G,a([l()],k.prototype,"_userSpatialReference",void 0),a([l()],k.prototype,"activeTool",null),a([l({readOnly:!0})],k.prototype,"allLayerViews",void 0),a([l()],k.prototype,"groundView",void 0),a([l()],k.prototype,"animation",null),a([l()],k.prototype,"basemapView",void 0),a([l({readOnly:!0})],k.prototype,"_defaultsFromMapSettings",null),a([l()],k.prototype,"defaultsFromMap",null),a([l()],k.prototype,"fatalError",void 0),a([l({type:Li})],k.prototype,"extent",null),a([l(mr(rl,"graphics"))],k.prototype,"graphics",void 0),a([l(mr(ts,"analyses"))],k.prototype,"analyses",void 0),a([l({readOnly:!0,type:Fo})],k.prototype,"heightModelInfo",null),a([l({readOnly:!0})],k.prototype,"interacting",null),a([l({readOnly:!0})],k.prototype,"navigating",null),a([l({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],k.prototype,"preconditionsReady",null),a([l({readOnly:!0})],k.prototype,"typeSpecificPreconditionsReady",void 0),a([l({type:G,readOnly:!0})],k.prototype,"layerViews",void 0),a([l({type:Dl})],k.prototype,"magnifier",void 0),a([l({value:null,type:cm})],k.prototype,"map",null),a([l()],k.prototype,"padding",void 0),a([l({readOnly:!0})],k.prototype,"ready",void 0),a([l({type:Ao})],k.prototype,"spatialReference",null),a([l()],k.prototype,"spatialReferenceWarningDelay",void 0),a([l()],k.prototype,"stationary",null),a([l({readOnly:!0})],k.prototype,"supportsGround",void 0),a([l({type:Hd})],k.prototype,"timeExtent",void 0),a([l()],k.prototype,"tools",null),a([l()],k.prototype,"toolViewManager",void 0),a([l({readOnly:!0})],k.prototype,"type",void 0),a([l({type:Number})],k.prototype,"scale",void 0),a([l({readOnly:!0})],k.prototype,"updating",void 0),a([l({readOnly:!0})],k.prototype,"initialExtentRequired",void 0),a([l({readOnly:!0})],k.prototype,"initialExtent",null),a([l()],k.prototype,"cursor",null),a([l({readOnly:!0})],k.prototype,"input",void 0),a([l({type:Ul,nonNullable:!0})],k.prototype,"navigation",void 0),a([l()],k.prototype,"layerViewManager",void 0),a([l()],k.prototype,"analysisViewManager",void 0),a([l()],k.prototype,"width",void 0),a([l()],k.prototype,"height",void 0),a([l({readOnly:!0})],k.prototype,"resizing",void 0),a([l({value:null,readOnly:!0})],k.prototype,"size",null),a([l({readOnly:!0})],k.prototype,"suspended",void 0),a([l({readOnly:!0})],k.prototype,"viewEvents",void 0),a([l({readOnly:!0})],k.prototype,"persistableViewModels",void 0),a([l()],k.prototype,"_isValid",void 0),a([l()],k.prototype,"_readyCycleForced",void 0),a([l()],k.prototype,"_currentSpatialReference",void 0),k=Dn=a([M("esri.views.View")],k);const km=k;let kt=class extends Wd{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new E("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=Zc(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};a([l({readOnly:!0})],kt.prototype,"done",null),a([l({readOnly:!0,type:String})],kt.prototype,"state",void 0),a([l()],kt.prototype,"target",void 0),kt=a([M("esri.views.ViewAnimation")],kt),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(kt||(kt={}));const yo=kt;function zt(){return[1,0,0,1,0,0]}function Am(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function Pm(i,e,t,n,s,o){return[i,e,t,n,s,o]}function $m(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:zt,clone:Am,fromValues:Pm,createView:$m},Symbol.toStringTag,{value:"Module"}));const Zl=96,Kl=39.37,Sm=180/Math.PI;function Yl(i){return i.wkid?i:i.spatialReference||Ao.WGS84}function Zo(i,e){return e.type?oe(i,e.x,e.y):Zn(i,e)}function Ql(i){return id(i)}function on(i,e){const t=Math.max(1,e[0]),n=Math.max(1,e[1]);return Math.max(i.width/t,i.height/n)*Bm(i.spatialReference)}async function Xi(i,e,t,n){let s,o;if(!i||Array.isArray(i)&&!i.length)return null;if(G.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const c=i.every(h=>"attributes"in h),d=i.some(h=>!h.geometry);let u=i;if(c&&d&&e&&e.allLayerViews){const h=new Map;for(const _ of i){const C=_.layer,T=h.get(C)||[],A=_.attributes[C.objectIdField];A!=null&&T.push(A),h.set(C,T)}const p=[];h.forEach((_,C)=>{const T=e.allLayerViews.find(A=>A.layer.id===C.id);if("queryFeatures"in T){const A=C.createQuery();A.objectIds=_,A.returnGeometry=!0,p.push(T.queryFeatures(A))}});const g=await Promise.all(p),f=[];for(const _ of g)if(_&&_.features&&_.features.length)for(const C of _.features)w(C.geometry)&&f.push(C.geometry);u=f}for(const h of u)n=await Xi(h,e,t,n);return n}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")s=new Y(i);else if(i instanceof Dc)s=i;else if("geometry"in i){if(i.geometry)s=i.geometry;else if(i.layer){const c=i.layer,d=e.allLayerViews.find(u=>u.layer.id===c.id);if("queryFeatures"in d){const u=c.createQuery();u.objectIds=[i.attributes[c.objectIdField]],u.returnGeometry=!0;const h=await d.queryFeatures(u);s=Fc(h,"features",0,"geometry")}}}if($(s)||(o=s.type==="point"?new Li({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference}):s.extent,!o))return null;an()||os(o.spatialReference,t)||await rs();const r=un(o,t);return r?n=n?n.union(r):r:null}function Rm(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const n of i){const s=n.layer;s&&s.minScale&&s.maxScale&&(e=s.minScale<e?s.minScale:e,t=s.maxScale>t?s.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function Us(i,e){return is(Yl(i),e)?i:un(i,e)}async function Lm(i,e){if(!i||!e)return new Ze({targetGeometry:new Y,scale:0,rotation:0});let t=e.spatialReference;const{constraints:n,padding:s,viewpoint:o,size:r}=e,c=[s?r[0]-s.left-s.right:r[0],s?r[1]-s.top-s.bottom:r[1]];let d=null;i instanceof Ze?d=i:i.viewpoint?d=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(d=i.target);let u=null;d&&d.targetGeometry?u=d.targetGeometry:i instanceof Li?u=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(u=await Xi(i.center,e,t)||await Xi(i.extent,e,t)||await Xi(i.target,e,t)||await Xi(i,e,t)),!u&&o&&o.targetGeometry?u=o.targetGeometry:!u&&e.extent&&(u=e.extent),t||(t=Yl(e.spatialReference||e.extent||u)),an()||is(u.spatialReference,t)||os(u,t)||await rs();const h=Us(u.center?u.center:u,t);let p=null;if(d&&w(d.targetGeometry)&&d.targetGeometry.type==="point")p=d.scale;else if("scale"in i&&i.scale)p=i.scale;else if("zoom"in i&&i.zoom!==-1&&n&&n.effectiveLODs)p=n.zoomToScale(i.zoom);else if(Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0){const C=Us(e.extent,t);p=w(C)?on(C,c):e.extent?on(e.extent,c):o.scale}else p=on(Us(u.extent,t),c);const g=Rm(i);g&&(g.min&&g.min>p?p=g.min:g.max&&g.max<p&&(p=g.max));let f=0;d?f=d.rotation:i.hasOwnProperty("rotation")?f=i.rotation:o&&(f=o.rotation);let _=new Ze({targetGeometry:h,scale:p,rotation:f});return n&&(_=n.fit(_),n.constrainByGeometry(_),n.rotationEnabled||(_.rotation=f)),_}function Le(i,e){const t=i.targetGeometry,n=e.targetGeometry;return t.x=n.x,t.y=n.y,t.spatialReference=n.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function Fm(i,e,t){return t?oe(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):ls(i,e,.5)}const Om=function(){const i=ee();return function(e,t,n){const s=t.targetGeometry;Zo(i,s);const o=.5*Oi(t);return e.xmin=i[0]-o*n[0],e.ymin=i[1]-o*n[1],e.xmax=i[0]+o*n[0],e.ymax=i[1]+o*n[1],e.spatialReference=s.spatialReference,e}}();function Dm(i,e,t,n,s){return vo(i,e,t.center),i.scale=on(t,n),s&&s.constraints&&s.constraints.constrain(i),i}function Vm(i,e,t,n){return Qo(i,e,t,n),sl(i,i)}const Jl=function(){const i=ee();return function(e,t,n){return ll(e,qm(e,t),Fm(i,t,n))}}(),Nm=function(){const i=zt(),e=ee();return function(t,n,s,o){const r=Oi(n),c=Ko(n);return oe(e,r,r),Pd(i,e),Lo(i,i,c),Wn(i,i,Jl(e,s,o)),Wn(i,i,[0,o.top-o.bottom]),oe(t,i[4],i[5])}}();function Oi(i){return i.scale*zm(i.targetGeometry)}function zm(i){return w(i)&&Oa(i.spatialReference)?1/(Ql(i.spatialReference)*Kl*Zl):1}function Ko(i){return al(i.rotation)||0}function Bm(i){return Oa(i)?Ql(i)*Kl*Zl:1}function qm(i,e){return ls(i,e,.5)}const Yo=function(){const i=ee(),e=ee(),t=ee();return function(n,s,o,r,c,d){return eu(i,s),ls(e,o,.5*d),oe(t,1/r*d,-1/r*d),nl(n,e),c&&Lo(n,n,c),il(n,n,t),Wn(n,n,i),n}}(),Qo=function(){const i=ee();return function(e,t,n,s){const o=Oi(t),r=Ko(t);return Zo(i,t.targetGeometry),Yo(e,i,n,o,r,s)}}(),Um=function(){const i=ee();return function(e,t,n,s){const o=Oi(t);return Zo(i,t.targetGeometry),Yo(e,i,n,o,0,s)}}();function Hm(i){const e=Vc(i);return e?e.valid[1]-e.valid[0]:0}function jm(i,e){return Math.round(Hm(i)/e)}const Gm=function(){const i=ee(),e=ee(),t=[0,0,0];return function(n,s,o){no(i,n,s),fr(i,i),no(e,n,o),fr(e,e),Jd(t,i,e);let r=Math.acos(Xd(i,e)/(_r(i)*_r(e)))*Sm;return t[2]<0&&(r=-r),isNaN(r)&&(r=0),r}}(),Wm=function(){const i=ee();return function(e,t,n,s){const o=e.targetGeometry;return Le(e,t),Nm(i,t,n,s),o.x+=i[0],o.y+=i[1],e}}(),vo=function(i,e,t){Le(i,e);const n=i.targetGeometry;return n.x=t.x,n.y=t.y,n.spatialReference=t.spatialReference,i},Zm=function(){const i=ee();return function(e,t,n,s,o){o||(o="center"),ll(i,n,s),ls(i,i,.5);const r=i[0],c=i[1];switch(o){case"center":oe(i,0,0);break;case"left":oe(i,-r,0);break;case"top":oe(i,0,c);break;case"right":oe(i,r,0);break;case"bottom":oe(i,0,-c);break;case"top-left":oe(i,-r,c);break;case"bottom-left":oe(i,-r,-c);break;case"top-right":oe(i,r,c);break;case"bottom-right":oe(i,r,-c)}return fs(e,t,i),e}}();function Dw(i,e,t){return Le(i,e),i.rotation+=t,i}function Km(i,e,t){return Le(i,e),i.rotation=t,i}const Ym=function(){const i=ee();return function(e,t,n,s,o){return Le(e,t),isNaN(n)||n===0||(ec(i,s,t,o),e.scale=t.scale*n,tc(i,i,e,o),fs(e,e,oe(i,i[0]-s[0],s[1]-i[1]))),e}}();function _a(i,e,t){return Le(i,e),i.scale=t,i}const Xl=function(){const i=ee();return function(e,t,n,s,o,r){return Le(e,t),isNaN(n)||n===0||(ec(i,o,t,r),e.scale=t.scale*n,e.rotation+=s,tc(i,i,e,r),fs(e,e,oe(i,i[0]-o[0],o[1]-i[1]))),e}}(),Vw=function(){const i=ee(),e=ee();return function(t,n,s,o,r,c,d){return Jl(e,c,d),tu(i,r,e),o?Xl(t,n,s,o,i,c):Ym(t,n,s,i,c)}}(),ec=function(){const i=zt();return function(e,t,n,s){return dt(e,t,Vm(i,n,s,1))}}(),tc=function(){const i=zt();return function(e,t,n,s){return dt(e,t,Qo(i,n,s,1))}}(),fs=function(){const i=ee(),e=zt();return function(t,n,s){Le(t,n);const o=Oi(n),r=t.targetGeometry;return Ad(e,Ko(n)),il(e,e,nu(o,o)),dt(i,s,e),r.x+=i[0],r.y+=i[1],t}}();let Qm=class{constructor(e,t,n,s){const o=e.targetGeometry,r=t.targetGeometry;s?typeof s=="string"&&(s=Qd(s)||io.ease):s=io.ease,this.easing=s,this.duration=n,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const n=this.easing(t);let s,o,r,c;t>=1?(s=this.tCenterX,o=this.tCenterY,r=this.tRotation,c=this.tScale):(s=this.sCenterX+n*this.dCenterX,o=this.sCenterY+n*this.dCenterY,r=this.sRotation+n*this.dRotation,c=this.sScale+n*this.dScale),e.targetGeometry.x=s,e.targetGeometry.y=o,e.scale=c,e.rotation=r}},at=class extends L{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=io.ease,this.view=null,this.viewpoint=null,this.viewpoint=new Ze({targetGeometry:new Y,scale:0,rotation:0}),this._updateTask=$i({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,n){this.stop();const s=this.viewpoint;Le(s,t),this.transition=new Qm(this.viewpoint,e.target,n&&n.duration||this.duration,n&&n.easing||this.easing);const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const n=new yo({target:e.clone()}),s=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==yo.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const n=(performance.now()-this._startTime)/this.transition.duration,s=n>=1;this.transition.applyRatio(this.viewpoint,n),s&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};a([l()],at.prototype,"animation",void 0),a([l()],at.prototype,"duration",void 0),a([l()],at.prototype,"transition",void 0),a([l()],at.prototype,"easing",void 0),a([l()],at.prototype,"view",void 0),a([l()],at.prototype,"viewpoint",void 0),at=a([M("esri.views.2d.AnimationManager")],at);const Jm=at;let Xm=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:n,labelManager:s,layerViews:o,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),o.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),w(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),w(n)&&(n.lastUpdateId!==r&&(n.viewChange(),n.lastUpdateId=r),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=v(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=$i(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),n!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function Q(){return Promise.all([b(()=>import("./webglDeps-c1af4827.js"),["assets/webglDeps-c1af4827.js","assets/VertexArrayObject-27eaf50f.js","assets/Error-1dfe2922.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/Texture-2d4e629f.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-87dfae31.js","assets/enums-64ab819c.js","assets/ProgramTemplate-921deefe.js","assets/programUtils-10ee1e03.js"]),b(()=>import("./mapViewDeps-84a1d31d.js"),["assets/mapViewDeps-84a1d31d.js","assets/Error-1dfe2922.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/cast-7ef3a066.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-fd37db56.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/BufferPool-c97b1769.js","assets/WGLContainer-0eb146a3.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-10ee1e03.js","assets/RenderingContext-4e9b4456.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-0e3d86af.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-99764d75.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/assets-04f03891.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/persistableUrlUtils-2c2cd088.js","assets/styleUtils-58c095ea.js","assets/CircularArray-644a3423.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-2d282b7c.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-65439d4b.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/SimpleObservable-ddf0ceba.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/fieldUtils-cb9b3e6e.js","assets/Symbol-6522d2f3.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/Collection-8f94e599.js","assets/collectionUtils-07fb1a58.js","assets/labelUtils-d3906ba4.js","assets/jsonUtils-2b587c65.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/capabilities-dddb0ea5.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/PopupTemplate-2917795f.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/Graphic-c3b235bf.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-fdbb26d1.js","assets/asyncUtils-bd6eb812.js","assets/requestImageUtils-c32a0a09.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/TileInfo-9954a0c0.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/RelationshipQuery-2b83908f.js","assets/utils-4b8ae1e2.js","assets/ItemCache-eb0f81ed.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"])])}const Bi=()=>Q().then(()=>b(()=>import("./TileLayerView2D-ada9ca1b.js"),["assets/TileLayerView2D-ada9ca1b.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/Extent-54ef1174.js","assets/imageUtils-e4adc439.js","assets/BitmapTileContainer-24d2c26d.js","assets/aaBoundingRect-e7f76732.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-16faffe0.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/Collection-8f94e599.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/TileStrategy-b2d2fa5e.js","assets/RefreshableLayerView-5bc632d3.js","assets/drapedUtils-8e32f222.js","assets/unitUtils-58dc72ed.js"])),qi=()=>Q().then(()=>b(()=>import("./FeatureLayerView2D-934ef3d2.js"),["assets/FeatureLayerView2D-934ef3d2.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/TimeExtent-dfe3f644.js","assets/Query-8a7aa408.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-daef9679.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/visualVariablesUtils-b964ebb8.js","assets/createSymbolSchema-0ec759f8.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-0c1268cc.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),ya={"base-dynamic":()=>Q().then(()=>b(()=>import("./BaseDynamicLayerView2D-a12e0ee4.js"),["assets/BaseDynamicLayerView2D-a12e0ee4.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/BitmapContainer-4014ec9b.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-b911287d.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/Collection-8f94e599.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js","assets/ExportStrategy-b5fe9e09.js","assets/aaBoundingRect-e7f76732.js","assets/TileInfo-9954a0c0.js","assets/unitUtils-58dc72ed.js","assets/Bitmap-16faffe0.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/RefreshableLayerView-5bc632d3.js"])),"base-tile":Bi,"bing-maps":Bi,csv:qi,"geo-rss":()=>Q().then(()=>b(()=>import("./GeoRSSLayerView2D-3a05e7d2.js"),["assets/GeoRSSLayerView2D-3a05e7d2.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/Extent-54ef1174.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/reactiveUtils-b911287d.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/jsonUtils-196b5f3d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-daef9679.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/LayerView-3ffe8f9a.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/HandleOwner-2d282b7c.js","assets/GraphicContainer-fdbb26d1.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/VertexArrayObject-27eaf50f.js","assets/FeatureContainer-9ffbac33.js","assets/mat3-45e3f2eb.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js"])),feature:qi,geojson:qi,graphics:()=>Q().then(()=>b(()=>import("./GraphicsLayerView2D-e6a79f1f.js"),["assets/GraphicsLayerView2D-e6a79f1f.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/LayerView-3ffe8f9a.js","assets/reactiveUtils-b911287d.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-2d282b7c.js","assets/GraphicContainer-fdbb26d1.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/unitUtils-58dc72ed.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-2b587c65.js","assets/VertexArrayObject-27eaf50f.js","assets/FeatureContainer-9ffbac33.js","assets/mat3-45e3f2eb.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/lengthUtils-f3b6e37f.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-58c095ea.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js"])),group:()=>Q().then(()=>b(()=>import("./GroupLayerView2D-2ced41e6.js"),["assets/GroupLayerView2D-2ced41e6.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/GroupContainer-1968fd48.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-b911287d.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/Collection-8f94e599.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js"])),imagery:()=>Q().then(()=>b(()=>import("./ImageryLayerView2D-6ac6c611.js"),["assets/ImageryLayerView2D-6ac6c611.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/GraphicsLayer-32722b72.js","assets/HandleOwner-2d282b7c.js","assets/Layer-d4420615.js","assets/BlendLayer-00b35d0f.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/ElevationInfo-01beda98.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/RasterVFDisplayObject-8d8912ff.js","assets/VertexArrayObject-27eaf50f.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-c75aab1e.js","assets/pixelUtils-d21f4266.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-2b587c65.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-58c095ea.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-cab3d029.js","assets/BitmapContainer-4014ec9b.js","assets/Bitmap-16faffe0.js","assets/ExportStrategy-b5fe9e09.js","assets/TileInfo-9954a0c0.js","assets/rasterProjectionHelper-3b253976.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),"imagery-tile":()=>Q().then(()=>b(()=>import("./ImageryTileLayerView2D-b637f8c3.js"),["assets/ImageryTileLayerView2D-b637f8c3.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/multidimensionalUtils-e4b4c971.js","assets/RasterVFDisplayObject-8d8912ff.js","assets/HandleOwner-2d282b7c.js","assets/VertexArrayObject-27eaf50f.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-c75aab1e.js","assets/pixelUtils-d21f4266.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/aaBoundingRect-e7f76732.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/TileInfo-9954a0c0.js","assets/unitUtils-58dc72ed.js","assets/RawBlockCache-7e391761.js","assets/rasterProjectionHelper-3b253976.js","assets/projection-6d5d9468.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/lengthUtils-f3b6e37f.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/normalizeUtils-5312bea5.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/pbf-99764d75.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/RelationshipQuery-2b83908f.js","assets/LegendOptions-998df0a8.js","assets/utils-4b8ae1e2.js","assets/asyncUtils-bd6eb812.js","assets/ItemCache-eb0f81ed.js","assets/MemCache-15515535.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/deprecate-9e0289e6.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/BlendLayer-00b35d0f.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/FeatureReductionLayer-df295e9a.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/FieldsIndex-b44c88ca.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/mat2d-80bd93af.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"])),kml:()=>Q().then(()=>b(()=>import("./KMLLayerView2D-05c25059.js"),["assets/KMLLayerView2D-05c25059.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/reactiveUtils-b911287d.js","assets/Extent-54ef1174.js","assets/projection-6d5d9468.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-58dc72ed.js","assets/jsonMap-c8081704.js","assets/mat4-62d5e6a4.js","assets/Polyline-d942e774.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/kmlUtils-e38c00da.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/fieldUtils-cb9b3e6e.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/aaBoundingBox-10130714.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/jsonUtils-196b5f3d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-daef9679.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/normalizeUtils-5312bea5.js","assets/GraphicsLayer-32722b72.js","assets/HandleOwner-2d282b7c.js","assets/Layer-d4420615.js","assets/BlendLayer-00b35d0f.js","assets/parser-60fed632.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/ElevationInfo-01beda98.js","assets/Bitmap-16faffe0.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/BitmapContainer-4014ec9b.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/GraphicContainer-fdbb26d1.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/projectionSupport-5e9ecc7f.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/OperationalLayer-06028ec1.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js","assets/rasterProjectionHelper-3b253976.js","assets/RenderingContext-4e9b4456.js","assets/programUtils-10ee1e03.js","assets/OrderIndependentTransparency-602f26c2.js"])),"map-image":()=>Q().then(()=>b(()=>import("./MapImageLayerView2D-270c6ceb.js"),["assets/MapImageLayerView2D-270c6ceb.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/BitmapContainer-4014ec9b.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/unitUtils-58dc72ed.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-2b587c65.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/lengthUtils-f3b6e37f.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-58c095ea.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-cab3d029.js","assets/ExportStrategy-b5fe9e09.js","assets/TileInfo-9954a0c0.js","assets/Bitmap-16faffe0.js","assets/scaleUtils-41e2aa25.js","assets/ExportImageParameters-a0408478.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-d4a79327.js","assets/drapedUtils-8e32f222.js","assets/GraphicsLayer-32722b72.js","assets/Layer-d4420615.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),"map-notes":()=>Q().then(()=>b(()=>import("./MapNotesLayerView2D-94837c01.js"),["assets/MapNotesLayerView2D-94837c01.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/GroupContainer-1968fd48.js","assets/WGLContainer-0eb146a3.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/GraphicContainer-fdbb26d1.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/unitUtils-58dc72ed.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-2b587c65.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/lengthUtils-f3b6e37f.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-58c095ea.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js"])),media:()=>Q().then(()=>b(()=>import("./MediaLayerView2D-f8b4c7e7.js"),["assets/MediaLayerView2D-f8b4c7e7.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/reactiveUtils-b911287d.js","assets/aaBoundingRect-e7f76732.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/projection-6d5d9468.js","assets/preload-helper-596b5639.js","assets/unitUtils-58dc72ed.js","assets/mat4-62d5e6a4.js","assets/assets-04f03891.js","assets/request-3bbdab19.js","assets/zscale-65468675.js","assets/normalizeUtilsSync-5213d905.js","assets/jsonUtils-196b5f3d.js","assets/normalizeUtils-5312bea5.js","assets/TileStrategy-b2d2fa5e.js","assets/vec2-f978aef8.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/mat3-45e3f2eb.js","assets/mat3f64-b33e332c.js","assets/vec2f64-e0301652.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/VertexArrayObject-27eaf50f.js","assets/vec2f32-461e65a9.js","assets/vec3f32-4322908d.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/collectionUtils-07fb1a58.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js","assets/Graphic-c3b235bf.js","assets/PopupTemplate-2917795f.js","assets/fieldUtils-cb9b3e6e.js","assets/arcadeOnDemand-490dc8ce.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/persistableUrlUtils-2c2cd088.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/TileInfo-9954a0c0.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/pbf-99764d75.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/RelationshipQuery-2b83908f.js","assets/LegendOptions-998df0a8.js","assets/utils-4b8ae1e2.js","assets/asyncUtils-bd6eb812.js","assets/ItemCache-eb0f81ed.js","assets/MemCache-15515535.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/deprecate-9e0289e6.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/BlendLayer-00b35d0f.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/FeatureReductionLayer-df295e9a.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/FieldsIndex-b44c88ca.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/mat2d-80bd93af.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/capabilities-dddb0ea5.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"])),"ogc-feature":()=>Q().then(()=>b(()=>import("./OGCFeatureLayerView2D-61e33aea.js"),["assets/OGCFeatureLayerView2D-61e33aea.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/FeatureLayerView2D-934ef3d2.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/TimeExtent-dfe3f644.js","assets/Query-8a7aa408.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-daef9679.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/visualVariablesUtils-b964ebb8.js","assets/createSymbolSchema-0ec759f8.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-0c1268cc.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),"open-street-map":Bi,"oriented-imagery":qi,route:()=>Q().then(()=>b(()=>import("./RouteLayerView2D-874ff293.js"),["assets/RouteLayerView2D-874ff293.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/CollectionFlattener-8cf1891d.js","assets/reactiveUtils-b911287d.js","assets/Stop-157daf9a.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/LayerView-3ffe8f9a.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-2d282b7c.js","assets/GraphicContainer-fdbb26d1.js","assets/BaseGraphicContainer-65439d4b.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/unitUtils-58dc72ed.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-2b587c65.js","assets/VertexArrayObject-27eaf50f.js","assets/FeatureContainer-9ffbac33.js","assets/mat3-45e3f2eb.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-26a7c9c9.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/lengthUtils-f3b6e37f.js","assets/capabilities-dddb0ea5.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/Geometry-daada628.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-58c095ea.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js"])),stream:()=>Q().then(()=>b(()=>import("./StreamLayerView2D-54425793.js"),["assets/StreamLayerView2D-54425793.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/FeatureSet-daef9679.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/Graphic-c3b235bf.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/FeatureLayerView2D-934ef3d2.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/TimeExtent-dfe3f644.js","assets/Query-8a7aa408.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/visualVariablesUtils-b964ebb8.js","assets/createSymbolSchema-0ec759f8.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-0c1268cc.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),"subtype-group":()=>Q().then(()=>b(()=>import("./SubtypeGroupLayerView2D-fce282fa.js"),["assets/SubtypeGroupLayerView2D-fce282fa.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/TimeExtent-dfe3f644.js","assets/Query-8a7aa408.js","assets/enumeration-cda3949b.js","assets/jsonUtils-196b5f3d.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/PopupTemplate-2917795f.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/UniqueValueRenderer-08aa8b40.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/mathUtils-daf59e84.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/LegendOptions-998df0a8.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-c3b235bf.js","assets/compilerUtils-c5090cf5.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/deprecate-9e0289e6.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureLayerView2D-934ef3d2.js","assets/utils-b31292b4.js","assets/mat3f32-d3d088e8.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/FeatureSet-daef9679.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/visualVariablesUtils-b964ebb8.js","assets/createSymbolSchema-0ec759f8.js","assets/ExpandedCIM-0e3d86af.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-0c1268cc.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js"])),tile:Bi,"vector-tile":()=>Q().then(()=>b(()=>import("./VectorTileLayerView2D-f8ab933e.js"),["assets/VectorTileLayerView2D-f8ab933e.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/diffUtils-f2c670bd.js","assets/aaBoundingRect-e7f76732.js","assets/enums-bfc9e4e9.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/Queue-26a7c9c9.js","assets/assets-04f03891.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/pbf-99764d75.js","assets/rasterizingUtils-18039619.js","assets/floatRGBA-305df8f3.js","assets/TileKey-03ab4f60.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/TileStore-e480c2b6.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/VertexArrayObject-27eaf50f.js","assets/config-1337d16e.js","assets/TileContainer-5404bedc.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/WGLContainer-0eb146a3.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-c5214428.js","assets/colorUtils-0c057879.js","assets/unitBezier-881ac1eb.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView-3ffe8f9a.js","assets/HandleOwner-2d282b7c.js","assets/TileInfo-9954a0c0.js","assets/unitUtils-58dc72ed.js","assets/TileStrategy-b2d2fa5e.js"])),wcs:()=>Q().then(()=>b(()=>import("./ImageryTileLayerView2D-b637f8c3.js"),["assets/ImageryTileLayerView2D-b637f8c3.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/Graphic-c3b235bf.js","assets/geometry-22feb2bb.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/PopupTemplate-2917795f.js","assets/Clonable-c315fc8d.js","assets/Collection-8f94e599.js","assets/Evented-7dfb249a.js","assets/SimpleObservable-ddf0ceba.js","assets/fieldUtils-cb9b3e6e.js","assets/preload-helper-596b5639.js","assets/arcadeOnDemand-490dc8ce.js","assets/enumeration-cda3949b.js","assets/number-1bdcdfd9.js","assets/locale-30120714.js","assets/Identifiable-d701141a.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/Symbol-6522d2f3.js","assets/Color-7a3d8c62.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/request-3bbdab19.js","assets/persistableUrlUtils-2c2cd088.js","assets/collectionUtils-07fb1a58.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/jsonUtils-196b5f3d.js","assets/reactiveUtils-b911287d.js","assets/multidimensionalUtils-e4b4c971.js","assets/RasterVFDisplayObject-8d8912ff.js","assets/HandleOwner-2d282b7c.js","assets/VertexArrayObject-27eaf50f.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-c75aab1e.js","assets/pixelUtils-d21f4266.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/aaBoundingRect-e7f76732.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/TileInfo-9954a0c0.js","assets/unitUtils-58dc72ed.js","assets/RawBlockCache-7e391761.js","assets/rasterProjectionHelper-3b253976.js","assets/projection-6d5d9468.js","assets/assets-04f03891.js","assets/zscale-65468675.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/capabilities-dddb0ea5.js","assets/util-72a186a3.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/lengthUtils-f3b6e37f.js","assets/popupUtils-4738a9f0.js","assets/RefreshableLayerView-5bc632d3.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/normalizeUtils-5312bea5.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/pbf-99764d75.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/RelationshipQuery-2b83908f.js","assets/LegendOptions-998df0a8.js","assets/utils-4b8ae1e2.js","assets/asyncUtils-bd6eb812.js","assets/ItemCache-eb0f81ed.js","assets/MemCache-15515535.js","assets/jsonUtils-511fa9a1.js","assets/UniqueValueRenderer-08aa8b40.js","assets/diffUtils-f2c670bd.js","assets/colorRamps-68d0ae1f.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-2b587c65.js","assets/styleUtils-58c095ea.js","assets/DictionaryLoader-e6470716.js","assets/LRUCache-f9ba273b.js","assets/deprecate-9e0289e6.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/BlendLayer-00b35d0f.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/FeatureReductionLayer-df295e9a.js","assets/labelingInfo-aad6832f.js","assets/labelUtils-d3906ba4.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/FieldsIndex-b44c88ca.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/mat2d-80bd93af.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"])),"web-tile":Bi,wfs:qi,wms:()=>Q().then(()=>b(()=>import("./WMSLayerView2D-acad5eb4.js"),["assets/WMSLayerView2D-acad5eb4.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/Extent-54ef1174.js","assets/BitmapContainer-4014ec9b.js","assets/WGLContainer-0eb146a3.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/Collection-8f94e599.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js","assets/ExportStrategy-b5fe9e09.js","assets/aaBoundingRect-e7f76732.js","assets/TileInfo-9954a0c0.js","assets/unitUtils-58dc72ed.js","assets/Bitmap-16faffe0.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/RefreshableLayerView-5bc632d3.js","assets/OperationalLayer-06028ec1.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/persistableUrlUtils-2c2cd088.js","assets/ElevationInfo-01beda98.js","assets/fieldUtils-cb9b3e6e.js","assets/arcadeOnDemand-490dc8ce.js","assets/lengthUtils-f3b6e37f.js","assets/opacityUtils-2c2d0d87.js","assets/ExportWMSImageParameters-7bd90320.js"])),wmts:()=>Q().then(()=>b(()=>import("./WMTSLayerView2D-ce5654b5.js"),["assets/WMTSLayerView2D-ce5654b5.js","assets/cast-7ef3a066.js","assets/typedArrayUtil-4015bf74.js","assets/string-7d6c8f5c.js","assets/Error-1dfe2922.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/Extent-54ef1174.js","assets/imageUtils-e4adc439.js","assets/BitmapTileContainer-24d2c26d.js","assets/aaBoundingRect-e7f76732.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-16faffe0.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/TileContainer-5404bedc.js","assets/TileKey-03ab4f60.js","assets/WGLContainer-0eb146a3.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-3ffe8f9a.js","assets/Collection-8f94e599.js","assets/SimpleObservable-ddf0ceba.js","assets/collectionUtils-07fb1a58.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/HandleOwner-2d282b7c.js","assets/Identifiable-d701141a.js","assets/Promise-e08b9d4d.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/TileStrategy-b2d2fa5e.js","assets/RefreshableLayerView-5bc632d3.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function eg(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new E(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const va={hasLayerViewModule:i=>w(ya[i.type]),importLayerView:i=>{const e=ya[i.type];if($(e))throw eg(i);return e(i)}};function tg(i,e){const{spatialReference:t}=e,n=[e.x,e.y];let s=Number.POSITIVE_INFINITY,o=0,r=0;const c=[0,0],d=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const u of d)for(let h=0;h<u.length-1;h++){Md(c,n,u,h);const p=iu(n,c);p<s&&(s=p,o=c[0],r=c[1])}return{coordinate:new Y({x:o,y:r,spatialReference:t}),distance:s}}var wo;let si=wo=class extends Ro(L){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if($(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return un(this.geometry,this.spatialReference)}catch(i){return R.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if($(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?Da(this.normalizedGeometry,t):Nc(this.normalizedGeometry,t))return i;const{coordinate:n}=tg(this.normalizedGeometry,t);return n&&(i.targetGeometry=n),i}clone(){var i,e;return new wo({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};a([l({constructOnly:!0})],si.prototype,"geometry",void 0),a([l({readOnly:!0})],si.prototype,"normalizedGeometry",null),a([l({constructOnly:!0})],si.prototype,"spatialReference",void 0),si=wo=a([M("esri.views.2d.constraints.GeometryConstraint")],si);var bo;let en=bo=class extends Ro(L){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new bo({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([l()],en.prototype,"enabled",void 0),a([l()],en.prototype,"rotationEnabled",void 0),en=bo=a([M("esri.views.2d.constraints.RotationConstraint")],en);const ic=en;var Mo;let ye=Mo=class extends Ro(L){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:n,minZoom:s,maxZoom:o}=this,r=-1,c=-1,d=!1,u=!1;if(t!==0&&n!==0&&t<n&&([t,n]=[n,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",n);e=e.map(h=>h.clone()),e.sort((h,p)=>p.scale-h.scale),e.forEach((h,p)=>h.level=p);for(const h of e)!d&&t>0&&t>=h.scale&&(r=h.level,d=!0),!u&&n>0&&n>=h.scale&&(c=i?i.level:-1,u=!0),i=h;s===-1&&(s=t===0?0:r),o===-1&&(o=n===0?e.length-1:c),s=Math.max(s,0),s=Math.min(s,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),s>o&&([s,o]=[o,s]),t=e[s].scale,n=e[o].scale,e.splice(0,s),e.splice(o-s+1,e.length),e.forEach((h,p)=>{this._lodByScale[h.scale]=h,this._scales[p]=h.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",n)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,n=this.effectiveMaxScale,s=i.targetGeometry,o=e&&e.targetGeometry,r=n!==0&&i.scale<n,c=t!==0&&i.scale>t;if(r||c){const d=c?t:n;if(e&&o){const u=(d-e.scale)/(i.scale-e.scale);s.x=o.x+(s.x-o.x)*u,s.y=o.y+(s.y-o.y)*u}i.scale=d}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),n=Math.round(i);return e[n]+(n-i)*(e[t]-e[n])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,n;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(t=e[s],n=e[s+1],n===i)return s+this.effectiveMinZoom+1;if(t>i&&n<i)return s+this.effectiveMinZoom+1-(i-n)/(t-n)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new Mo({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};a([l({readOnly:!0})],ye.prototype,"effectiveLODs",void 0),a([l({readOnly:!0})],ye.prototype,"effectiveMinZoom",void 0),a([l({readOnly:!0})],ye.prototype,"effectiveMaxZoom",void 0),a([l({readOnly:!0})],ye.prototype,"effectiveMinScale",void 0),a([l({readOnly:!0})],ye.prototype,"effectiveMaxScale",void 0),a([l()],ye.prototype,"lods",void 0),a([l()],ye.prototype,"minZoom",void 0),a([l()],ye.prototype,"maxZoom",void 0),a([l()],ye.prototype,"minScale",void 0),a([l()],ye.prototype,"maxScale",void 0),a([l()],ye.prototype,"snapToZoom",void 0),ye=Mo=a([M("esri.views.2d.constraints.ZoomConstraint")],ye);const nc=ye,ig={base:null,key:"type",typeMap:{extent:Li,polygon:Xa}};let K=class extends L{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,n;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(n=this._geometry)==null?void 0:n.uid}`}get _defaultLODs(){var n,s,o;const e=(s=(n=this.view)==null?void 0:n.defaultsFromMap)==null?void 0:s.tileInfo,t=(o=this.view)==null?void 0:o.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new si({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new ic({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,n=this.minZoom,s=this.maxZoom,o=this.minScale,r=this.maxScale,c=this.snapToZoom;return e&&e.lods===t&&e.minZoom===n&&e.maxZoom===s&&e.minScale===o&&e.maxScale===r&&e.snapToZoom===c?e:new nc({lods:t,minZoom:n,maxZoom:s,minScale:o,maxScale:r,snapToZoom:c})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([l({readOnly:!0})],K.prototype,"effectiveLODs",null),a([l({readOnly:!0})],K.prototype,"effectiveMinScale",null),a([l({readOnly:!0})],K.prototype,"effectiveMaxScale",null),a([l({readOnly:!0})],K.prototype,"effectiveMinZoom",null),a([l({readOnly:!0})],K.prototype,"effectiveMaxZoom",null),a([l({types:ig,value:null})],K.prototype,"geometry",null),a([l({type:[Yc]})],K.prototype,"lods",void 0),a([l()],K.prototype,"minScale",void 0),a([l()],K.prototype,"maxScale",void 0),a([l()],K.prototype,"minZoom",void 0),a([l()],K.prototype,"maxZoom",void 0),a([l()],K.prototype,"rotationEnabled",void 0),a([l()],K.prototype,"snapToZoom",void 0),a([l()],K.prototype,"view",void 0),a([l({readOnly:!0})],K.prototype,"version",null),a([l()],K.prototype,"_defaultLODs",null),a([l({type:si})],K.prototype,"_geometry",null),a([l({type:ic})],K.prototype,"_rotation",null),a([l({readOnly:!0,type:nc})],K.prototype,"_zoom",null),K=a([M("esri.views.2d.MapViewConstraints")],K);const sc=K;function ng(i){return i instanceof Float32Array&&i.length>=2}function sg(i){return Array.isArray(i)&&i.length>=2}function Hs(i){return ng(i)||sg(i)}var Io;const tt=[0,0];let At=Io=class extends Re{constructor(i){super(i),this._viewpoint2D={center:ee(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new Li,this.id=0,this.inverseTransform=zt(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=zt(),this.transformNoRotation=zt(),this.displayMat3=Ms(),this.displayViewMat3=Ms(),this.viewMat3=Ms(),this.viewMat2d=$d(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Le(t,i.viewpoint),this._set("size",Zn(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Io({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return Hs(e)?dt(i,e,this.inverseTransform):(tt[0]=e,tt[1]=t,dt(i,tt,this.inverseTransform))}toScreen(i,e,t){return Hs(e)?dt(i,e,this.transform):(tt[0]=e,tt[1]=t,dt(i,tt,this.transform))}toScreenNoRotation(i,e,t){return Hs(e)?dt(i,e,this.transformNoRotation):(tt[0]=e,tt[1]=t,dt(i,tt,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return Yo(i,t,s,e,0,n),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,o=this._get("size"),r=new Ze({targetGeometry:new Y(i[0],i[1],e),scale:t,rotation:n});if(this._set("viewpoint",r),!o||!e||!t)return;this.resolution=Oi(r),this.rotation=n,this.scale=t,this.spatialReference=e,Zn(this.center,i);const c=o[0]!==0?2/o[0]:0,d=o[1]!==0?-2/o[1]:0;su(this.displayMat3,c,0,0,0,d,0,-1,1,1);const u=ou(this.viewMat3),h=vr(o[0]/2,o[1]/2),p=vr(-o[0]/2,-o[1]/2),g=al(n);yr(u,u,h),ru(u,u,g),yr(u,u,p),au(this.displayViewMat3,this.displayMat3,u);const f=nl(this.viewMat2d,h);return Lo(f,f,g),Wn(f,f,p),Om(this.extent,r,o),Qo(this.transform,r,o,s),sl(this.inverseTransform,this.transform),Um(this.transformNoRotation,r,o,s),this.worldScreenWidth=jm(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};a([l({readOnly:!0})],At.prototype,"id",void 0),a([l({value:1,json:{write:!0}})],At.prototype,"pixelRatio",null),a([l({json:{write:!0}})],At.prototype,"size",null),a([l()],At.prototype,"spatialReference",void 0),a([l({type:Ze,json:{write:!0}})],At.prototype,"viewpoint",null),At=Io=a([M("esri.views.2d.ViewState")],At);const wa=At;var Co,To;let ut=Co=class extends L{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Co({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([l()],ut.prototype,"left",void 0),a([l()],ut.prototype,"top",void 0),a([l()],ut.prototype,"right",void 0),a([l()],ut.prototype,"bottom",void 0),ut=Co=a([M("esri.views.2d.PaddedViewState.Padding")],ut);let Mi=To=class extends wa{constructor(...i){super(...i),this.paddedViewState=new wa,this._updateContent=(()=>{const e=ee();return()=>{const t=this._get("size"),n=this._get("padding");if(!t||!n)return;const s=this.paddedViewState;oe(e,n.left+n.right,n.top+n.bottom),no(e,t,e),Zn(s.size,e);const o=s.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(v(()=>[this.size,this.padding],()=>this._updateContent(),rn)),this.padding=new ut,this.size=[0,0]}set padding(i){this._set("padding",i||new ut)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,Wm(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,n=e.targetGeometry;t.center[0]=n.x,t.center[1]=n.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=n.spatialReference,this._update()}}clone(){return new To({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([l()],Mi.prototype,"paddedViewState",void 0),a([l({type:ut})],Mi.prototype,"padding",null),a([l()],Mi.prototype,"viewpoint",null),Mi=To=a([M("esri.views.2d.PaddedViewState")],Mi);const og=Mi;function Jo(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}let ba=class extends te{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,n=>this._handleDoubleClick(n,t))}_handleDoubleClick(e,t){Jo(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},rg=class extends te{constructor(e,t,n){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",n,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:n}=t;if(n!==this.pointerType)return;e.stopPropagation();const{action:s,delta:o}=t,{view:r}=this,{mapViewNavigation:c}=r;switch(s){case"begin":{const{scale:d}=r;this._startScale=d,this._currentScale=d,this._previousDelta=o,c.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const d=1.015**o.y,u=this._startScale*d,h=u/this._currentScale;c.setViewpointImmediate(h),this._currentScale=u;break}case"end":{const{constraints:d}=r,{effectiveLODs:u,snapToZoom:h}=d;if(!h||!u)return void c.end();const p=d.snapScale(this._currentScale),g=(o.y>0?Math.max(p,d.snapToPreviousScale(this._startScale)):Math.min(p,d.snapToNextScale(this._startScale)))/this._currentScale;c.zoom(g);break}}}},_s=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,n=t.pointers.size;switch(t.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,n;this._startEvent=e,(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},ag=class extends te{constructor(e,t,n){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",n,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new _s({start:(t,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(t,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(t,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(t,n)=>t===1&&Jo(n.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},lg=class extends te{constructor(e,t,n){super(!0),this._view=e,this.pointerAction=t;const s=this._view.mapViewNavigation;this._dragEventSeparator=new _s({start:(o,r)=>{s.rotate.begin(this._view,r.data),r.stopPropagation()},update:(o,r)=>{s.rotate.update(this._view,r.data),r.stopPropagation()},end:(o,r)=>{s.rotate.end(),r.stopPropagation()},condition:(o,r)=>o===1&&Jo(r.data,this.pointerAction)}),this.registerIncoming("drag",n,o=>this._dragEventSeparator.handle(o))}};function Pe(i){let e=i*i;return i<0&&(e*=-1),e}function cg(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function dg(i,e,t){const n=t,s=i.state,o=i.device,r=e.tiltDirection==="forward-down"?1:-1,c=1;return o.deviceType==="standard"?(n.translation[0]=Pe(s.axes[0]),n.translation[1]=Pe(s.axes[1]),n.translation[2]=Pe(s.buttons[7])-Pe(s.buttons[6]),n.heading=Pe(s.axes[2]),n.tilt=Pe(s.axes[3])):o.deviceType==="spacemouse"&&(n.translation[0]=1.2*Pe(s.axes[0]),n.translation[1]=1.2*Pe(s.axes[1]),n.translation[2]=2*-Pe(s.axes[2]),n.heading=1.2*Pe(s.axes[5]),n.tilt=1.2*Pe(s.axes[3])),n.tilt*=r,Sc(n.translation,n.translation,c),n}function ug(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let hg=class extends te{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Ke,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([v(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=$i({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},V)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,cg(this._transformation)):(this._currentDevice=e.data.device,dg(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(ug(t))return;const n=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,o=mg*s*e;fs(n,n,[t.translation[0]*o,-t.translation[1]*o]);const r=1+t.translation[2]*gg*e,c=this._view.constraints.rotationEnabled?-t.heading*pg*e:0,d=this._view.size,u=[d[0]/2,d[1]];Xl(n,n,r,c,u,d);const h=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=h}};const pg=.06,mg=.7,gg=6e-4;let fg=class extends te{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",n,s=>this._handleKeyUp(s)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const n=this._keyMap[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},_g=class extends te{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",n,s=>this._handleKeyUp(s)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=s!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var Ai;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(Ai||(Ai={}));let yg=class extends te{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),t.zoomIn.forEach(s=>this._keysToZoomAction[s]=Ai.IN),t.zoomOut.forEach(s=>this._keysToZoomAction[s]=Ai.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const s=this._keysToZoomAction[n],{mapViewNavigation:o}=this.view;let r=null;switch(s){case Ai.IN:r=o.zoomIn();break;case Ai.OUT:r=o.zoomOut();break;default:return}o.begin(),r.then(()=>o.end()),e.stopPropagation()}};const vg=.6;let wg=class extends te{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:n,y:s,deltaY:o}=e.data,r=1/vg**(1/60*o),c=t.zoom(r,[n,s]);c&&(this._canZoom=!1,c.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},bg=class extends te{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new _s({start:(n,s)=>{t.pinch.begin(this.view,s.data),s.stopPropagation()},update:(n,s)=>{t.pinch.update(this.view,s.data),s.stopPropagation()},end:(n,s)=>{t.pinch.end(this.view),s.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Ma(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>Cg(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Mg(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Ig(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function Cg(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let Tg=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const r=o.gamepad,c=r.index,d=this._inputDevices[c];d&&(this._emitGamepadEvent(r,Ma(d),!1),this._inputDevices.splice(c,1),this._latestUpdate.splice(c,1),this._input.gamepad.devices.remove(d),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=n&&s,this.supported&&(this._forEachGamepad(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new Wo(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=$i({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(s=>{const o=this._inputDevices[s.index];if(!o)return;const r=this._latestUpdate[s.index],c=Ma(o),d=n||Ig(c);r&&(r.timestamp===s.timestamp||!r.active&&d||Mg(r.state,c))||this._emitGamepadEvent(s,c,!d)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let n=0;n<t.length;n++){const s=t[n];this._validate(s)&&e(s)}}_emitGamepadEvent(e,t,n){const s=this._latestUpdate[e.index],o=s&&s.active;if(!o&&!n)return;const r=!o&&n?"start":o&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:r})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const Ia=ve("trident"),Ca=ve("edge"),Eg=ve("chrome"),xg=ve("ff"),kg=ve("safari"),yi={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let Xo=class{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Tg(e,this._input),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=ge(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const n=this._active[t];this._element.removeEventListener(js[t],n),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&js[t]){const n=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(js[t],n),this._active[t]=n}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?yi.touchNone:yi.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?yi.touchPan:yi.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(yi.touchNone),this._element.classList.remove(yi.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const n=Bl(this._element,e);return Xo.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,t){const n=Pp(t);n&&e==="key-up"&&this._keyDownState.delete(n);const s={native:t,key:n,repeat:n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n)}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(Ia||Ca)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Ia||Ca?n*=.7:Eg||kg?n*=.6:xg&&(n*=1.375);const s=100,o=Math.abs(n);o>s&&(n=n/o*200/(1+Math.exp(-.02*(o-s))));const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,r)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Xo.test={disableSubpixelCoordinates:!1};const js={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Ag=class extends te{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function er(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function Pg(i,e){const t=e.x-i.x,n=e.y-i.y;return Math.sqrt(t*t+n*n)}function $g(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:we()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[O,z]=i,[J,B]=[z.x-O.x,z.y-O.y];return e.radius=Math.sqrt(J*J+B*B)/2,e.center.x=(O.x+z.x)/2,e.center.y=(O.y+z.y)/2,e}let t=0,n=0;for(let O=0;O<i.length;O++)t+=i[O].x,n+=i[O].y;t/=i.length,n/=i.length;const s=i.map(O=>O.x-t),o=i.map(O=>O.y-n);let r=0,c=0,d=0,u=0,h=0,p=0,g=0;for(let O=0;O<s.length;O++){const z=s[O],J=o[O],B=z*z,de=J*J;r+=B,c+=de,d+=z*J,u+=B*z,h+=de*J,p+=z*de,g+=J*B}const f=.5*(u+p),_=.5*(h+g),C=r*c-d*d,T=(f*c-_*d)/C,A=(r*_-d*f)/C,F=we(T+t,A+n);return{radius:Math.sqrt(T*T+A*A+(r+c)/i.length),center:F}}function li(i){const{native:e}=i,{pointerId:t,button:n,pointerType:s}=e;return s==="mouse"?`${t}:${n}`:`${s}`}const Ae={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let Sg=class extends te{constructor(e=Ae.maximumDoubleClickDelay,t=Ae.maximumDoubleClickDistance,n=Ae.maximumDoubleTouchDelay,s=Ae.maximumDoubleTouchDistance,o=ss){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Bt(e.doubleClickTimer))}get hasPendingInputs(){return ns(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=Bt(n.doubleClickTimer),t&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:n,button:s}=e.native;return n==="mouse"?`${t}:${s}`:`${n}`}_handleImmediateClick(e){const t=e.data,{pointerType:n}=t.native,s=this._getPointerId(t);if(!this._pointerState.has(s))return void this._startClick(e);const o=this._pointerState.get(s),{data:r,modifiers:c}=o.event,d=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;er(r,t)>d?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),o.pointerDownCount===2&&this._doubleClick.emit(r,void 0,c))}_handlePointerDown(e){const t=li(e.data),n=this._pointerState.get(t);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:n}}=t,s=li(t),o=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),o),c=1;this._pointerState.set(s,{event:e,doubleClickTimer:r,pointerDownCount:c}),this.refreshHasPendingInputs()}},Rg=class extends te{constructor(e=Ae.maximumDoubleClickDelay,t=Ae.maximumDoubleClickDistance,n=Ae.maximumDoubleTouchDelay,s=Ae.maximumDoubleTouchDistance,o=ss){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=we(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new _s({start:(r,c)=>this._dragStart(r,c),update:(r,c)=>this._dragUpdate(c),end:(r,c)=>this._dragEnd(c)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Bt(e.doubleTapTimeout)})}get hasPendingInputs(){return ns(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Bt(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,n){const{button:s,buttons:o,pointer:r,pointers:c,pointerType:d,timestamp:u}=n;return{action:e,delta:t,button:s,buttons:o,pointer:r,pointers:c,pointerType:d,timestamp:u}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:s}=t,{center:o}=n;this._dragStartCenter=o;const r=this._createDoubleTapDragData("begin",we(0,0),n);this._doubleTapDrag.emit(r,void 0,s),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:s}=t,o=we(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",o,t);this._doubleTapDrag.emit(r,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:s}=t,o=we(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",o,t);this._doubleTapDrag.emit(r,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,n=li(t),s=this._pointerState.get(n),{pointerType:o}=t.native;if(s){const r=o==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(n),er(s.event.data,t)>r?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:n}=t.native,s=li(t),o=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._clearPointerDown(s),o);this._pointerState.set(s,{event:e,doubleTapTimeout:r}),this.refreshHasPendingInputs()}},Lg=class extends te{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,n,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:s,pointers:Fg(this._activePointerMap),pointer:t,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const t=e.native.pointerId,n=Mn(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,s);const o=Vn(s,oc(this._activePointerMap));s.initialAngle=o,s.lastAngle=o,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,n=this._activePointerMap.get(t);n?n.event=e:this._addPointer(e)}_removePointer(e){const t=Mn(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=Mn(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=Vn(n,t)-e,n.lastAngle=Vn(n,t)-e})}_emitEvent(e,t,n){const s=Mn(this._activePointerMap);this._drag.emit(this._createPayload(e,t,s,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,n=ys(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,ys(e.timestamp))))}_handlePointerDrag(e){const t=e.data,n=t.currentEvent,s=ys(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function oc(i){const e=[];return i.forEach(t=>{e.push(we(t.event.x,t.event.y))}),$g(e)}function Mn(i){const e=oc(i);let t=0;return i.forEach(n=>{let s=Vn(n,e),o=s-n.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;s=n.lastAngle+o,n.lastAngle=s;const r=s-n.initialAngle;t+=r}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function Fg(i){const e=new Map;return i.forEach((t,n)=>e.set(n,t.event)),e}function Vn(i,e){const t=i.event,n=t.x-e.center.x,s=t.y-e.center.y;return Math.atan2(s,n)}var Ta;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(Ta||(Ta={}));let Og=class extends te{constructor(e=Ae.maximumDoubleClickDelay,t=Ae.maximumDoubleClickDistance,n=Ae.maximumDoubleTouchDelay,s=Ae.maximumDoubleTouchDistance,o=ss){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=li(t);if(!this._pointerState.has(n)){const s={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(n,s),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,n=li(t),s=this._pointerState.get(n);if(s&&s.downButton===t.native.button){const o=s.immediateDoubleClick;if(o){o.timeoutHandle.remove();const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;er(o,e.data)>r?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,t){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const t=li(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const Ui={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let Dg=class extends te{constructor(e=Ui.maximumClickDelay,t=Ui.movementUntilMouseDrag,n=Ui.movementUntilPenDrag,s=Ui.movementUntilTouchDrag,o=Ui.holdDelay,r=ss){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=s,this._holdDelay=o,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",c=>{this._handlePointerLoss(c,"pointer-up")}),this.registerIncoming("pointer-capture-lost",c=>{this._handlePointerLoss(c,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",c=>{this._handlePointerLoss(c,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Bt(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=t.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const r=this._pointerState.get(n);if(r){if(!r.isDragging){const c=r.previousEvent;this._pointerHold.emit(c,void 0,e.modifiers),r.holdEmitted=!0}r.holdTimeout=null}},this._holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(n,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,n){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:n}}_handlePointerMove(e){const t=e.data,n=t.native.pointerId,s=this._pointerState.get(n);s&&(s.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",s,t),void 0,s.modifiers):Pg(t,s.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),s.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,n=t.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,n===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,t)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const n=e.data,s=n.native.pointerId,o=this._pointerState.get(s);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",o,t==="pointer-up"?n:o.previousEvent),void 0,o.modifiers):t==="pointer-up"&&o.downButton===n.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(s),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};const In={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Jt=class extends L{constructor(){super(...arguments),this._handles=new Ke}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([mt(()=>!e(),()=>this._disconnect()),mt(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=ge(this._inputManager)}_connect(){const e=this.view.surface,t=new Xo(e,this.view.input),n=[new Og,new Dg,new Sg,new Lg(this.view.navigation),new Rg],s=new Ve({eventSource:t,recognizers:n});s.installHandlers("prevent-context-menu",[new Ag],Nt.INTERNAL),s.installHandlers("navigation",[new bg(this.view),new hg(this.view),new wg(this.view),new ba(this.view),new ba(this.view,[In.counter]),new ag(this.view,"primary"),new fg(this.view,In.pan),new yg(this.view,In.zoom),new _g(this.view,In.rotate),new lg(this.view,"secondary"),new rg(this.view,"touch")],Nt.INTERNAL),this.view.viewEvents.connect(s),this._source=t,this._inputManager=s,v(()=>{var o,r;return(r=(o=this.view)==null?void 0:o.navigation)==null?void 0:r.browserTouchPanEnabled},o=>{this._source&&(this._source.browserTouchPanningEnabled=!o)},V)}get test(){return{inputManager:this._inputManager}}};a([l()],Jt.prototype,"view",void 0),a([l()],Jt.prototype,"latestPointerType",null),a([l()],Jt.prototype,"latestPointerLocation",null),a([l()],Jt.prototype,"multiTouchActive",null),Jt=a([M("esri.views.2d.input.MapViewInputManager")],Jt);const Vg=Jt;let Ng=0,Pt=class extends L{constructor(){super(...arguments),this.color=new Ut([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return Ng++}};a([l({readOnly:!0})],Pt.prototype,"version",null),a([l({type:Ut})],Pt.prototype,"color",void 0),a([l({type:Ut})],Pt.prototype,"haloColor",void 0),a([l()],Pt.prototype,"haloOpacity",void 0),a([l()],Pt.prototype,"fillOpacity",void 0),Pt=a([M("esri.views.2d.support.HighlightOptions")],Pt);const rc=Pt,zg=i=>i.includes("Brush");let ac=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),zg(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function Bg(i,e,t,n,s,o,r,c){let d;i.ignorePadding&&(n={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?d=[i.width,i.height]:i.width==null&&i.height!=null?d=[i.height,i.height]:i.width!=null&&i.height==null?d=[i.width,i.width]:i.width==null&&i.height==null&&(d=null);const u=t[0]-(n.left+n.right),h=t[1]-(n.top+n.bottom);let p,g,f=i.area||{x:0,y:0,width:u,height:h};if(d){const _=u/h,C=d[0]/d[1];if(C>_){const T=f.width/C;f={x:f.x,y:Math.round(f.y+(f.height-T)/2),width:f.width,height:Math.round(T)}}else{const T=f.height*C;f={x:Math.round(f.x+(f.width-T)/2),y:f.y,width:Math.round(T),height:f.height}}}else d=[f.width,f.height];return d[0]>f.width?(p=Math.min(d[0]/f.width,e),g=d[0]/f.width/p):(p=1,g=d[0]/f.width),{resolutionScale:p,cropArea:{x:Math.round((f.x+n.left)*p),y:Math.round((f.y+n.top)*p),width:Math.round(f.width*p),height:Math.round(f.height*p)},outputScale:g,format:s,quality:o,children:r,rotation:c}}function qg(i,e,t){const{ctx:n,canvas:s}=lc(i,t),o=n.getImageData(0,0,i.width,i.height),r=jg(s,e);return cc(s),{dataUrl:r,data:o}}function Ug(i,e){const{ctx:t,canvas:n}=lc(i,e),s=t.getImageData(0,0,i.width,i.height);return cc(n),s}function lc(i,e){const t=Hg();e.premultipliedAlpha&&Yg(i),t.width=i.width,t.height=i.height;const n=t.getContext("2d");return n.putImageData(i,0,0),e.flipY&&Kg(n),{ctx:n,canvas:t}}function cc(i){i.width=0,i.height=0}function Hg(){return $(Gs)&&(Gs=document.createElement("canvas")),Gs}let Gs=null;function jg(i,e){const t=Qg[e.format],n=e.quality/100;return i.toDataURL(t,n)}function Gg(i,e){const t=Zg(i),n=Xg[t];return{format:t,quality:Si(e??n,0,100)}}function Wg(i,e){return e/Math.max(i[0],i[1])}function ub(i,e,t,n=0,s=0,o=i.width-n,r=i.height-s,c=!1){const{data:d}=i,{width:u,height:h,data:p}=e,g=o/u,f=r/h,_=Math.ceil(g/2),C=Math.ceil(f/2),T=i.width;for(let A=0;A<h;A++)for(let F=0;F<u;F++){const O=4*(F+(c?h-A-1:A)*u);let z=0,J=0,B=0,de=0,Fe=0,Qe=0;const gt=(A+.5)*f;for(let ue=Math.floor(A*f);ue<(A+1)*f;ue++){const D=Math.abs(gt-(ue+.5))/C,Oe=(F+.5)*g,di=D*D;for(let jt=Math.floor(F*g);jt<(F+1)*g;jt++){const ui=Math.abs(Oe-(jt+.5))/_,hi=Math.sqrt(di+ui*ui);if(hi>=1)continue;let ft=2*hi*hi*hi-3*hi*hi+1;const pi=4*(n+jt+(s+ue)*T);Qe+=ft*d[pi+3],J+=ft,!t&&d[pi+3]<255&&(ft=ft*d[pi+3]/255),B+=ft*d[pi],de+=ft*d[pi+1],Fe+=ft*d[pi+2],z+=ft}}p[O]=B/z,p[O+1]=de/z,p[O+2]=Fe/z,p[O+3]=Qe/J}return e}function Zg(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Jg}}function Kg(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function Yg(i){const e=i.data,t=e.length;for(let n=0;n<t;n+=4){const s=e[n+3];if(s!==255&&s>0){const o=255/s;e[n+0]=e[n+0]*o,e[n+1]=e[n+1]*o,e[n+2]=e[n+2]*o}}}const Qg={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},Ea=98,Jg="png",Xg={png:100,jpg:Ea,jpeg:Ea};function ef(i){const e=du(i);if(!e.available)return new E("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new E("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new E("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new E("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===uu.WEBGL1){if(!e.supportsElementIndexUint)return new E("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new E("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new E("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function tf(i){return i&&"nodeType"in i}function nf(i){return i&&typeof i.render=="function"}const xa={component:"esri-component"};let Xt=class extends L{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(xa.component),t&&t.classList.remove(xa.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||tf(e)?(this._set("widget",null),qa(e)):(nf(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([l({dependsOn:[]})],Xt.prototype,"id",null),a([l()],Xt.prototype,"node",null),a([be("node")],Xt.prototype,"castNode",null),a([l({readOnly:!0})],Xt.prototype,"widget",void 0),Xt=a([M("esri.views.ui.Component")],Xt);const Nn=Xt,sf={left:0,top:0,bottom:0,right:0},dc={bottom:30,top:15,right:15,left:15},Ws="manual",he={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function of(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function Zs(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function Ks(i,{top:e,bottom:t,left:n,right:s}){i.style.top=e,i.style.bottom=t,i.style.left=n,i.style.right=s}let lt=class extends pn.EventedAccessor{constructor(i){super(i),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new Ke,this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&Ks(e,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&Ks(e,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([v(()=>{var i;return[(i=this.view)==null?void 0:i.padding,this.container]},this._applyViewPadding,V),v(()=>this.padding,this._applyUIPadding,V)])}destroy(){this.container=null;for(const i of this._components)i.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(i){const e=this._get("container");i!==e&&(i&&(i.classList.add(he.ui),Eh(i),this._attachContainers(i)),e&&(e.classList.remove(he.ui),Ks(e,{top:"",bottom:"",left:"",right:""}),Ua(e)),this._set("container",i))}get height(){const i=this.get("view.height")||0;if(i===0)return i;const e=this._getViewPadding(),t=e.top+e.bottom;return Math.max(i-t,0)}get padding(){return this._get("padding")}set padding(i){this._overrideIfSome("padding",i)}castPadding(i){return typeof i=="number"?{bottom:i,top:i,right:i,left:i}:{...dc,...i}}get width(){const i=this.get("view.width")||0;if(i===0)return i;const e=this._getViewPadding(),t=e.left+e.right;return Math.max(i-t,0)}add(i,e){let t,n;if(Array.isArray(i))return void i.forEach(o=>this.add(o,e));const s=Zs(i);s&&({index:t,position:e,component:i,key:n}=s),e&&typeof e=="object"&&({index:t,key:n,position:e}=e),!i||e&&!this._isValidPosition(e)||this._add(i,e,t,n)}remove(i,e){if(!i)return;if(Array.isArray(i))return i.map(n=>this.remove(n,e));const t=this._find(i);if(t){const n=this._componentToKey;if(n.has(i)&&n.get(i)!==e)return;const s=this._components.indexOf(t);return t.node.parentNode&&t.node.parentNode.removeChild(t.node),this._componentToKey.delete(i),this._components.splice(s,1)[0]}}empty(i){return Array.isArray(i)?i.map(e=>this.empty(e)).reduce((e,t)=>e.concat(t)):(i=i||Ws)===Ws?Array.prototype.slice.call(this._manualContainer.children).filter(e=>!e.classList.contains(he.corner)).map(e=>this.remove(e)):this._isValidPosition(i)?Array.prototype.slice.call(this._cornerNameToContainerLookup[i].children).map(this.remove,this):null}move(i,e){if(Array.isArray(i)&&i.forEach(o=>this.move(o,e)),!i)return;let t;const n=Zs(i)||Zs(e);if(n&&(t=n.index,e=n.position,i=n.component||i),e&&!this._isValidPosition(e))return;const s=this.remove(i);s&&this.add(s,{position:e,index:t})}find(i){if(!i)return null;const e=this._findById(i);return e&&(e.widget||e.node)}getPosition(i){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(i))return e;return null}_add(i,e,t,n){i instanceof Nn||(i=new Nn({node:i})),this._place({component:i,position:e,index:t}),this._components.push(i),n&&this._componentToKey.set(i,n)}_find(i){return i?i instanceof Nn?this._findByComponent(i):typeof i=="string"?this._findById(i):this._findByNode(i.domNode||i):null}_getViewPadding(){return this.get("view.padding")||sf}_attachContainers(i){i.appendChild(this._innerContainer),i.appendChild(this._manualContainer)}_initContainers(){const i=document.createElement("div");i.classList.add(he.innerContainer),i.classList.add(he.cornerContainer);const e=document.createElement("div");e.classList.add(he.innerContainer),e.classList.add(he.manualContainer);const t=document.createElement("div");t.classList.add(he.topLeft),t.classList.add(he.corner),i.appendChild(t);const n=document.createElement("div");n.classList.add(he.topRight),n.classList.add(he.corner),i.appendChild(n);const s=document.createElement("div");s.classList.add(he.bottomLeft),s.classList.add(he.corner),i.appendChild(s);const o=document.createElement("div");o.classList.add(he.bottomRight),o.classList.add(he.corner),i.appendChild(o),this._innerContainer=i,this._manualContainer=e;const r=Ge();this._cornerNameToContainerLookup={"top-left":t,"top-right":n,"bottom-left":s,"bottom-right":o,"top-leading":r?n:t,"top-trailing":r?t:n,"bottom-leading":r?o:s,"bottom-trailing":r?s:o},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(i){return!!this._positionNameToContainerLookup[i]}_place(i){const e=i.component,t=i.position||Ws,n=i.index,s=this._positionNameToContainerLookup[t],o=n>-1;if(of(e.widget)&&e.widget.startup(),!o)return void s.appendChild(e.node);const r=Array.prototype.slice.call(s.children);if(n===0)return void(s.firstChild?lr(e.node,s.firstChild):s.appendChild(e.node));n>=r.length?s.appendChild(e.node):lr(e.node,r[n])}_toPxPosition(i){return{top:this._toPxUnit(i.top),left:this._toPxUnit(i.left),right:this._toPxUnit(i.right),bottom:this._toPxUnit(i.bottom)}}_toPxUnit(i){return i===0?"0":i+"px"}_findByComponent(i){let e,t=null;return this._components.some(n=>(e=n===i,e&&(t=n),e)),t}_findById(i){let e,t=null;return this._components.some(n=>(e=n.id===i,e&&(t=n),e)),t}_findByNode(i){let e,t=null;return this._components.some(n=>(e=n.node===i,e&&(t=n),e)),t}};a([l()],lt.prototype,"container",null),a([l()],lt.prototype,"height",null),a([l({value:dc})],lt.prototype,"padding",null),a([be("padding")],lt.prototype,"castPadding",null),a([l()],lt.prototype,"view",void 0),a([l()],lt.prototype,"width",null),lt=a([M("esri.views.ui.UI")],lt);const rf=lt;function ka(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function af(i,e){return i.length!==e.length||i.some((t,n)=>t.text!==e[n].text)}function Cn(i,e,t){!t||!e||i.find(n=>n.layerView===e&&n.text===t)||i.push({text:t,layerView:e})}function lf(i){return i.type==="bing-maps"}const yt=[];let Ii=class extends ja{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new G,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const n=this.get("view.allLayerViews");n&&this.handles.add(n.map(s=>v(()=>{var o;return[s.suspended,(o=s.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.handles.add([Se(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),mt(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");yt.length=0,e?(e.forEach(t=>{var o;if(t.suspended||!((o=t.layer)!=null&&o.attributionVisible))return;const n=t.layer;if(ka(n,"user"))return void Cn(yt,t,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(t)){const r=this._fetchedAttributionData.get(t);return void(r?Cn(yt,t,this._getDynamicAttribution(r,this.view,n)):ka(n)&&Cn(yt,t,n.copyright))}return void this._fetchAttributionData(t)}const s=n.get("portalItem.accessInformation");Cn(yt,t,s||n.copyright)}),af(this.items,yt)&&(this.items.removeAll(),this.items.addMany(yt)),yt.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await jd(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const n=t.ok?this._createContributionIndex(t.value,lf(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,n)}this._updateAttributionItems()}_createContributionIndex(e,t){const n=e.contributors,s={};if(!n)return s;for(let o=0;o<n.length;o++){const r=n[o],c=r.coverageAreas;if(!c)return;for(const d of c){const u=d.bbox,h=d.zoomMin-(t&&d.zoomMin?1:0),p=d.zoomMax-(t&&d.zoomMax?1:0),g={xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:Ao.WGS84},f={extent:ko(g),attribution:r.attribution||"",score:d.score!=null?d.score:100,id:o};for(let _=h;_<=p;_++)s[_]=s[_]||[],s[_].push(f)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(e,t,n){const{extent:s,scale:o}=t;let r=n.tileInfo.scaleToZoom(o);if(r=Math.min(e.maxKey,Math.round(r)),!s||r==null||r<=-1)return"";const c=e[r],d=zc(s.center.clone().normalize(),t.spatialReference),u={};return c?c.filter(h=>{const p=!u[h.id]&&d&&Da(h.extent,d);return p&&(u[h.id]=!0),p}).sort((h,p)=>p.score-h.score||h.objectId-p.objectId).map(h=>h.attribution).join(", "):""}};a([l({readOnly:!0,type:G})],Ii.prototype,"items",void 0),a([l({readOnly:!0})],Ii.prototype,"state",null),a([l()],Ii.prototype,"view",void 0),Ii=a([M("esri.widgets.Attribution.AttributionViewModel")],Ii);const uc=Ii,vt={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let me=class extends re{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:s})=>this._checkSourceTextOverflow(s))),this.iconClass=vt.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new uc}initialize(){this.addHandles(Se(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[vt.open]:this._isOpen};return m("div",{bind:this,class:this.classes(vt.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return m("div",{class:vt.poweredBy},"Powered by"," ",m("a",{class:vt.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,n=t?"0":"",{attributionText:s}=this,o={[vt.sourcesOpen]:e,[vt.interactive]:t};return m("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(vt.sources,o),innerHTML:s,tabindex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:n,clientWidth:s,scrollWidth:o}=e,r=o>s,c=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,c&&(t=!0),this._isOpen){const d=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,d&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([l()],me.prototype,"_isOpen",void 0),a([l()],me.prototype,"_isInteractive",null),a([l()],me.prototype,"_attributionTextOverflowed",void 0),a([l()],me.prototype,"_prevSourceNodeHeight",void 0),a([l({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],me.prototype,"attributionText",null),a([l()],me.prototype,"iconClass",void 0),a([l()],me.prototype,"itemDelimiter",void 0),a([l()],me.prototype,"label",null),a([l(),ne("esri/widgets/Attribution/t9n/Attribution")],me.prototype,"messages",void 0),a([l()],me.prototype,"view",null),a([l({type:uc})],me.prototype,"viewModel",void 0),a([Ee()],me.prototype,"_toggleState",null),me=a([M("esri.widgets.Attribution")],me);const cf=me,df="esri.widgets.CompassViewModel";let ei=class extends Go(L){constructor(e){super(e),this._handles=new Ke,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(v(()=>this.view,this._updateRotationWatcher,V))}destroy(){this._handles=Bt(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?v(()=>e==null?void 0:e.rotation,this._updateForRotation,V):v(()=>e==null?void 0:e.camera,this._updateForCamera,V))}};a([l({readOnly:!0})],ei.prototype,"canShowNorth",null),a([l()],ei.prototype,"orientation",void 0),a([l({readOnly:!0})],ei.prototype,"state",null),a([l()],ei.prototype,"view",void 0),ei=a([M(df)],ei);const hc=ei,wt={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let qe=class extends re{constructor(e,t){super(e,t),this.iconClass=wt.widgetIcon,this.messages=null,this.viewModel=new hc}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,n=t==="disabled",s=(t==="rotation"?"rotation":"compass")=="compass",o=n?-1:0,r={[wt.disabled]:n,[wt.interactive]:!n},c={[wt.northIcon]:s,[wt.rotationIcon]:!s},{messages:d}=this;return m("div",{bind:this,class:this.classes(wt.base,r),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:o,"aria-label":d.reset,title:d.reset},m("span",{"aria-hidden":"true",class:this.classes(wt.icon,c),styles:this._toRotationTransform(e)}),m("span",{class:wt.text},d.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};a([l()],qe.prototype,"goToOverride",null),a([l()],qe.prototype,"iconClass",void 0),a([l()],qe.prototype,"label",null),a([l(),ne("esri/widgets/Compass/t9n/Compass")],qe.prototype,"messages",void 0),a([l()],qe.prototype,"view",null),a([l({type:hc})],qe.prototype,"viewModel",void 0),a([Ee()],qe.prototype,"_reset",null),qe=a([M("esri.widgets.Compass")],qe);const uf=qe;let Ci=class extends L{constructor(i){super(i),this.navigationMode="pan",this.view=null}initialize(){this.own(mt(()=>{var i;return(i=this.view)==null?void 0:i.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};a([l({readOnly:!0})],Ci.prototype,"state",null),a([l()],Ci.prototype,"navigationMode",void 0),a([l()],Ci.prototype,"view",void 0),Ci=a([M("esri.widgets.NavigationToggleViewModel")],Ci);const pc=Ci,xe={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let Ue=class extends re{constructor(e,t){super(e,t),this.iconClass=xe.widgetIcon,this.messages=null,this.viewModel=new pc}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",n={[xe.disabled]:e,[xe.isLayoutHorizontal]:this.layout==="horizontal"},s={[xe.activeButton]:t},o={[xe.activeButton]:!t},r=e?-1:0,c=this.messages.toggle;return m("div",{bind:this,class:this.classes(xe.base,n),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":c,title:c},m("div",{class:this.classes(xe.button,xe.panButton,s)},m("span",{class:xe.panIcon})),m("div",{class:this.classes(xe.button,xe.rotateButton,o)},m("span",{class:xe.rotationIcon})))}_toggle(){this.toggle()}};a([l()],Ue.prototype,"iconClass",void 0),a([l()],Ue.prototype,"label",null),a([l({value:"vertical"})],Ue.prototype,"layout",null),a([l(),ne("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Ue.prototype,"messages",void 0),a([l()],Ue.prototype,"view",null),a([l({type:pc})],Ue.prototype,"viewModel",void 0),a([Ee()],Ue.prototype,"_toggle",null),Ue=a([M("esri.widgets.NavigationToggle")],Ue);const hf=Ue,Hi={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let $t=class extends re{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[Hi.disabled]:!this.enabled,[Hi.interactive]:this.enabled},n={[this.iconClass]:!!this.iconClass};return m("div",{bind:this,class:this.classes(Hi.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},m("span",{"aria-hidden":"true",role:"presentation",class:this.classes(Hi.icon,n)}),m("span",{class:Hi.iconText},this.title))}_triggerAction(){this.action.call(this)}};a([l()],$t.prototype,"action",void 0),a([l()],$t.prototype,"enabled",void 0),a([l()],$t.prototype,"iconClass",void 0),a([l()],$t.prototype,"title",void 0),a([Ee()],$t.prototype,"_triggerAction",null),$t=a([M("esri.widgets.IconButton")],$t);const Aa=$t;let Ti=class extends L{get canZoomIn(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return e===0||i>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return e===0||i<e}};a([l({readOnly:!0})],Ti.prototype,"canZoomIn",null),a([l({readOnly:!0})],Ti.prototype,"canZoomOut",null),a([l()],Ti.prototype,"view",void 0),Ti=a([M("esri.widgets.Zoom.ZoomConditions2D")],Ti);const pf=Ti;let Ei=class extends L{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([l({readOnly:!0})],Ei.prototype,"canZoomIn",null),a([l({readOnly:!0})],Ei.prototype,"canZoomOut",null),a([l()],Ei.prototype,"view",void 0),Ei=a([M("esri.widgets.Zoom.ZoomConditions3D")],Ei);const mf=Ei;let St=class extends L{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return w(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return w(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new pf({view:e}):e.type==="3d"&&(this._zoomConditions=new mf({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():tn(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():tn(e.goTo({zoomFactor:.5}))}};a([l()],St.prototype,"_zoomConditions",void 0),a([l()],St.prototype,"canZoomIn",null),a([l()],St.prototype,"canZoomOut",null),a([l({readOnly:!0})],St.prototype,"state",null),a([l()],St.prototype,"view",null),St=a([M("esri.widgets.Zoom.ZoomViewModel")],St);const mc=St,ji={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let ct=class extends re{constructor(e,t){super(e,t),this.iconClass=ji.widgetIcon,this.messages=null,this.viewModel=new mc}initialize(){this._zoomInButton=new Aa({action:this.zoomIn.bind(this),iconClass:ji.zoomInIcon}),this._zoomOutButton=new Aa({action:this.zoomOut.bind(this),iconClass:ji.zoomOutIcon})}destroy(){this._zoomInButton=ge(this._zoomInButton),this._zoomOutButton=ge(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[ji.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:s}=e;this._zoomInButton.enabled=n,this._zoomOutButton.enabled=s;const{zoomIn:o,zoomOut:r}=this.messages;return this._zoomInButton.title=o,this._zoomOutButton.title=r,m("div",{class:this.classes(ji.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};a([l()],ct.prototype,"iconClass",void 0),a([l()],ct.prototype,"label",null),a([l({value:"vertical"})],ct.prototype,"layout",null),a([l(),ne("esri/widgets/Zoom/t9n/Zoom")],ct.prototype,"messages",void 0),a([l()],ct.prototype,"view",null),a([l({type:mc})],ct.prototype,"viewModel",void 0),ct=a([M("esri.widgets.Zoom")],ct);const gf=ct;function ff(i){return i&&i.view!==void 0}let zn=class extends rf{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([v(()=>this.components,this._componentsWatcher.bind(this),V),v(()=>this.view,this._updateViewAwareWidgets.bind(this),V)])}_add(e,t,n,s){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,n,s)}_removeComponents(e){e.forEach(t=>{const n=this._find(t);n&&(this.remove(n),n.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const n=this._find(t),s=n&&n.widget;ff(s)&&(s.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new Nn({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new cf({view:this.view})}_createCompass(){return new uf({view:this.view})}_createNavigationToggle(){return new hf({view:this.view})}_createZoom(){return new gf({view:this.view})}};a([l()],zn.prototype,"components",void 0),zn=a([M("esri.views.ui.DefaultUI")],zn);const _f=zn;let Bn=class extends _f{constructor(i){super(i),this.components=["attribution","zoom"]}};a([l()],Bn.prototype,"components",void 0),Bn=a([M("esri.views.ui.2d.DefaultUI2D")],Bn);const gc=Bn;var Eo;let qn=Eo=class extends Re{constructor(i){super(i),this.color=new Ut([0,0,0,1])}clone(){return new Eo(Qs({color:this.color}))}};a([l({type:Ut,json:{write:!0}})],qn.prototype,"color",void 0),qn=Eo=a([M("esri.webmap.background.ColorBackground")],qn);const yf=qn;let fc,_c,yc,vc,wc,bc;async function vf(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:n,MagnifierView2D:s,Stage:o}]=await Promise.all([b(()=>import("./webglDeps-c1af4827.js"),["assets/webglDeps-c1af4827.js","assets/VertexArrayObject-27eaf50f.js","assets/Error-1dfe2922.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/Texture-2d4e629f.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-87dfae31.js","assets/enums-64ab819c.js","assets/ProgramTemplate-921deefe.js","assets/programUtils-10ee1e03.js"]),b(()=>import("./mapViewDeps-84a1d31d.js"),["assets/mapViewDeps-84a1d31d.js","assets/Error-1dfe2922.js","assets/string-7d6c8f5c.js","assets/typedArrayUtil-4015bf74.js","assets/promiseUtils-e323addc.js","assets/reactiveUtils-b911287d.js","assets/cast-7ef3a066.js","assets/ArrayPool-45db95ab.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-3bbdab19.js","assets/preload-helper-596b5639.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-fd37db56.js","assets/utils-b31292b4.js","assets/parser-60fed632.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-7dfb249a.js","assets/enums-4ca4641f.js","assets/MaterialKey-13d5dd3c.js","assets/Utils-69437480.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-2d4e629f.js","assets/context-util-87dfae31.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-7a3d8c62.js","assets/BufferPool-c97b1769.js","assets/WGLContainer-0eb146a3.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-d21f4266.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-27eaf50f.js","assets/ProgramTemplate-921deefe.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-99b22ab9.js","assets/jsonUtils-196b5f3d.js","assets/Extent-54ef1174.js","assets/Polyline-d942e774.js","assets/OptimizedFeature-aa2e72dc.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-10ee1e03.js","assets/RenderingContext-4e9b4456.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-0e3d86af.js","assets/arcadeOnDemand-490dc8ce.js","assets/geometry-22feb2bb.js","assets/typeUtils-17403a33.js","assets/jsonMap-c8081704.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-e7f76732.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-14228c88.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-99764d75.js","assets/Matcher-7fc777fc.js","assets/TileStrategy-b2d2fa5e.js","assets/TileStore-e480c2b6.js","assets/Queue-26a7c9c9.js","assets/TileKey-03ab4f60.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-8a7aa408.js","assets/TimeExtent-dfe3f644.js","assets/enumeration-cda3949b.js","assets/Field-a857bb5a.js","assets/fieldType-36e8171c.js","assets/Clonable-c315fc8d.js","assets/visualVariablesUtils-cd632025.js","assets/visualVariablesUtils-b964ebb8.js","assets/tileUtils-d57fc766.js","assets/TileClipper-e5c55398.js","assets/assets-04f03891.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-f9ba273b.js","assets/MemCache-15515535.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-af5b2c18.js","assets/Loadable-772aaf20.js","assets/Promise-e08b9d4d.js","assets/locale-30120714.js","assets/PortalGroup-100f1bed.js","assets/PortalUser-0170111d.js","assets/persistableUrlUtils-2c2cd088.js","assets/styleUtils-58c095ea.js","assets/CircularArray-644a3423.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-2d282b7c.js","assets/FeatureSetReader-67ae9e70.js","assets/centroid-e729b670.js","assets/lengthUtils-f3b6e37f.js","assets/unitUtils-58dc72ed.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-65439d4b.js","assets/normalizeUtilsSync-5213d905.js","assets/normalizeUtils-5312bea5.js","assets/projectionSupport-5e9ecc7f.js","assets/projection-6d5d9468.js","assets/SimpleObservable-ddf0ceba.js","assets/zscale-65468675.js","assets/json-48e3ea08.js","assets/labelingInfo-aad6832f.js","assets/symbols-d548a197.js","assets/CIMSymbol-308c5b42.js","assets/fieldUtils-cb9b3e6e.js","assets/Symbol-6522d2f3.js","assets/opacityUtils-2c2d0d87.js","assets/aaBoundingBox-10130714.js","assets/Collection-8f94e599.js","assets/collectionUtils-07fb1a58.js","assets/labelUtils-d3906ba4.js","assets/jsonUtils-2b587c65.js","assets/FeatureContainer-9ffbac33.js","assets/TileContainer-5404bedc.js","assets/capabilities-dddb0ea5.js","assets/schemaUtils-c4717aaf.js","assets/LayerFloorInfo-ca7cf7a9.js","assets/diffUtils-f2c670bd.js","assets/createSymbolSchema-0ec759f8.js","assets/rendererUtils-0c1268cc.js","assets/FeatureReductionLayer-df295e9a.js","assets/BlendLayer-00b35d0f.js","assets/PopupTemplate-2917795f.js","assets/number-1bdcdfd9.js","assets/Identifiable-d701141a.js","assets/UniqueValueRenderer-08aa8b40.js","assets/LegendOptions-998df0a8.js","assets/colorRamps-68d0ae1f.js","assets/Graphic-c3b235bf.js","assets/compilerUtils-c5090cf5.js","assets/jsonUtils-511fa9a1.js","assets/DictionaryLoader-e6470716.js","assets/deprecate-9e0289e6.js","assets/OperationalLayer-06028ec1.js","assets/ElevationInfo-01beda98.js","assets/util-72a186a3.js","assets/ComputedAttributeStorage-cf5d6510.js","assets/FieldsIndex-b44c88ca.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-fdbb26d1.js","assets/asyncUtils-bd6eb812.js","assets/requestImageUtils-c32a0a09.js","assets/Cyclical-1a93cb12.js","assets/CollectionFlattener-8cf1891d.js","assets/workers-957326d1.js","assets/Connection-4985e9bc.js","assets/intl-c3eb9a7a.js","assets/messages-c2cf09a4.js","assets/TileInfo-9954a0c0.js","assets/widget-99edfa96.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-27522a1d.js","assets/query-54e69cb9.js","assets/pbfQueryUtils-b3e55309.js","assets/queryZScale-9c82ac96.js","assets/FeatureSet-daef9679.js","assets/RelationshipQuery-2b83908f.js","assets/utils-4b8ae1e2.js","assets/ItemCache-eb0f81ed.js","assets/TopFeaturesQuery-c1b3daab.js","assets/FeatureLayer-7be1483a.js","assets/MultiOriginJSONSupport-98cda0d2.js","assets/FeatureLayerBase-1c170846.js","assets/HeightModelInfo-91a7cb2a.js","assets/arcgisLayerUrl-af21cccf.js","assets/Layer-d4420615.js","assets/editsZScale-6893b5ed.js","assets/APIKeyMixin-62cd629d.js","assets/ArcGISService-391eca72.js","assets/CustomParametersMixin-1353f893.js","assets/EditBusLayer-862b6183.js","assets/OrderedLayer-5a5e20b8.js","assets/PortalLayer-2a93959d.js","assets/PortalItem-49bcac17.js","assets/RefreshableLayer-e9f8071f.js","assets/ScaleRangeLayer-21fc7ea0.js","assets/TemporalLayer-797e0d5e.js","assets/TimeInfo-ce3628a3.js","assets/FeatureTemplate-281b6fcc.js","assets/FeatureType-980424ee.js","assets/fieldProperties-69262b89.js","assets/versionUtils-5fe0d938.js","assets/styleUtils-d1f4a996.js","assets/popupUtils-3b3b82a2.js","assets/Scheduler-5da9d6c9.js","assets/Basemap-3aa7b130.js","assets/loadAll-b6703d72.js","assets/writeUtils-5e02c8fc.js","assets/layerUtils-6996b9ea.js","assets/TablesMixin-43889bfa.js","assets/GraphicsLayer-32722b72.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/geometryEngine-03c3e44c.js","assets/geometryEngineBase-3dd302e0.js","assets/hydrated-e2f14ddc.js"])]);_c=i,yc=e,vc=t,wc=n,bc=s,fc=o}const Pa=160;function wf(i){return i&&i.declaredClass==="esri.Viewpoint"}let P=class extends Fu(em(tm(km))){constructor(i){super(i),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Un({getCollections:()=>{var e,t;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,this.layerViews,(t=this.basemapView)==null?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new Xm(this),this._pePromise=null,this.floors=new G,this.highlightOptions=new rc,this.inputManager=new Vg({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new ac,this.type="2d",this.ui=new gc,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new sc,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([v(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(Pa)},rn),this.on("resize",e=>this._resizeHandler(e)),v(()=>{var e;return(e=this.animationManager)==null?void 0:e.animation},e=>{this.animation=e})]),Kc()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new lu(this.featuresTilingScheme)}get initialExtentRequired(){var r;const{scale:i,constraints:e,center:t,viewpoint:n,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((r=this.map.initialViewProperties)!=null&&r.viewpoint))&&!s&&(e!=null&&e.effectiveLODs||(o=-1),(!t||i===0&&o===-1)&&(!n||!w(n.targetGeometry)||n.targetGeometry.type!=="extent"&&!n.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!an()||(this._pePromise||(this._pePromise=rs().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const i=this._getDefaultViewpoint();if(!i)return!1;const e=this.spatialReference,t=Te(i.targetGeometry);return!!os(t.spatialReference,e)||this._projectionEngineLoaded}set animation(i){const e=this._get("animation");if(i===e)return;if(e&&e.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i),this.frameTask.animationInProgress=!0;const t=()=>{var n;i===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};i.when(t,t)}get background(){return Mf(this.map)?this.map.initialViewProperties.background:null}set background(i){this._override("background",i)}get center(){if(!this.ready)return this._get("center");const{center:i,spatialReference:e}=this.state.paddedViewState;return new Y({x:i[0],y:i[1],spatialReference:e})}set center(i){if(i==null)return;if(!this.ready)return this._set("center",i),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(n){return void R.getLogger(this.declaredClass).error(new E("mapview:invalid-center","could not project the value in the view's spatial reference",{input:i,error:n}))}const t=this.viewpoint;vo(t,t,e),this.viewpoint=t}set constraints(i){const e=this._get("constraints");e&&(this.handles.remove("map-view-constraints"),e.destroy()),this._set("constraints",i),i&&(i.view=this,this.ready&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint)),this.handles.add(v(()=>i.version,()=>{this.ready&&this.state&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint))},rn),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(i){if(i==null)return;if(!i.width||!i.height)return void R.getLogger(this.declaredClass).error(new E("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",i),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(n){return void R.getLogger(this.declaredClass).error(new E("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const t=this.viewpoint;Dm(t,t,e,this.size,{constraints:this.constraints}),this.viewpoint=t}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(i){this.ready?(this.state.padding=i,this._set("padding",this.state.padding)):this._set("padding",i)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(i){if(isNaN(i))return;if(!this.ready)return void this._set("rotation",i);const e=this.viewpoint;Km(e,e,i),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(i){if(!i||isNaN(i))return;if(!this.ready){this._set("scale",i),this._set("zoom",-1);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;_a(e,e,i),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var e,t,n;const i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(ve("esri-2d-log-updating")){const s=this.allLayerViews.reduce((o,r)=>({...o,[r.layer.id]:!r.destroyed&&!("layerViews"in r)&&r.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(e=this.layerViewManager)==null?void 0:e.updating}
-> labelManager.updating: ${(t=this.labelManager)==null?void 0:t.updating}
-> graphicsView.updating: ${(n=this.graphicsView)==null?void 0:n.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return i}get viewpoint(){if(!this.ready)return this._get("viewpoint");const i=this.state.paddedViewState;return i&&i.viewpoint.clone()}set viewpoint(i){if(i==null)return;if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let e,t;try{e=this._project(i,this.spatialReference),!i.scale||isNaN(i.scale)?t=new E("mapview:invalid-viewpoint",`invalid scale value of ${i.scale}`):$(i.targetGeometry)&&(t=new E("mapview:invalid-viewpoint","geometry not defined"))}catch(s){t=new E("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(t)return void R.getLogger(this.declaredClass).error(t);this._scaleBeforeChangingSpatialReference=null;const n=new Ze({targetGeometry:new Y,scale:0,rotation:0});Le(n,e),this.constraints.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this.frameTask.requestFrame(),this._set("viewpoint",n)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(i){if(i==null)return;if(!this.ready){this._set("zoom",i),this._set("scale",0);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const e=this.viewpoint;_a(e,e,this.constraints.zoomToScale(i)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(i,e){if(i)return this.animation&&(this.animation=null),this._createAnimation(),$o(()=>this.ready,e).then(()=>{const t={animate:!0,...e},n=Lm(i,this);return this.animation.update(n),this._gotoTask={},t.animate?this._gotoAnimated(n,t):this._gotoImmediate(n,t)});R.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(i,e){const t=ha(i)?ua(this,i):i;if(!this.ready||isNaN(t.x)||isNaN(t.y))return{screenPoint:t,results:[]};let n=new Set,s=!1,o=null,r=null;e!=null&&e.include?Sa(e.include,$a(this,h=>n.add(h),h=>{o||(o=new Set),o.add(h)},h=>n.add(h),()=>s=!0)):(s=!0,n=new Set(this.allLayerViews)),e!=null&&e.exclude&&Sa(e.exclude,$a(this,h=>n.delete(h),h=>{r||(r=new Set),r.add(h)}));const c=this.allLayerViews.filter(h=>!h.suspended&&n.has(h)).reverse(),d=this.toMap(t);let u=[...s?this.graphicsView.hitTest(d).map(h=>({type:"graphic",graphic:h,layer:null,mapPoint:d})):[],...await Promise.all(c.map(h=>h.hitTest(d,t)).toArray())].filter(w).flat().filter(w);return o&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||o.has(xo(h.graphic)))),r&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||r.has(xo(h.graphic)))),{screenPoint:t,results:u}}async takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return qg(t,{format:e.format,quality:e.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return Ug(t,this._pixelFormat)}_createScreenshotPlan(i){i=i||{};const e=this.supersampleScreenshotsEnabled?Math.min(4,Wg(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let t;i.layers?(t=[],i.layers.forEach(o=>{const r=this.allLayerViews.find(c=>c.layer.id===o.id);r&&"container"in r&&r.container&&t.push(r.container)})):t=this._stage.children;const{format:n,quality:s}=Gg(i.format,i.quality);return Bg(i,e,this.size,this.padding,n,s,t,i.rotation)}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}toMap(i){if(!this.ready)return null;const e=ha(i)?ua(this,i):i,t=[0,0],[n,s]=this.state.toMap(t,[e.x,e.y]),o=this.spatialReference;return new Y({x:n,y:s,spatialReference:o})}toScreen(i){if(!this.ready)return null;const e=this._project(i,this.spatialReference),t=[e.x,e.y];return this.state.toScreen(t,t),we(t[0],t[1])}on(i,e,t,n){return this.inputManager&&this.viewEvents.on(i,e,t,n)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}whenLayerView(i){return super.whenLayerView(i)}graphicChanged(i){this.graphicsView&&this.graphicsView.graphicUpdateHandler(i)}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||null}hasLayerViewModule(i){return va.hasLayerViewModule(i)}importLayerView(i){return va.importLayerView(i)}pixelSizeAt(){return this.ready?this.state.resolution:(R.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(i){return this.hitTest(i).then(e=>({...e,mapPoint:this.toMap(i)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let i=ef(this.type);return ve("safari")&&ve("safari")<9&&(i=new E("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ve("safari")})),w(i)?(R.getLogger(this.declaredClass).warn("#validate()",i.message),Promise.reject(i)):vf()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new yo),this.animation}_cancellableGoTo(i,e,t){const n=()=>i===this._gotoTask,s=t.then(()=>{n()&&(this.animation=null)}).catch(r=>{throw n()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),r}),o=new Promise(r=>r(s));return e.when().catch(()=>{n()&&o.cancel&&o.cancel()}),o}_gotoImmediate(i,e){const t=this._gotoTask,n=this.animation,s=i.then(o=>{if(Vt(e),t!==this._gotoTask)throw new E("view:goto-interrupted","Goto was interrupted");this.viewpoint=n.target=o,n.finish()});return this._cancellableGoTo(t,n,s)}_flipStationary(i){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<Pa&&(this._stationaryTimer=this._flipStationary(e))},i)),this._stationaryTimer}_getDefaultViewpoint(){var T,A,F,O;const{constraints:i,initialExtent:e,map:t,padding:n,size:s}=this;if(!i)return null;const o=t&&"initialViewProperties"in t&&t.initialViewProperties,r={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};i.effectiveLODs?r.zoom!==-1&&(r.scale=i.zoomToScale(r.zoom)):r.zoom=-1;let c=null,d=null,u=0;const h=r.viewpoint&&r.viewpoint.rotation,p=r.viewpoint&&r.viewpoint.targetGeometry;w(p)&&(p.type==="extent"?c=p:p.type==="point"&&(d=p,u=r.viewpoint.scale));const g=r.extent||c||((A=Te((T=o==null?void 0:o.viewpoint)==null?void 0:T.targetGeometry))==null?void 0:A.extent)||e,f=r.center||d||(g==null?void 0:g.center),_=r.scale||u||((F=o==null?void 0:o.viewpoint)==null?void 0:F.scale)||g&&on(g,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),C=r.rotation||h||((O=o==null?void 0:o.viewpoint)==null?void 0:O.rotation)||0;return f&&_?new Ze({targetGeometry:f,scale:_,rotation:C}):null}_gotoAnimated(i,e){const t=this._gotoTask,n=this.animation,s=i.then(o=>{if(Vt(e),t!==this._gotoTask)throw new E("view:goto-interrupted","Goto was interrupted");return n.update(o),this.animationManager.animate(n,this.viewpoint,e),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(t,n,s)}_project(i,e){var s;const t=i&&i.targetGeometry||i;if(!e)return i;if(!t)return null;if(e.imageCoordinateSystem||(s=t.spatialReference)!=null&&s.imageCoordinateSystem||is(e,t.spatialReference))return i;const n=un(t,e);if(!n)throw new E("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:t,spatialReference:e});return wf(i)?(i.targetGeometry=n,i):n}_resizeHandler(i){if(!this.ready)return;const e=this.state;let t=this.state.paddedViewState.viewpoint;const n=this.state.paddedViewState.size.concat();e.size=[i.width,i.height],Zm(t,t,n,this.state.paddedViewState.size,this.resizeAlign),t=this.constraints.constrain(t,null),this.state.viewpoint=t}_startup(){var c,d;this.timeline.begin("MapView Startup");const i=this._getDefaultViewpoint(),e=i.targetGeometry;try{this._project(i,this.spatialReference)}catch(u){R.getLogger(this.declaredClass).warn(new ir("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:e.toJSON(),spatialReference:this.spatialReference,error:u})),i.targetGeometry=((c=this.defaultsFromMap.extent)==null?void 0:c.center)||new Y({x:0,y:0,spatialReference:this.spatialReference})}(d=this.constraints)==null||d.fit(i),this._set("state",new og({padding:this._get("padding"),size:this.size,viewpoint:i})),this.graphics.owner=this;const t=new fc(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=t,this._magnifierView=new bc,this._magnifierView.magnifier=this.magnifier;const n=new vc({view:this});this._set("labelManager",n);const s=new Jm({view:this});this._set("animationManager",s);const o=new wc({view:this,animationManager:s});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("post-render",()=>this._set("rendering",t.renderRequested)),t.on("will-render",()=>this._set("rendering",t.renderRequested)),t.on("webgl-error",u=>this.fatalError=u.error),v(()=>this.stationary,u=>t.stationary=u,Zt),v(()=>this.background,u=>{t.background=u,this._magnifierView.background=u},Zt),v(()=>this.magnifier,u=>this._magnifierView.magnifier=u,Zt),v(()=>this.renderingOptions,u=>t.renderingOptions=u,Zt),v(()=>this.highlightOptions,u=>t.highlightOptions=u,Zt),v(()=>this.state.id,()=>t.state=this.state,Zt)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[i,e],spatialReference:t,rotation:n,scale:s}=this.state.paddedViewState,o=new Y({x:i,y:e,spatialReference:t});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("spatialReference",t),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this._stage.addChild(e.container)});const i=this.graphicsView;this._stage.addChild(i.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const i=new cu(Qc.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",i);const e=new _c({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new yc(i)});this.frameTask.graphicsView=e,this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const i=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,i.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(i){if(!this.ready)return;this.frameTask.stop();for(const c of this.allLayerViews)c.processDetach();this._destroySpatialReferenceDependentProperties();const e=this.state.paddedViewState.clone();if($(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=e.scale;else{const c=e.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=c}const t=e.clone(),[n,s]=e.center;let o=null;try{o=this._project(new Y({x:n,y:s,spatialReference:e.spatialReference}),i)}catch(c){an()||R.getLogger(this.declaredClass).warn(new ir("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o.toJSON(),spatialReference:i,error:c}))}o||(o=new Y({x:0,y:0,spatialReference:i}));const r=vo(new Ze({targetGeometry:new Y,scale:0,rotation:0}),e.viewpoint,o);t.viewpoint=r;try{const d=[e.size[0]/2,e.size[1]/2],u=[d[0]+20,d[1]],h=e.toMap([0,0],u),{x:p,y:g}=this._project(new Y({x:h[0],y:h[1],spatialReference:e.spatialReference}),i);h[0]=p,h[1]=g,t.toScreen(h,h);const f=Gm(d,h,u),_=Math.hypot(h[0]-d[0],h[1]-d[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(r.rotation=0,r.targetGeometry=new Y({x:0,y:0,spatialReference:i})):(r.scale*=_,r.scale>ve("mapview-srswitch-adjust-rotation-scale-threshold")?r.rotation=0:r.rotation+=Number.isFinite(f)?f:0)}catch{}this._get("constraints").constrain(r,null),this._get("state").viewpoint=r,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const c of this.allLayerViews)c.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};P.type="2d",a([l({readOnly:!0})],P.prototype,"animationManager",void 0),a([l({constructOnly:!0})],P.prototype,"deactivatedWebGLExtensions",void 0),a([l({constructOnly:!0})],P.prototype,"debugWebGLExtensions",void 0),a([l({readOnly:!0})],P.prototype,"featuresTilingScheme",void 0),a([l({readOnly:!0})],P.prototype,"fullOpacity",void 0),a([l({readOnly:!0})],P.prototype,"graphicsTileStore",null),a([l()],P.prototype,"graphicsView",void 0),a([l({readOnly:!0})],P.prototype,"state",void 0),a([l()],P.prototype,"initialExtentRequired",null),a([l()],P.prototype,"labelManager",void 0),a([l({readOnly:!0})],P.prototype,"resourceManager",null),a([l({readOnly:!0})],P.prototype,"textureManager",null),a([l({readOnly:!0})],P.prototype,"mapViewNavigation",void 0),a([l({constructOnly:!0})],P.prototype,"renderCanvas",void 0),a([l()],P.prototype,"renderingOptions",void 0),a([l({readOnly:!0})],P.prototype,"rendering",void 0),a([l({constructOnly:!0})],P.prototype,"supersampleScreenshotsEnabled",void 0),a([l({readOnly:!0})],P.prototype,"supportsGround",void 0),a([l()],P.prototype,"_stationaryTimer",void 0),a([l()],P.prototype,"_defaultsFromMapSettings",null),a([l()],P.prototype,"_pePromise",void 0),a([l({readOnly:!0})],P.prototype,"typeSpecificPreconditionsReady",null),a([l()],P.prototype,"animation",null),a([l({type:yf})],P.prototype,"background",null),a([l({value:null,type:Y,dependsOn:["state.id","ready"]})],P.prototype,"center",null),a([l({type:sc})],P.prototype,"constraints",null),a([l({value:null,type:Li,dependsOn:["state.id","ready"]})],P.prototype,"extent",null),a([l()],P.prototype,"floors",void 0),a([l({type:rc})],P.prototype,"highlightOptions",void 0),a([l({readOnly:!0})],P.prototype,"inputManager",void 0),a([l()],P.prototype,"map",void 0),a([l({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],P.prototype,"padding",null),a([l()],P.prototype,"resizeAlign",void 0),a([l({readOnly:!0,dependsOn:["state.id"]})],P.prototype,"resolution",null),a([l({value:0,type:Number,dependsOn:["state.id","ready"]})],P.prototype,"rotation",null),a([l({value:0,type:Number,dependsOn:["state.id","ready"]})],P.prototype,"scale",null),a([l({constructOnly:!0})],P.prototype,"spatialReferenceLocked",void 0),a([l()],P.prototype,"stationary",null),a([l({type:ac,readOnly:!0})],P.prototype,"timeline",void 0),a([l({readOnly:!0})],P.prototype,"type",void 0),a([l({readOnly:!0})],P.prototype,"updating",null),a([l({value:null,type:Ze,dependsOn:["state.id","ready"]})],P.prototype,"viewpoint",null),a([l({value:-1,dependsOn:["state.id","ready"]})],P.prototype,"zoom",null),a([l({readOnly:!0})],P.prototype,"navigating",null),a([l({type:gc})],P.prototype,"ui",void 0),P=a([M("esri.views.MapView")],P);const bf=P;function xo(i){var t,n;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((n=i.sourceLayer)==null?void 0:n.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function $a(i,e,t,n,s){return o=>{if(o instanceof Ye){if(o.layer===i)s==null||s();else{const r=i.allLayerViews.find(c=>c.layer===o.layer);r&&(n==null||n(r))}t(xo(o))}else{const r=i.allLayerViews.find(c=>c.layer===o);r&&e(r)}}}function Sa(i,e){if(i)if(nr(i))for(const t of i)if(nr(t))for(const n of t)e(n);else e(t);else e(i)}function Mf(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}new ci({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"});new ci({109006:"centimeters",9102:"decimal-degrees",109005:"decimeters",9002:"feet",109009:"inches",9036:"kilometers",9001:"meters",9035:"miles",109007:"millimeters",109012:"nautical-miles",9096:"yards"});let Gt=class extends Re{constructor(e){super(e),this.deviationUnit=null,this.geometries=null,this.maxDeviation=null}};a([l({type:String,json:{write:!0}})],Gt.prototype,"deviationUnit",void 0),a([l({json:{read:{reader:i=>i?i.map(e=>pt(e)).filter(w):null},write:{writer:(i,e)=>{e.geometries=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],Gt.prototype,"geometries",void 0),a([l({type:Number,json:{write:!0}})],Gt.prototype,"maxDeviation",void 0),Gt=a([M("esri.rest.support.GeneralizeParameters")],Gt),Gt.from=Ht(Gt);new ci({preserveShape:"preserve-shape"});let bt=class extends Re{constructor(e){super(e),this.calculationType=null,this.geodesic=null,this.lengthUnit=null,this.polylines=null}};a([l({type:String,json:{write:!0}})],bt.prototype,"calculationType",void 0),a([l({type:Boolean,json:{write:!0}})],bt.prototype,"geodesic",void 0),a([l({json:{write:!0}})],bt.prototype,"lengthUnit",void 0),a([l({type:[el],json:{read:{reader:i=>i?i.map(e=>pt(e)):null},write:{writer:(i,e)=>{e.polylines=i.map(t=>t.toJSON())}}}})],bt.prototype,"polylines",void 0),bt=a([M("esri.rest.support.LengthsParameters")],bt),bt.from=Ht(bt);new ci({esriGeometryOffsetBevelled:"bevelled",esriGeometryOffsetMitered:"mitered",esriGeometryOffsetRounded:"rounded"});new ci({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});let it=class extends Re{constructor(e){super(e),this.bevelRatio=null,this.geometries=null,this.offsetDistance=null,this.offsetHow=null,this.offsetUnit=null}};a([l({type:Number,json:{write:!0}})],it.prototype,"bevelRatio",void 0),a([l({json:{read:{reader:i=>i?i.map(e=>pt(e)).filter(w):null},write:{writer:(i,e)=>{e.geometries=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],it.prototype,"geometries",void 0),a([l({type:Number,json:{write:!0}})],it.prototype,"offsetDistance",void 0),a([l({type:String,json:{write:!0}})],it.prototype,"offsetHow",void 0),a([l({type:String,json:{write:!0}})],it.prototype,"offsetUnit",void 0),it=a([M("esri.rest.support.OffsetParameters")],it),it.from=Ht(it);let ti=class extends Re{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(s=>s.toJSON()),t=this.geometries[0],n={};return n.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),n.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),n.geometries=JSON.stringify({geometryType:Va(t),geometries:e}),this.transformation&&(n.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(n.transformForward=this.transformForward),n}};a([l()],ti.prototype,"geometries",void 0),a([l({json:{read:{source:"outSR"}}})],ti.prototype,"outSpatialReference",void 0),a([l()],ti.prototype,"transformation",void 0),a([l()],ti.prototype,"transformForward",void 0),ti=a([M("esri.rest.support.ProjectParameters")],ti);const Mc=ti,If=Ht(Mc);async function Cf(i,e,t){e=If(e);const n=Id(i),s={...n.query,f:"json",...e.toJSON()},o=e.outSpatialReference,r=Va(e.geometries[0]),c=Cd(s,t);return Ja(n.path+"/project",c).then(({data:{geometries:d}})=>Td(d,r,o))}new ci({esriGeometryRelationCross:"cross",esriGeometryRelationDisjoint:"disjoint",esriGeometryRelationIn:"in",esriGeometryRelationInteriorIntersection:"interior-intersection",esriGeometryRelationIntersection:"intersection",esriGeometryRelationLineCoincidence:"line-coincidence",esriGeometryRelationLineTouch:"line-touch",esriGeometryRelationOverlap:"overlap",esriGeometryRelationPointTouch:"point-touch",esriGeometryRelationTouch:"touch",esriGeometryRelationWithin:"within",esriGeometryRelationRelation:"relation"});let Mt=class extends Re{constructor(e){super(e),this.geometries1=null,this.geometries2=null,this.relation=null,this.relationParameter=null}};a([l({json:{read:{reader:i=>i?i.map(e=>pt(e)).filter(w):null},write:{writer:(i,e)=>{e.geometries1=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],Mt.prototype,"geometries1",void 0),a([l({json:{read:{reader:i=>i?i.map(e=>pt(e)).filter(w):null},write:{writer:(i,e)=>{e.geometries2=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],Mt.prototype,"geometries2",void 0),a([l({type:String,json:{write:!0}})],Mt.prototype,"relation",void 0),a([l({type:String,json:{write:!0}})],Mt.prototype,"relationParameter",void 0),Mt=a([M("esri.rest.support.RelationParameters")],Mt),Mt.from=Ht(Mt);new ci({0:"default-curve-extension",1:"relocate-ends",2:"keep-end-attributes",4:"no-end-attributes",8:"no-extend-at-from",16:"no-extend-at-to"});let Wt=class extends Re{constructor(i){super(i),this.extendHow="default-curve-extension",this.polylines=null,this.trimExtendTo=null}};a([l({type:String,json:{write:!0}})],Wt.prototype,"extendHow",void 0),a([l({type:[el],json:{read:{reader:i=>i?i.map(e=>pt(e)):null},write:{writer:(i,e)=>{e.polylines=i.map(t=>t.toJSON())}}}})],Wt.prototype,"polylines",void 0),a([l({json:{read:{reader:i=>i?pt(i):null},write:{writer:(i,e)=>{e.trimExtendTo=i.toJSON()}}}})],Wt.prototype,"trimExtendTo",void 0),Wt=a([M("esri.rest.support.TrimExtendParameters")],Wt),Wt.from=Ht(Wt);const Ic=R.getLogger("esri.widgets.support.geolocationUtils"),Tf={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function Ef(){const i=ve("esri-geolocation");return i||Ic.warn("geolocation-unsupported","Geolocation unsupported."),i}function xf(){const i=window.isSecureContext;return i||Ic.warn("insecure-context","Geolocation requires a secure origin."),i}function kf(){return Ef()&&xf()}function Af(i){return i||(i=Tf),new Promise((t,n)=>{setTimeout(()=>n(new E("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(t,n,i)})}function Pf(i,e){const{position:t,view:n}=i;return Rf(Sf($f(t)),n,e)}function $f(i){const e=i&&i.coords||{},t={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return i&&{coords:t,timestamp:i.timestamp}}function Sf(i){const e=i&&i.coords;return e?new Y({longitude:e.longitude,latitude:e.latitude,z:e.altitude||null,spatialReference:{wkid:4326}}):null}function Rf(i,e,t){if(!e)return Promise.resolve(i);const n=e.spatialReference;return n.isWGS84?Promise.resolve(i):n.isWebMercator?Promise.resolve(ko(i)):Lf(t).then(s=>{if(!s)throw new E("geometry-service:missing-url","Geometry service URL is missing");const o=new Mc({geometries:[i],outSpatialReference:n});return Cf(s,o,t).then(r=>r[0])})}function Lf(i){if(Hn.geometryServiceUrl)return Promise.resolve(Hn.geometryServiceUrl);const e=pu.getDefault();return e.load(i).catch(()=>{}).then(()=>e.get("helperServices.geometry.url"))}const Ff=2500;let He=class extends Go(pn.EventedMixin(L)){constructor(){super(...arguments),this._geolocationUsable=!0,this._iconPath=Ya("esri/images/support/sdk_gps_location.png"),this.geolocationOptions=null,this.goToLocationEnabled=!0,this.graphic=new Ye({symbol:new vd({url:this._iconPath,width:21,height:21})}),this.scale=null,this.useHeadingEnabled=!0,this.view=null}initialize(){kf()||(this._geolocationUsable=!1)}destroy(){this._clear(),this.view=null}_clear(){this.view&&this.view.graphics.remove(this.graphic)}_getScaleWithinConstraints(i,e){if(!e)return i;if(e.type==="2d"){const{effectiveMaxScale:t,effectiveMinScale:n}=e.constraints;return Math.min(n,Math.max(t,i))}return i}_getScale(i){const{scale:e}=this,t=typeof e=="number"?e:Ff;return this._getScaleWithinConstraints(t,i)}_getHeading(i,e){const t=e&&e.spatialReference,n=t&&(t.isWebMercator||t.isGeographic),s=i.coords&&i.coords.heading;if(!(!n||typeof s!="number"||isNaN(s)||s<0||s>360))return s}_addHeading(i){const{heading:e,target:t,view:n}=i;n&&typeof e=="number"&&!isNaN(e)&&(n.type!=="3d"?n.type==="2d"&&(t.rotation=360-e):t.heading=e)}_animatePoint(i,e,t,n){const{view:s}=this;if(!this.goToLocationEnabled||!s)return Promise.resolve(e);const o=this.useHeadingEnabled?this._getHeading(e,s):void 0,r={target:i,scale:t};return this._addHeading({heading:o,target:r,view:s}),this.callGoTo({target:r,options:n}).then(()=>e)}async _setPosition(i,e){try{const t=await Pf({position:i,view:this.view},e),{graphic:n}=this,{timestamp:s}=i,{coords:o}=i,{accuracy:r,altitude:c,altitudeAccuracy:d,heading:u,latitude:h,longitude:p,speed:g}=o,f={timestamp:s,accuracy:r,altitude:c,altitudeAccuracy:d,heading:u,latitude:h,longitude:p,speed:g};n&&(n.geometry=t,n.attributes=f);const _=this._getScale(this.view);return this._animatePoint(t,i,_,e)}catch(t){throw new E("positioning:invalid-point","Cannot position invalid point",{error:t})}}};a([l()],He.prototype,"_geolocationUsable",void 0),a([l()],He.prototype,"geolocationOptions",void 0),a([l()],He.prototype,"goToLocationEnabled",void 0),a([l({type:Ye,nonNullable:!0})],He.prototype,"graphic",void 0),a([l()],He.prototype,"scale",void 0),a([l()],He.prototype,"useHeadingEnabled",void 0),a([l()],He.prototype,"view",void 0),He=a([M("esri.widgets.support.GeolocationPositioning")],He);const Of=He;async function Df(){const i=await mu("esri/widgets/Locate/t9n/Locate");return new fd({title:i.currentLocation,fieldInfos:[{fieldName:"timestamp",label:i.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:i.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:i.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:i.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:i.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:i.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:i.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:i.speed,format:{places:0,digitSeparator:!0}}],actions:[po.clone()],content:[{type:"fields"}]})}let Rt=class extends Of{constructor(i){super(i),this._locateController=null,this._handles=new Ke,this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this._handles.add([xd(()=>{var n;const{graphic:i,view:e}=this;((n=e==null?void 0:e.graphics)==null?void 0:n.includes(i))&&this._updatePopupTemplate(i)})])}destroy(){this.cancelLocate(),this._handles.destroy(),this._handles=null}get state(){return this._geolocationUsable?this.get("view.ready")?this._locateController?"locating":"ready":"disabled":"feature-unsupported"}async locate(){if(this.cancelLocate(),this.state==="disabled")throw new E("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new E("locate:feature-unsupported-state","Cannot locate in unsecure domain.");const i=new AbortController;this._locateController=i;try{let e=await Af(this.geolocationOptions);return e=await this._setPosition(e,{signal:i.signal}),this._locateController!==i?null:(this.graphic&&(this.graphic=this.graphic.clone(),await this._updatePopupTemplate(this.graphic),this.view.graphics.push(this.graphic)),this.emit("locate",{position:e}),this._locateController=null,e)}catch(e){throw this._locateController=null,this.emit("locate-error",{error:e}),e}}cancelLocate(){this._clear(),this._locateController&&this._locateController.abort(),this._locateController=null}async _updatePopupTemplate(i){if(!this.popupEnabled)return;const e=await Df(),t=i!==this.graphic;this.destroyed||t||(i.popupTemplate=e)}};a([l()],Rt.prototype,"_locateController",void 0),a([l()],Rt.prototype,"popupEnabled",void 0),a([l({readOnly:!0})],Rt.prototype,"state",null),a([l()],Rt.prototype,"locate",null),a([l()],Rt.prototype,"cancelLocate",null),Rt=a([M("esri.widgets.Locate.LocateViewModel")],Rt);const Cc=Rt,nt={base:"esri-locate esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-icon",locate:"esri-icon-locate",loading:"esri-icon-loading-indicator",rotating:"esri-rotating",widgetIcon:"esri-icon-north-navigation",disabled:"esri-disabled",hidden:"esri-hidden"};let se=class extends re{constructor(i,e){super(i,e),this.iconClass=nt.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new Cc}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(i){this.viewModel.geolocationOptions=i}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(i){this.viewModel.goToLocationEnabled=i}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(i){this.viewModel.goToOverride=i}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(i){this.viewModel.popupEnabled=i}get scale(){return this.viewModel.scale}set scale(i){this.viewModel.scale=i}get useHeadingEnabled(){return this.viewModel.useHeadingEnabled}set useHeadingEnabled(i){this.viewModel.useHeadingEnabled=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}cancelLocate(){this.viewModel.cancelLocate()}locate(){return this.viewModel.locate()}render(){const i=this.get("viewModel.state"),e=i==="locating",t={[nt.disabled]:i==="disabled",[nt.hidden]:i==="feature-unsupported"},n={[nt.loading]:e,[nt.rotating]:e,[nt.locate]:!e},s=i==="locating"?this.messagesCommon.cancel:this.messages.title;return m("div",{bind:this,class:this.classes(nt.base,t),hidden:i==="feature-unsupported",onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,"aria-label":s,title:s},m("span",{"aria-hidden":"true",class:this.classes(nt.icon,n)}),m("span",{class:nt.text},this.messages.title))}_locate(){const{viewModel:i}=this;i.state==="locating"?i.cancelLocate():i.locate()}};a([l()],se.prototype,"geolocationOptions",null),a([l()],se.prototype,"goToLocationEnabled",null),a([l()],se.prototype,"goToOverride",null),a([l()],se.prototype,"graphic",null),a([l()],se.prototype,"iconClass",void 0),a([l()],se.prototype,"label",null),a([l(),ne("esri/widgets/Locate/t9n/Locate")],se.prototype,"messages",void 0),a([l(),ne("esri/t9n/common")],se.prototype,"messagesCommon",void 0),a([l()],se.prototype,"popupEnabled",null),a([l()],se.prototype,"scale",null),a([l()],se.prototype,"useHeadingEnabled",null),a([l()],se.prototype,"view",null),a([l({type:Cc}),Cl(["locate","locate-error"])],se.prototype,"viewModel",void 0),a([Ee()],se.prototype,"_locate",null),se=a([M("esri.widgets.Locate")],se);const Vf=se;function Nf(i){let e;return{c(){e=ce("div"),le(e,"class","view svelte-xcjf67"),le(e,"id","viewDiv")},m(t,n){gn(t,e,n)},p:We,i:We,o:We,d(t){t&&Fi(e)}}}function zf(i,e,t){let{buffer:n}=e,{units:s}=e;const o=bu();wu(()=>{r()});const r=()=>{const d=new Kd,u=new bf({container:"viewDiv",map:{basemap:"streets-vector",layers:[d]},zoom:15,center:[-90.1928,38.6226]});let h=new Vf({view:u,popupEnabled:!1});u.ui.add(h,"top-left"),u.when(()=>{h.locate()}),u.on("click",p=>{let g=p.mapPoint,f=g.latitude,_=g.longitude;o("mapClicked",{lat:f,long:_}),c(p,d,u)})},c=(d,u,h)=>{const p=new Qa({color:[227,139,79,.2],outline:{color:[0,0,0,.5],width:1}}),g=hu(d.mapPoint,n,s),f=new Xa({rings:g.rings}),_=Bc(f),C=new Ye({geometry:_,symbol:p});u.add(C),h.goTo(_.extent)};return i.$$set=d=>{"buffer"in d&&t(0,n=d.buffer),"units"in d&&t(1,s=d.units)},[n,s]}class Bf extends us{constructor(e){super(),ds(this,e,zf,Nf,cs,{buffer:0,units:1})}}function qf(i){let e,t,n,s,o,r,c,d,u,h,p,g,f,_,C,T,A,F;function O(D){i[5](D)}function z(D){i[6](D)}function J(D){i[7](D)}let B={};i[0]!==void 0&&(B.bufferValue=i[0]),i[1]!==void 0&&(B.nameValue=i[1]),i[2]!==void 0&&(B.unitValue=i[2]),n=new Au({props:B}),Ft.push(()=>fi(n,"bufferValue",O,i[0])),Ft.push(()=>fi(n,"nameValue",z,i[1])),Ft.push(()=>fi(n,"unitValue",J,i[2]));function de(D){i[8](D)}let Fe={};i[3]!==void 0&&(Fe.pointList=i[3]),u=new Su({props:Fe}),Ft.push(()=>fi(u,"pointList",de,i[3]));function Qe(D){i[9](D)}function gt(D){i[10](D)}let ue={};return i[0]!==void 0&&(ue.buffer=i[0]),i[2]!==void 0&&(ue.units=i[2]),f=new Bf({props:ue}),Ft.push(()=>fi(f,"buffer",Qe,i[0])),Ft.push(()=>fi(f,"units",gt,i[2])),f.$on("mapClicked",i[4]),{c(){e=ce("div"),t=ce("div"),xs(n.$$.fragment),c=Dt(),d=ce("div"),xs(u.$$.fragment),p=Dt(),g=ce("div"),xs(f.$$.fragment),T=Dt(),A=ce("div"),le(t,"class","header-bar svelte-14jg1y"),le(d,"class","point-list svelte-14jg1y"),le(g,"class","map svelte-14jg1y"),le(e,"class","grid-container svelte-14jg1y")},m(D,Oe){gn(D,e,Oe),Z(e,t),kn(n,t,null),Z(e,c),Z(e,d),kn(u,d,null),Z(e,p),Z(e,g),kn(f,g,null),Z(e,T),Z(e,A),F=!0},p(D,[Oe]){const di={};!s&&Oe&1&&(s=!0,di.bufferValue=D[0],gi(()=>s=!1)),!o&&Oe&2&&(o=!0,di.nameValue=D[1],gi(()=>o=!1)),!r&&Oe&4&&(r=!0,di.unitValue=D[2],gi(()=>r=!1)),n.$set(di);const jt={};!h&&Oe&8&&(h=!0,jt.pointList=D[3],gi(()=>h=!1)),u.$set(jt);const ui={};!_&&Oe&1&&(_=!0,ui.buffer=D[0],gi(()=>_=!1)),!C&&Oe&4&&(C=!0,ui.units=D[2],gi(()=>C=!1)),f.$set(ui)},i(D){F||(xn(n.$$.fragment,D),xn(u.$$.fragment,D),xn(f.$$.fragment,D),F=!0)},o(D){Es(n.$$.fragment,D),Es(u.$$.fragment,D),Es(f.$$.fragment,D),F=!1},d(D){D&&Fi(e),An(n),An(u),An(f)}}}function Uf(i,e,t){let n=1,s="",o="miles",r=[];const c=_=>{t(3,r=[...r,{unit:o,name:s,buffer:n}])};function d(_){n=_,t(0,n)}function u(_){s=_,t(1,s)}function h(_){o=_,t(2,o)}function p(_){r=_,t(3,r)}function g(_){n=_,t(0,n)}function f(_){o=_,t(2,o)}return[n,s,o,r,c,d,u,h,p,g,f]}class Hf extends us{constructor(e){super(),ds(this,e,Uf,qf,cs,{})}}new Hf({target:document.getElementById("app")});export{Fm as $,Xl as G,Nt as P,Vw as R,fs as S,Pi as a,Dw as b,Hm as c,Mc as d,ac as e,Cf as f,ub as m,Jl as n,Gm as p,Ze as u};
